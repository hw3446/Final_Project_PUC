[
  {
    "objectID": "posts/Summary/Summary.html",
    "href": "posts/Summary/Summary.html",
    "title": "Summary",
    "section": "",
    "text": "In this blog we examined a dataset on musical imaginings collected during a live concert. After visualising counts for different thought types counts for memories or stories within a given movement, we moved on to running ordinal regression models. These models showed the relationship between thought types and demographic variables for each half of the concert.\nAn example model was run for fictional story with age as a predictor. When compared against a model with gender as an interaction variable, there was no significant improvement into the model. Final model selection was achieved using the step() function in R, which tests different combinations of main effects variables to keep the model with the lowest AIC. After running this, we were able to identify main effects ordinal regression models for most of the thought types in our dataset. We could then collate these models and calculate final summary statistics.\nHere’s a summary of the main effects for likelihood of different thought types in each half of the concert:\nFictional story\n\nFirst half: Age (estimate -0.018, p = 0.0098)\nSecond half: Age (estimate -0.02, p = 0.0093)\n\nAbstract shapes\n\nFirst half: Age (estimate -0.013, p = 0.077)\nSecond half: no main effect\n\nSensory sensations\n\nFirst half: no main effect\nSecond half: no main effect\n\nLife experiences\n\nFirst half: Age (estimate -0.018, p &lt; 0.001)\nSecond half: Age (estimate -0.014, p = 0.0013\n\nMedia\n\nFirst half: Age (estimate -0.012, p = 0.01)\nSecond half: Age ( estimate -0.014, p = 0.0016)\n\nMusic\n\nFirst half: Frequency of classical music listening, and number of years of regular daily practice of a musical instrument (estimate 0.01, p = 0.01)\nSecond half: Gender, number of years of regular daily practice of a musical instrument (estimate 0.014, p &lt; 0.001), Age\n\nFuture plans\n\nFirst half: Age (estimate -0.027, p&lt;0.01)\nSecond half: Age (estimate -0.027, p &lt; 0.01)\n\nThe concert building\n\nFirst half: Age (estimate -0.015, p = 0.001), Gender and frequency of classical music listening\nSecond half: Floor (Upstairs estimate = 0.30, p = 0.1)\n\nEveryday stuff\n\nFirst half: Age (estimate -0.015, p &lt; 0.001)\nSecond half: Age (-0.019, p &lt; 0.001)\n\nIn general older patrons were less likely to experience particular thought types. There is also a marked distinction in both halves for thoughts about the music and thoughts about the building in terms of demographic predictors. Future work will focus on scrutinizing these distinctions, identifying possible causes for any discrepancies between the two halves of the concert, and doing further analysis with demographic predictors for movement selection."
  },
  {
    "objectID": "posts/Modelling_2/Modelling_2.html",
    "href": "posts/Modelling_2/Modelling_2.html",
    "title": "Ordinal regression: model selection",
    "section": "",
    "text": "library(tidyverse)\nlibrary(MASS)\nlibrary(dplyr)\nlibrary(corrplot)\nlibrary(car)\nlibrary(knitr)\n\nIn this section, we’ll experiment with the step() function in R to help select ordinal regression models for our data.\nstep() is not compatible with clm(), which is why we’ll use polr().\nThe step() function starts with a full model containing all the possible main effects (in this case all the possible demographic variables). It tests different combinations of variables and then keeps the model with the lowest AIC.\nThis is helpful when we’re dealing with lots of different outcome variables and lots of demographic inputs and we need to figure out which ones to use.\nHere’s how we’d run the step() function starting with all the demographic variables and using just fictional story as our outcome.\nFirst some data loading, and demographic variable tidying.\n\ndata1 &lt;- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data.csv\")\n\ndata2 &lt;- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data2.csv\")\n\n\noutcome_vars &lt;- c(\"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \n                  \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \n                  \"Building\", \"Everyday\")\n\n# Converting outcome variables to factors with consistent levels for each thought type\ndata1[outcome_vars] &lt;- lapply(data1[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\ndata2[outcome_vars] &lt;- lapply(data2[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\n#Remaking the floor variable\ndata1 &lt;- data1 %&gt;%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %&gt;% relocate(Floor, .after = Location)\n\ndata2 &lt;- data2 %&gt;%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %&gt;% relocate(Floor, .after = Location)\n\n#Making sure demographic variables are classed in the right way.\ndata1$Age &lt;- as.numeric(data1$Age)\ndata2$Age &lt;- as.numeric(data2$Age)\ndata1$Practice &lt;- as.numeric(as.character(data1$Practice))\ndata2$Practice &lt;- as.numeric(as.character(data2$Practice))\ndata1$Gender &lt;- factor(data1$Gender,  levels = c('Male', 'Female', 'Other'))\ndata2$Gender &lt;- factor(data2$Gender,  levels = c('Male', 'Female', 'Other'))\ndata1$Music_listening &lt;- factor(data1$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata2$Music_listening &lt;- factor(data2$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata1$Floor &lt;- factor(data1$Floor, levels = c('Downstairs', 'Upstairs'))\ndata2$Floor &lt;- factor(data2$Floor, levels = c('Downstairs', 'Upstairs'))\n\nWe have some NAs in our dataframe, so before running the models, we need to figure out what to do with these.\nLet’s get a map of our missing data:\n\nlibrary(Amelia)\ndemographics_outcomes &lt;- c('Age', 'Gender', 'Music_listening', 'Practice', 'Floor', \"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \n                  \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \n                  \"Building\", \"Everyday\")\n\ndem_out &lt;- dplyr::select(data1, all_of(demographics_outcomes))\nmissmap(dem_out)\n\n\n\n\n\n\n\n\nWe can hypothesise that the data is MCAR (missing completely at random), i.e. that missing values aren’t correlated with any particular variables. Let’s test this.\n\nlibrary(naniar)\nmcar_test(dem_out)\n\n# A tibble: 1 × 4\n  statistic    df p.value missing.patterns\n      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;            &lt;int&gt;\n1      250.   237   0.265               23\n\n\np &gt; 0.05, so there is insufficient evidence to reject the null hypothesis that the data is MCAR.\nBased on this, we can use multiple imputation to deal with the NAs. This has the advantage of preserving the data structure and reflecting uncertainty without data loss.\n\nlibrary(mice)\nimputed_data1 &lt;- mice(data1, m = 5, method = 'pmm', seed = 123, print = FALSE)\ncompleted_data1 &lt;- complete(imputed_data1, 1)\n\nLet’s now run the step() function with our imputed data for fictional story.\n\nStart by specifying the model with with maximum number of demographic inputs.\n\n\nmodel_fiction_imp &lt;- polr(Fictional_story ~ Age + Gender + Music_listening + Practice + Floor, \n              data = completed_data1, Hess = TRUE, method = \"logistic\")\n\nstepwise_model_imp &lt;- step(model_fiction_imp)\n\nStart:  AIC=488.79\nFictional_story ~ Age + Gender + Music_listening + Practice + \n    Floor\n\n                  Df    AIC\n- Gender           2 485.38\n- Practice         1 486.85\n- Music_listening  4 486.89\n- Floor            1 487.06\n&lt;none&gt;               488.79\n- Age              1 494.12\n\nStep:  AIC=485.38\nFictional_story ~ Age + Music_listening + Practice + Floor\n\n                  Df    AIC\n- Practice         1 483.40\n- Floor            1 483.83\n- Music_listening  4 484.40\n&lt;none&gt;               485.38\n- Age              1 491.61\n\nStep:  AIC=483.4\nFictional_story ~ Age + Music_listening + Floor\n\n                  Df    AIC\n- Floor            1 481.89\n- Music_listening  4 482.80\n&lt;none&gt;               483.40\n- Age              1 489.82\n\nStep:  AIC=481.89\nFictional_story ~ Age + Music_listening\n\n                  Df    AIC\n- Music_listening  4 481.00\n&lt;none&gt;               481.89\n- Age              1 487.90\n\nStep:  AIC=481\nFictional_story ~ Age\n\n       Df    AIC\n&lt;none&gt;    481.00\n- Age   1 485.74\n\nsummary(stepwise_model_imp)\n\nCall:\npolr(formula = Fictional_story ~ Age, data = completed_data1, \n    Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.01812   0.007012  -2.584\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.4612  0.4338   \nA small amount of the time|A moderate amount of the time -0.4828  0.4176   \nA moderate amount of the time|Most of the time            0.4619  0.4269   \nMost of the time|All of the time                          2.5021  0.5883   \n                                                         t value\nNot at all|A small amount of the time                    -3.3686\nA small amount of the time|A moderate amount of the time -1.1563\nA moderate amount of the time|Most of the time            1.0821\nMost of the time|All of the time                          4.2530\n\nResidual Deviance: 471.0048 \nAIC: 481.0048 \n\n\nHere step() ran through all the possible demographics to find the model with the lowest AIC. In this case the most successful model was one with just age as a demographic input.\nWe can run the step() function looping through all the possible outcome variables using the imputed data.\n\n# List to store results\nmodels &lt;- list()\nstepwise_models &lt;- list()\n\n# Loop through selected outcomes\nfor (outcome in outcome_vars) {\n  formula &lt;- as.formula(paste(outcome, \"~ Age + Gender + Music_listening + Practice + Floor\"))\n\n  tryCatch({\n    # Fit proportional odds model\n    model &lt;- polr(formula, data = completed_data1, Hess = TRUE, method = \"logistic\", \n                  control = list(maxit = 1000), na.action = na.exclude)\n    \n    # Store model\n    models[[outcome]] &lt;- model\n    \n    # Print summary\n    cat(\"\\nSummary for\", outcome, \":\\n\")\n    print(summary(model))\n    \n    # Perform stepwise regression\n    step_model &lt;- step(model, direction = \"backward\", trace = FALSE)\n    stepwise_models[[outcome]] &lt;- step_model\n    \n    # Print stepwise summary\n    cat(\"\\nStepwise Model Summary for\", outcome, \":\\n\")\n    print(summary(step_model))\n    \n  }, error = function(e) {\n    cat(\"\\nSkipping\", outcome, \"due to error:\", conditionMessage(e), \"\\n\")\n  })\n}\n\n\nSummary for Fictional_story :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                         Value Std. Error t value\nAge                                  -0.020064   0.007472 -2.6854\nGenderFemale                         -0.184649   0.289509 -0.6378\nGenderOther                           0.682474   1.815033  0.3760\nMusic_listeningSomewhat rarely        0.583267   1.320177  0.4418\nMusic_listeningModerately frequently  0.182789   1.182258  0.1546\nMusic_listeningFrequently            -0.601948   1.155526 -0.5209\nMusic_listeningVery frequently       -0.430974   1.155553 -0.3730\nPractice                             -0.001622   0.006711 -0.2417\nFloorUpstairs                        -0.164728   0.316061 -0.5212\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.1013  1.2172   \nA small amount of the time|A moderate amount of the time -1.0931  1.2048   \nA moderate amount of the time|Most of the time           -0.1208  1.2087   \nMost of the time|All of the time                          1.9778  1.2823   \n                                                         t value\nNot at all|A small amount of the time                    -1.7263\nA small amount of the time|A moderate amount of the time -0.9073\nA moderate amount of the time|Most of the time           -0.1000\nMost of the time|All of the time                          1.5424\n\nResidual Deviance: 462.7904 \nAIC: 488.7904 \n\nStepwise Model Summary for Fictional_story :\nCall:\npolr(formula = Fictional_story ~ Age, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"logistic\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.01812   0.007012  -2.584\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.4612  0.4338   \nA small amount of the time|A moderate amount of the time -0.4828  0.4176   \nA moderate amount of the time|Most of the time            0.4619  0.4269   \nMost of the time|All of the time                          2.5021  0.5883   \n                                                         t value\nNot at all|A small amount of the time                    -3.3686\nA small amount of the time|A moderate amount of the time -1.1563\nA moderate amount of the time|Most of the time            1.0821\nMost of the time|All of the time                          4.2530\n\nResidual Deviance: 471.0048 \nAIC: 481.0048 \n\nSummary for Abstract_shapes :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                         Value Std. Error  t value\nAge                                  -0.013730   0.007830 -1.75340\nGenderFemale                          0.237260   0.305566  0.77646\nGenderOther                           0.500606   1.670889  0.29960\nMusic_listeningSomewhat rarely       -0.401635   1.475343 -0.27223\nMusic_listeningModerately frequently -0.183899   1.375480 -0.13370\nMusic_listeningFrequently            -0.223421   1.350183 -0.16547\nMusic_listeningVery frequently       -0.067906   1.345595 -0.05047\nPractice                              0.005251   0.006897  0.76139\nFloorUpstairs                        -0.190754   0.327727 -0.58205\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.6245  1.3874   \nA small amount of the time|A moderate amount of the time  0.4881  1.3843   \nA moderate amount of the time|Most of the time            1.8611  1.3998   \nMost of the time|All of the time                          4.3210  1.6951   \n                                                         t value\nNot at all|A small amount of the time                    -0.4501\nA small amount of the time|A moderate amount of the time  0.3526\nA moderate amount of the time|Most of the time            1.3296\nMost of the time|All of the time                          2.5492\n\nResidual Deviance: 381.9298 \nAIC: 407.9298 \n\nStepwise Model Summary for Abstract_shapes :\nCall:\npolr(formula = Abstract_shapes ~ Age, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"logistic\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.01305    0.00737  -1.771\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.5212  0.4459   \nA small amount of the time|A moderate amount of the time  0.5788  0.4459   \nA moderate amount of the time|Most of the time            1.9430  0.5062   \nMost of the time|All of the time                          4.4013  1.0795   \n                                                         t value\nNot at all|A small amount of the time                    -1.1687\nA small amount of the time|A moderate amount of the time  1.2980\nA moderate amount of the time|Most of the time            3.8384\nMost of the time|All of the time                          4.0773\n\nResidual Deviance: 383.8834 \nAIC: 393.8834 \n\nSummary for Sensory_sensations :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                          Value Std. Error   t value\nAge                                   0.0001992   0.008458  0.023554\nGenderFemale                          0.1648059   0.331730  0.496807\nGenderOther                           1.5234446   1.739314  0.875888\nMusic_listeningSomewhat rarely       13.2322740   0.591145 22.384154\nMusic_listeningModerately frequently 13.1572183   0.358521 36.698599\nMusic_listeningFrequently            13.4798311   0.295118 45.675998\nMusic_listeningVery frequently       13.3047288   0.288087 46.182956\nPractice                             -0.0037578   0.007612 -0.493665\nFloorUpstairs                         0.0009349   0.357546  0.002615\n\nIntercepts:\n                                                         Value    Std. Error\nNot at all|A small amount of the time                     14.0608   0.5241  \nA small amount of the time|A moderate amount of the time  15.3822   0.5544  \nA moderate amount of the time|Most of the time            16.6777   0.6543  \nMost of the time|All of the time                          93.0447   0.6543  \n                                                         t value \nNot at all|A small amount of the time                     26.8284\nA small amount of the time|A moderate amount of the time  27.7461\nA moderate amount of the time|Most of the time            25.4902\nMost of the time|All of the time                         142.2094\n\nResidual Deviance: 308.8061 \nAIC: 334.8061 \n\nStepwise Model Summary for Sensory_sensations :\nCall:\npolr(formula = Sensory_sensations ~ 1, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"logistic\")\n\nNo coefficients\n\nIntercepts:\n                                                         Value    Std. Error\nNot at all|A small amount of the time                      0.7020   0.1634  \nA small amount of the time|A moderate amount of the time   2.0082   0.2381  \nA moderate amount of the time|Most of the time             3.3019   0.4157  \nMost of the time|All of the time                          15.0784 151.2038  \n                                                         t value \nNot at all|A small amount of the time                      4.2959\nA small amount of the time|A moderate amount of the time   8.4329\nA moderate amount of the time|Most of the time             7.9433\nMost of the time|All of the time                           0.0997\n\nResidual Deviance: 312.1081 \nAIC: 320.1081 \n\nSummary for Life_experiences :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                          Value Std. Error  t value\nAge                                  -0.0304006   0.007787 -3.90393\nGenderFemale                          0.5929295   0.290624  2.04019\nGenderOther                           0.2018541   1.707436  0.11822\nMusic_listeningSomewhat rarely       -1.5339005   1.487048 -1.03151\nMusic_listeningModerately frequently -0.9692451   1.393042 -0.69578\nMusic_listeningFrequently            -1.4862291   1.372219 -1.08308\nMusic_listeningVery frequently       -1.2177971   1.368478 -0.88989\nPractice                             -0.0003402   0.006825 -0.04984\nFloorUpstairs                         0.1495517   0.313627  0.47685\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -3.9081  1.4339   \nA small amount of the time|A moderate amount of the time -2.6223  1.4210   \nA moderate amount of the time|Most of the time           -1.0215  1.4047   \nMost of the time|All of the time                          1.3766  1.4702   \n                                                         t value\nNot at all|A small amount of the time                    -2.7256\nA small amount of the time|A moderate amount of the time -1.8454\nA moderate amount of the time|Most of the time           -0.7272\nMost of the time|All of the time                          0.9363\n\nResidual Deviance: 463.1297 \nAIC: 489.1297 \n\nStepwise Model Summary for Life_experiences :\nCall:\npolr(formula = Life_experiences ~ Age + Gender, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"logistic\")\n\nCoefficients:\n                Value Std. Error t value\nAge          -0.03024   0.007502  -4.030\nGenderFemale  0.61570   0.285973   2.153\nGenderOther  -0.17772   1.572352  -0.113\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.7295  0.5186   \nA small amount of the time|A moderate amount of the time -1.4508  0.4939   \nA moderate amount of the time|Most of the time            0.1332  0.4809   \nMost of the time|All of the time                          2.5074  0.6564   \n                                                         t value\nNot at all|A small amount of the time                    -5.2632\nA small amount of the time|A moderate amount of the time -2.9371\nA moderate amount of the time|Most of the time            0.2770\nMost of the time|All of the time                          3.8197\n\nResidual Deviance: 466.1446 \nAIC: 480.1446 \n\nSummary for Media :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                         Value Std. Error   t value\nAge                                  -0.020246   0.008302 -2.438803\nGenderFemale                         -0.193004   0.324828 -0.594175\nGenderOther                           0.416913   1.729191  0.241103\nMusic_listeningSomewhat rarely        1.103021   1.445189  0.763237\nMusic_listeningModerately frequently -0.210773   1.361649 -0.154792\nMusic_listeningFrequently            -0.229691   1.327884 -0.172976\nMusic_listeningVery frequently       -0.011940   1.317232 -0.009064\nPractice                             -0.002701   0.007657 -0.352757\nFloorUpstairs                         0.212293   0.376081  0.564488\n\nIntercepts:\n                                                         Value    Std. Error\nNot at all|A small amount of the time                     -0.6048   1.3980  \nA small amount of the time|A moderate amount of the time   0.3566   1.3988  \nA moderate amount of the time|Most of the time             1.9812   1.4332  \nMost of the time|All of the time                         268.1394   1.4332  \n                                                         t value \nNot at all|A small amount of the time                     -0.4326\nA small amount of the time|A moderate amount of the time   0.2549\nA moderate amount of the time|Most of the time             1.3823\nMost of the time|All of the time                         187.0921\n\nResidual Deviance: 327.3299 \nAIC: 353.3299 \n\nStepwise Model Summary for Media :\nCall:\npolr(formula = Media ~ Age, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.02224   0.007854  -2.832\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.6811  0.4617   \nA small amount of the time|A moderate amount of the time  0.2449  0.4587   \nA moderate amount of the time|Most of the time            1.8131  0.5417   \nMost of the time|All of the time                          9.7208 19.2935   \n                                                         t value\nNot at all|A small amount of the time                    -1.4753\nA small amount of the time|A moderate amount of the time  0.5339\nA moderate amount of the time|Most of the time            3.3471\nMost of the time|All of the time                          0.5038\n\nResidual Deviance: 333.4143 \nAIC: 343.4143 \n\nSummary for Music :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                         Value Std. Error  t value\nAge                                  -0.005387   0.007741 -0.69591\nGenderFemale                          0.342148   0.294890  1.16026\nGenderOther                           0.172715   1.798501  0.09603\nMusic_listeningSomewhat rarely        2.917091   1.358508  2.14728\nMusic_listeningModerately frequently  2.184330   1.243854  1.75610\nMusic_listeningFrequently             2.433851   1.222099  1.99153\nMusic_listeningVery frequently        3.435359   1.230974  2.79076\nPractice                              0.018228   0.006886  2.64728\nFloorUpstairs                        -0.171472   0.318814 -0.53784\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.6953  1.2888   \nA small amount of the time|A moderate amount of the time  0.6585  1.2562   \nA moderate amount of the time|Most of the time            2.1175  1.2730   \nMost of the time|All of the time                          4.2542  1.2971   \n                                                         t value\nNot at all|A small amount of the time                    -0.5395\nA small amount of the time|A moderate amount of the time  0.5242\nA moderate amount of the time|Most of the time            1.6634\nMost of the time|All of the time                          3.2798\n\nResidual Deviance: 431.4689 \nAIC: 457.4689 \n\nStepwise Model Summary for Music :\nCall:\npolr(formula = Music ~ Music_listening + Practice, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"logistic\")\n\nCoefficients:\n                                       Value Std. Error t value\nMusic_listeningSomewhat rarely       2.79040   1.375870   2.028\nMusic_listeningModerately frequently 2.01818   1.283926   1.572\nMusic_listeningFrequently            2.29860   1.273278   1.805\nMusic_listeningVery frequently       3.30313   1.276230   2.588\nPractice                             0.01665   0.006695   2.487\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.6054  1.2909   \nA small amount of the time|A moderate amount of the time  0.7306  1.2571   \nA moderate amount of the time|Most of the time            2.1838  1.2732   \nMost of the time|All of the time                          4.3102  1.2978   \n                                                         t value\nNot at all|A small amount of the time                    -0.4690\nA small amount of the time|A moderate amount of the time  0.5812\nA moderate amount of the time|Most of the time            1.7152\nMost of the time|All of the time                          3.3211\n\nResidual Deviance: 433.5155 \nAIC: 451.5155 \n\nSummary for Future_plans :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                          Value Std. Error  t value\nAge                                  -0.0517714   0.008569 -6.04139\nGenderFemale                         -0.1757382   0.295222 -0.59528\nGenderOther                          -1.7209682   1.704173 -1.00986\nMusic_listeningSomewhat rarely        0.1894178   1.303459  0.14532\nMusic_listeningModerately frequently -0.2711655   1.197084 -0.22652\nMusic_listeningFrequently            -0.9689112   1.178356 -0.82226\nMusic_listeningVery frequently       -0.7089336   1.176264 -0.60270\nPractice                             -0.0002543   0.007241 -0.03512\nFloorUpstairs                        -0.1261378   0.323305 -0.39015\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -4.3831  1.2727   \nA small amount of the time|A moderate amount of the time -3.1203  1.2486   \nA moderate amount of the time|Most of the time           -1.6050  1.2286   \nMost of the time|All of the time                          0.2254  1.2871   \n                                                         t value\nNot at all|A small amount of the time                    -3.4438\nA small amount of the time|A moderate amount of the time -2.4990\nA moderate amount of the time|Most of the time           -1.3064\nMost of the time|All of the time                          0.1751\n\nResidual Deviance: 425.4461 \nAIC: 451.4461 \n\nStepwise Model Summary for Future_plans :\nCall:\npolr(formula = Future_plans ~ Age, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.04841   0.008102  -5.975\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -3.3726  0.5212   \nA small amount of the time|A moderate amount of the time -2.1392  0.4825   \nA moderate amount of the time|Most of the time           -0.6560  0.4571   \nMost of the time|All of the time                          1.1340  0.5808   \n                                                         t value\nNot at all|A small amount of the time                    -6.4705\nA small amount of the time|A moderate amount of the time -4.4338\nA moderate amount of the time|Most of the time           -1.4351\nMost of the time|All of the time                          1.9526\n\nResidual Deviance: 431.1522 \nAIC: 441.1522 \n\nSummary for Building :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                         Value Std. Error    t value\nAge                                  -0.024738  7.989e-03 -3.096e+00\nGenderFemale                         -0.625787  3.082e-01 -2.031e+00\nGenderOther                          -8.805429  6.902e-05 -1.276e+05\nMusic_listeningSomewhat rarely       12.036353  5.388e-01  2.234e+01\nMusic_listeningModerately frequently 12.607143  3.224e-01  3.910e+01\nMusic_listeningFrequently            12.971602  2.774e-01  4.675e+01\nMusic_listeningVery frequently       13.179227  2.759e-01  4.777e+01\nPractice                             -0.002493  6.962e-03 -3.581e-01\nFloorUpstairs                         0.650667  3.484e-01  1.868e+00\n\nIntercepts:\n                                                         Value       \nNot at all|A small amount of the time                         11.3396\nA small amount of the time|A moderate amount of the time      13.2252\nA moderate amount of the time|Most of the time                14.9084\nMost of the time|All of the time                              16.2193\n                                                         Std. Error  \nNot at all|A small amount of the time                          0.5042\nA small amount of the time|A moderate amount of the time       0.5043\nA moderate amount of the time|Most of the time                 0.5896\nMost of the time|All of the time                               0.8369\n                                                         t value     \nNot at all|A small amount of the time                         22.4880\nA small amount of the time|A moderate amount of the time      26.2223\nA moderate amount of the time|Most of the time                25.2843\nMost of the time|All of the time                              19.3791\n\nResidual Deviance: 359.5096 \nAIC: 385.5096 \n\nStepwise Model Summary for Building :\nCall:\npolr(formula = Building ~ Age + Gender + Floor, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"logistic\")\n\nCoefficients:\n                  Value Std. Error    t value\nAge            -0.02467  7.841e-03 -3.147e+00\nGenderFemale   -0.57858  2.998e-01 -1.930e+00\nGenderOther   -15.17738  1.448e-07 -1.048e+08\nFloorUpstairs   0.59173  3.327e-01  1.779e+00\n\nIntercepts:\n                                                         Value        \nNot at all|A small amount of the time                    -1.500500e+00\nA small amount of the time|A moderate amount of the time  3.271000e-01\nA moderate amount of the time|Most of the time            1.972800e+00\nMost of the time|All of the time                          3.272700e+00\n                                                         Std. Error   \nNot at all|A small amount of the time                     5.893000e-01\nA small amount of the time|A moderate amount of the time  5.767000e-01\nA moderate amount of the time|Most of the time            6.475000e-01\nMost of the time|All of the time                          8.783000e-01\n                                                         t value      \nNot at all|A small amount of the time                    -2.546400e+00\nA small amount of the time|A moderate amount of the time  5.673000e-01\nA moderate amount of the time|Most of the time            3.046600e+00\nMost of the time|All of the time                          3.726000e+00\n\nResidual Deviance: 367.5854 \nAIC: 383.5854 \n\nSummary for Everyday :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                        Value Std. Error  t value\nAge                                  -0.02801   0.008060 -3.47493\nGenderFemale                          0.12354   0.295178  0.41851\nGenderOther                           0.31282   1.766320  0.17710\nMusic_listeningSomewhat rarely       -1.36382   1.370967 -0.99478\nMusic_listeningModerately frequently  0.22782   1.231383  0.18501\nMusic_listeningFrequently            -0.29107   1.211772 -0.24020\nMusic_listeningVery frequently        0.08650   1.206193  0.07172\nPractice                             -0.01023   0.007069 -1.44743\nFloorUpstairs                        -0.02558   0.330031 -0.07751\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.5242  1.2736   \nA small amount of the time|A moderate amount of the time -0.6805  1.2596   \nA moderate amount of the time|Most of the time            0.8269  1.2766   \nMost of the time|All of the time                          2.1008  1.3399   \n                                                         t value\nNot at all|A small amount of the time                    -1.9820\nA small amount of the time|A moderate amount of the time -0.5402\nA moderate amount of the time|Most of the time            0.6477\nMost of the time|All of the time                          1.5679\n\nResidual Deviance: 415.8977 \nAIC: 441.8977 \n\nStepwise Model Summary for Everyday :\nCall:\npolr(formula = Everyday ~ Age, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.02455   0.007422  -3.307\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.1073  0.4742   \nA small amount of the time|A moderate amount of the time -0.3377  0.4466   \nA moderate amount of the time|Most of the time            1.1491  0.4855   \nMost of the time|All of the time                          2.4138  0.6321   \n                                                         t value\nNot at all|A small amount of the time                    -4.4437\nA small amount of the time|A moderate amount of the time -0.7563\nA moderate amount of the time|Most of the time            2.3665\nMost of the time|All of the time                          3.8188\n\nResidual Deviance: 424.6746 \nAIC: 434.6746 \n\n\nFrom the above, we can see that the models with the lowest AIC (using just main effects) are as follows:\nFictional story: polr(formula = Fictional_story ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nAbstract shapes: polr(formula = Abstract_shapes ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nSensory sensations: polr(formula = Sensory_sensations ~ 1, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nLife experiences: polr(formula = Life_experiences ~ Age + Gender, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nMedia: polr(formula = Media ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nMusic: polr(formula = Music ~ Music_listening + Practice, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nFuture plans: polr(formula = Future_plans ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nBuilding: polr(formula = Building ~ Age + Gender + Music_listening + Floor, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nEveryday: polr(formula = Everyday ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nLet’s also look at the interactions between the demographic variables and check for multicollinearity.\n\nlibrary(conflicted)\nconflict_prefer(\"filter\", \"dplyr\")\n\ndemographics &lt;- c('Age', 'Gender', 'Music_listening', 'Practice', 'Floor')\ndemographics_data &lt;- dplyr::select(data1, all_of(demographics))\n\n# Convert categorical variables to numeric\ndemographics_numeric &lt;- demographics_data %&gt;%\n  mutate(\n    Gender = as.numeric(factor(Gender)),\n    Music_listening = as.numeric(factor(Music_listening, ordered = TRUE)),  \n    Floor = as.numeric(factor(Floor))\n  ) \n\n# Compute correlation matrix\ncor_matrix &lt;- cor(demographics_numeric, use = \"pairwise.complete.obs\")\n\ncorrplot(cor_matrix, method = \"color\", type = \"lower\", \n         tl.col = \"black\", tl.srt = 45, addCoef.col = \"white\", \n         col = colorRampPalette(c(\"blue\", \"white\", \"red\"))(200))\n\n\n\n\n\n\n\n#Checking for collinearity\nmodel1 &lt;- lm(Age ~ Practice + Gender + Music_listening + Floor, data = demographics_numeric)\nmodel2 &lt;- lm(Gender ~ Age + Practice + Music_listening + Floor, data = demographics_numeric)\nmodel3 &lt;- lm(Practice ~ Age + Gender + Music_listening + Floor, data = demographics_numeric)\nmodel4 &lt;- lm(Music_listening ~ Age + Gender + Practice + Floor, data = demographics_numeric)\nmodel5 &lt;- lm(Floor ~ Age + Gender + Practice + Music_listening, data = demographics_numeric)\nvif(model1)\n\n       Practice          Gender Music_listening           Floor \n       1.036377        1.002153        1.034110        1.003875 \n\nvif(model2)\n\n            Age        Practice Music_listening           Floor \n       1.086216        1.067477        1.034662        1.059068 \n\nvif(model3)\n\n            Age          Gender Music_listening           Floor \n       1.064866        1.011938        1.004652        1.051720 \n\nvif(model4)\n\n     Age   Gender Practice    Floor \n1.096117 1.011828 1.036402 1.058475 \n\nvif(model5)\n\n            Age          Gender        Practice Music_listening \n       1.039690        1.011967        1.060100        1.034224 \n\n\nAll vif() outputs are close to 1, indicating that multicollinearity shouldn’t be a problem.\nIn the post on ‘Ordinal regression: final models’, we’ll use these step() results to run some final model visualisations."
  },
  {
    "objectID": "posts/Descriptive_1/Descriptive1.html",
    "href": "posts/Descriptive_1/Descriptive1.html",
    "title": "Some descriptive visualisations",
    "section": "",
    "text": "In this section we’ll look at the overall distribution of different thought types and movements in the datasets.\n\nlibrary(tidyverse)\nlibrary(broom)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(knitr)\nlibrary(skimr)\n\nHere are the dataframes that we tidied up in the dataset overview page.\n\ndata &lt;- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data.csv\")\n\ndata2 &lt;- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data2.csv\")\n\nWe’ll start by visualising the counts for each type of thought in each half of the concert. Here we’re creating a dataframe showing thought types in a long format with counts for each.\n\nthought_types &lt;- c(\"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \"Building\", \"Everyday\")\n\n#First half of concert\nthoughts_long1 &lt;- data %&gt;%\n  pivot_longer(cols = thought_types,\n               names_to = \"Category\", \n               values_to = \"Response\") %&gt;%\n  count(Category, Response) %&gt;% \n  mutate(Response = factor(Response, \n                           levels = c(\"Not at all\", \n                                      \"A small amount of the time\", \n                                      \"A moderate amount of the time\", \n                                      \"Most of the time\", \n                                      \"All of the time\"))) %&gt;% \n  mutate(Category = factor(Category, levels = rev(c(\"Fictional_story\", \n                                                    \"Abstract_shapes\", \n                                                    \"Sensory_sensations\", \n                                                    \"Life_experiences\", \n                                                    \"Media\", \n                                                    \"Music\", \n                                                    \"Future_plans\", \n                                                    \"Building\", \n                                                    \"Everyday\")))) %&gt;% filter(!is.na(Response))\n\n#Second half of concert\nthoughts_long2 &lt;- data2 %&gt;%\n  pivot_longer(cols = thought_types,\n               names_to = \"Category\", \n               values_to = \"Response\") %&gt;%\n  count(Category, Response) %&gt;% \n  mutate(Response = factor(Response, \n                           levels = c(\"Not at all\", \n                                      \"A small amount of the time\", \n                                      \"A moderate amount of the time\", \n                                      \"Most of the time\", \n                                      \"All of the time\"))) %&gt;% \n  mutate(Category = factor(Category, \n                           levels = rev(c(\"Fictional_story\", \n                                          \"Abstract_shapes\", \n                                          \"Sensory_sensations\", \n                                          \"Life_experiences\", \n                                          \"Media\", \n                                          \"Music\", \n                                          \"Future_plans\", \n                                          \"Building\", \n                                          \"Everyday\")))) %&gt;% \n  filter(!is.na(Response))\n\nThese dataframes are used for the first plots, which show the counts for each type of thought during each half.\n\n#First half\nggplot(thoughts_long1, aes(x = Response, y = Category, fill = n)) +\n  geom_tile(color = \"white\") +  # Add white borders to tiles\n  scale_fill_gradient(low = \"lightblue\", high = \"darkblue\") + \n  labs(title = \"Counts for Thought Types, First Half\", x = NULL, y = NULL, fill = \"Count\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\n#Second half\nggplot(thoughts_long2, aes(x = Response, y = Category, fill = n)) +\n  geom_tile(color = \"white\") +\n  scale_fill_gradient(low = \"lightblue\", high = \"darkblue\") + \n  labs(title = \"Counts for Thought Types, Second Half\", x = NULL, y = NULL, fill = \"Count\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\n\nThen we examine the counts for the movements people select as invoking the most vivid memory or story.\n\n# First half of concert, collecting movement names in usable format:\nmems &lt;- data$Movement_mem %&gt;% na.omit() %&gt;% toupper()\nstories &lt;- data$Movement_story %&gt;% na.omit() %&gt;% toupper()\n\nmovements_mem &lt;- unlist(strsplit(mems, \"[; ,]+\")) %&gt;% trimws()\nmovements_story &lt;- unlist(strsplit(stories, \"[; ,]+\")) %&gt;% trimws()\n\nmovements_mem &lt;- table(movements_mem)\nmovements_story &lt;- table(movements_story)\n\n\n# Second half of concert, collecting movement names in usable format:\nmems2 &lt;- data2$Movement_mem %&gt;% na.omit() %&gt;% toupper()\nstories2 &lt;- data2$Movement_story %&gt;% na.omit() %&gt;% toupper()\n\nmovements_mem2 &lt;- unlist(strsplit(mems2, \"[; ,]+\")) %&gt;% trimws()\nmovements_story2 &lt;- unlist(strsplit(stories2, \"[; ,]+\")) %&gt;% trimws()\n\nmovements_mem2 &lt;- table(movements_mem2)\nmovements_story2 &lt;- table(movements_story2)\n\n#Map for recoding movements using full names\nrecode_map &lt;- c(\n  \"B1\" = \"Beethoven, Movement 1 — Allegro con brio\",\n  \"B2\" = \"Beethoven, Movement 2 — Adagio affettuoso ed appassionato\",\n  \"B3\" = \"Beethoven, Movement 3 — Scherzo\",\n  \"B4\" = \"Beethoven, Movement 4 — Allegro\",\n  \"H1\" = \"Hough, Movement 1 — Au boulevard\",\n  \"H2\" = \"Hough, Movement 2 — Au parc\",\n  \"H3\" = \"Hough, Movement 3 — À l'hôtel\",\n  \"H4\" = \"Hough, Movement 4 — Au théâtre\",\n  \"H5\" = \"Hough, Movement 5 — À l'église\",\n  \"H6\" = \"Hough, Movement 6 — Au marché\",\n  \"BR1\" = \"Brahms, movement 1 — Allegro non troppo\", \n  \"BR2\" = \"Brahms, movement 2 — Andante, un poco adagio\", \n  \"BR3\" = \"Brahms, movement 3 — Scherzo: Allegro\", \n  \"BR4\" = \"Brahms, movement 4 — Finale\"\n)\n\n# Recode names in the frequency tables\nnames(movements_mem) &lt;- recode(names(movements_mem), !!!recode_map)\nnames(movements_story) &lt;- recode(names(movements_story), !!!recode_map)\nnames(movements_mem2) &lt;- recode(names(movements_mem2), !!!recode_map)\nnames(movements_story2) &lt;- recode(names(movements_story2), !!!recode_map)\n\n# Convert tables to data frames and rename columns\ndf_mem1 &lt;- as.data.frame(movements_mem)\ncolnames(df_mem1) &lt;- c(\"Movement_eliciting_memory\", \"Count\")\n\ndf_story1 &lt;- as.data.frame(movements_story)\ncolnames(df_story1) &lt;- c(\"Movement_eliciting_story\", \"Count\")\n\ndf_mem2 &lt;- as.data.frame(movements_mem2)\ncolnames(df_mem2) &lt;- c(\"Movement_eliciting_memory\", \"Count\")\n\ndf_story2 &lt;- as.data.frame(movements_story2)\ncolnames(df_story2) &lt;- c(\"Movement_eliciting_story\", \"Count\")\n\n# Display frequency tables with full movement names\nkable(df_mem1)\n\n\n\n\nMovement_eliciting_memory\nCount\n\n\n\n\nBeethoven, Movement 1 — Allegro con brio\n34\n\n\nBeethoven, Movement 2 — Adagio affettuoso ed appassionato\n46\n\n\nBeethoven, Movement 3 — Scherzo\n15\n\n\nBeethoven, Movement 4 — Allegro\n10\n\n\nHough, Movement 1 — Au boulevard\n13\n\n\nHough, Movement 2 — Au parc\n17\n\n\nHough, Movement 3 — À l’hôtel\n12\n\n\nHough, Movement 4 — Au théâtre\n16\n\n\nHough, Movement 5 — À l’église\n17\n\n\nHough, Movement 6 — Au marché\n21\n\n\n\n\nkable(df_story1)\n\n\n\n\nMovement_eliciting_story\nCount\n\n\n\n\nBeethoven, Movement 1 — Allegro con brio\n16\n\n\nBeethoven, Movement 2 — Adagio affettuoso ed appassionato\n25\n\n\nBeethoven, Movement 3 — Scherzo\n14\n\n\nBeethoven, Movement 4 — Allegro\n9\n\n\nBrahms, movement 2 — Andante, un poco adagio\n2\n\n\nHough, Movement 1 — Au boulevard\n13\n\n\nHough, Movement 2 — Au parc\n21\n\n\nHough, Movement 3 — À l’hôtel\n9\n\n\nHough, Movement 4 — Au théâtre\n24\n\n\nHough, Movement 5 — À l’église\n11\n\n\nHough, Movement 6 — Au marché\n17\n\n\n\n\nkable(df_mem2)\n\n\n\n\nMovement_eliciting_memory\nCount\n\n\n\n\nBrahms, movement 1 — Allegro non troppo\n38\n\n\nBrahms, movement 2 — Andante, un poco adagio\n31\n\n\nBrahms, movement 3 — Scherzo: Allegro\n50\n\n\nBrahms, movement 4 — Finale\n26\n\n\n\n\nkable(df_story2)\n\n\n\n\nMovement_eliciting_story\nCount\n\n\n\n\nBrahms, movement 1 — Allegro non troppo\n17\n\n\nBrahms, movement 2 — Andante, un poco adagio\n27\n\n\nBrahms, movement 3 — Scherzo: Allegro\n37\n\n\nBrahms, movement 4 — Finale\n29\n\n\n\n\n\nThese can be plotted:\n\n# Add a Composer column (Beethoven for B1-B4, Hough for H1-H6)\ndf_mem1$Composer &lt;- ifelse(grepl(\"^Beethoven\", df_mem1$Movement_eliciting_memory), \"Beethoven\", \"Hough\")\ndf_story1$Composer &lt;- ifelse(grepl(\"^Beethoven\", df_story1$Movement_eliciting_story), \"Beethoven\", \"Hough\")\n\n# Set movement factor levels for proper ordering\ndf_mem1$Movement &lt;- factor(df_mem1$Movement, levels = recode_map)\ndf_story1$Movement &lt;- factor(df_story1$Movement, levels = recode_map)\n\n# Plot for memories, first half\nmem_plot1 &lt;- ggplot(df_mem1, aes(x = Movement_eliciting_memory, y = Count, fill = Movement_eliciting_memory)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  facet_wrap(~ Composer, scales = \"free_x\") +  # Separate Beethoven & Hough\n  theme_minimal() +\n  labs(title = \"Movement Counts for Memories, First Half\", x = \"Movement\", y = \"Count\") +\n theme(axis.title.x = element_blank(),  \n        axis.text.x = element_blank(),  \n        axis.ticks.x = element_blank()) +\n  scale_fill_brewer(palette = \"Set3\") + \n  guides(fill = guide_legend(title = \"Movement\")) +\n  scale_y_continuous(breaks = scales::breaks_pretty(n = 5)) \n\n# Plot for stories, first half\nstory_plot1 &lt;- ggplot(df_story1, aes(x = Movement_eliciting_story, y = Count, fill = Movement_eliciting_story)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  facet_wrap(~ Composer, scales = \"free_x\") +  \n  theme_minimal() +\n  labs(title = \"Movement Counts for Stories, First Half\", x = \"Movement\", y = \"Count\") +\n theme(axis.title.x = element_blank(),  \n        axis.text.x = element_blank(),   \n        axis.ticks.x = element_blank()) +\n  scale_fill_brewer(palette = \"Set3\") + \n  guides(fill = guide_legend(title = \"Movement\")) +\n  scale_y_continuous(breaks = scales::breaks_pretty(n = 5)) \n\n\n##Second Half\n# Set movement factor levels for proper ordering\ndf_mem2$Movement_eliciting_memory &lt;- factor(df_mem2$Movement_eliciting_memory, levels = recode_map)\ndf_story2$Movement_eliciting_story &lt;- factor(df_story2$Movement_eliciting_story, levels = recode_map)\n\n# Plot for memories, second half\nmem_plot2 &lt;- ggplot(df_mem2, aes(x = Movement_eliciting_memory, y = Count, fill = Movement_eliciting_memory)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  theme_minimal() +\n  labs(title = \"Movement Counts for Memories, Second Half\", x = \"Movement\", y = \"Count\") +\n theme(axis.title.x = element_blank(), \n        axis.text.x = element_blank(),  \n        axis.ticks.x = element_blank()) +\n  scale_fill_brewer(palette = \"Set3\") + \n  guides(fill = guide_legend(title = \"Movement\")) +\n  scale_y_continuous(breaks = scales::breaks_pretty(n = 5))  \n\n# Plot for stories, second half\nstory_plot2 &lt;- ggplot(df_story2, aes(x = Movement_eliciting_story, y = Count, fill = Movement_eliciting_story)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  theme_minimal() +\n  labs(title = \"Movement Counts for Stories, Second Half\", x = \"Movement\", y = \"Count\") +\n theme(axis.title.x = element_blank(),  \n        axis.text.x = element_blank(),  \n        axis.ticks.x = element_blank()) +\n  scale_fill_brewer(palette = \"Set3\") + \n  guides(fill = guide_legend(title = \"Movement\")) +\n  scale_y_continuous(breaks = scales::breaks_pretty(n = 5)) \n\nmem_plot1\n\n\n\n\n\n\n\nstory_plot1\n\n\n\n\n\n\n\nmem_plot2\n\n\n\n\n\n\n\nstory_plot2\n\n\n\n\n\n\n\n\nDEMOGRAPHIC INFO\nWe’ll get a quick overview of our demographic data. Note, first we’re going to add a ‘Floor’ column based on participants’ location in the hall. Having this info is useful, as concert subscribers and many older patrons sit downstairs in the auditorium.\nHere’s a map of each location in the hall for reference:\n\nCreating the floor variable:\n\ndata &lt;- data %&gt;%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %&gt;% relocate(Floor, .after = Location)\n\nAnd an overview of our demographics variables:\n\ndemographics &lt;- c('Age', 'Gender', 'Music_listening', 'Practice', 'Floor')\ndemographics_data &lt;- dplyr::select(data, all_of(demographics))\nskim(demographics_data)\n\n\nData summary\n\n\nName\ndemographics_data\n\n\nNumber of rows\n169\n\n\nNumber of columns\n5\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\ncharacter\n4\n\n\nnumeric\n1\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: character\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmin\nmax\nempty\nn_unique\nwhitespace\n\n\n\n\nAge\n8\n0.95\n2\n26\n0\n66\n0\n\n\nGender\n1\n0.99\n1\n17\n0\n9\n0\n\n\nMusic_listening\n4\n0.98\n10\n21\n0\n5\n0\n\n\nFloor\n0\n1.00\n8\n10\n0\n2\n0\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\nPractice\n32\n0.81\n17.65\n22.28\n0\n0\n10\n25\n80\n▇▂▁▁▁"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Tutorial",
    "section": "",
    "text": "An overview of the dataset\n\n\n\n\n\n\n\n\n\n\n\nHannah Wilkie\n\n\n\n\n\n\n\n\n\n\n\n\nSome descriptive visualisations\n\n\n\n\n\n\n\n\n\n\n\nHannah Wilkie\n\n\n\n\n\n\n\n\n\n\n\n\nOrdinal regression: an overview\n\n\n\n\n\n\n\n\n\n\n\nHannah Wilkie\n\n\n\n\n\n\n\n\n\n\n\n\nOrdinal regression: model selection\n\n\n\n\n\n\n\n\n\n\n\nHannah Wilkie\n\n\n\n\n\n\n\n\n\n\n\n\nOrdinal regression: final models\n\n\n\n\n\n\n\n\n\n\n\nHannah Wilkie\n\n\n\n\n\n\n\n\n\n\n\n\nSummary\n\n\n\n\n\n\n\n\n\n\n\nHannah Wilkie\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "posts/Dataset_overview/Dataset_overview.html",
    "href": "posts/Dataset_overview/Dataset_overview.html",
    "title": "An overview of the dataset",
    "section": "",
    "text": "This dataset examines the musical imaginings that people experience in a live concert setting. The data was collected in a survey format.\nFor some background, the survey in question was distributed at a classical concert in the Princeton University Concerts series (Feb 20th, 2025). During the concert’s intermission, and at the end of the concert, audience members answered a series of questions designed to scrutinise the nature of their imaginative responses to the music performed. Distribution was via both paper surveys, and online using Qualtrics. In each part of the survey, the audience were asked about the frequency with which they experienced different types of thought, memory and imagining. They then identified the musical movements during which they imagined the most vivid fictional scenes and memories, and provided free-text responses describing these.\nYou can find a PDF of the paper survey here for reference:\nhttps://raw.githubusercontent.com/hw3446/Final_Project_PUC/59ab7bc00c7b9a0fc35517cc5b3335cf23fdc4ab/Paper_survey.pdf\n\nlibrary(tidyverse)\nlibrary(broom)\nlibrary(dplyr)\nlibrary(ggplot2)\n\nThe data is in two halves for intermission and post-concert data. It is also divided into paper and online data. We’ll start by loading all the intermission data.\n\nlibrary(conflicted)\nconflict_prefer(\"filter\", \"dplyr\")\n\ndata_paper &lt;- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/input/PUC1.csv\")\n\ndata_qualtrics &lt;- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/input_qualtrics/PUC1.csv\")\n\nIn order to combine the two intermission datasets, we need to reshape them a little bit.\n\n##Here I'm just recoding some of the numeric values in the paper dataset to align with their likert scale values, for readability.\n\nrecode &lt;- c(\"1\" = \"Not at all\",\n                \"2\" = \"A small amount of the time\",\n                \"3\" = \"A moderate amount of the time\",\n                \"4\" = \"Most of the time\",\n                \"5\" = \"All of the time\")\n\nrecode2 &lt;- c(\"1\" = \"Not at all\",\n             \"2\" = \"Slightly\",\n             \"3\" = \"Moderately\",\n             \"4\" = \"Mostly\",\n             \"5\" = \"Entirely\")\n\nrecode3 &lt;- c(\"1\" = \"Very rarely\",\n             \"2\" = \"Somewhat rarely\",\n             \"3\" = \"Moderately frequently\",\n             \"4\" = \"Frequently\",\n             \"5\" = \"Very frequently\")\n\ndata_paper[, 2:10] &lt;- lapply(data_paper[, 2:10], function(x) recode[as.character(x)])\ndata_paper[, 13:15] &lt;- lapply(data_paper[, 13:15], function(x) recode2[as.character(x)])\ndata_paper[, 18:20] &lt;- lapply(data_paper[, 18:20], function(x) recode2[as.character(x)])\ndata_paper[, 24] &lt;- lapply(data_paper[, 24], function(x) recode3[as.character(x)])\n\nIn the qualtrics data there are some extra columns that we don’t need, so we’re getting rid of those.\n\ndata_qualtrics &lt;- data_qualtrics %&gt;% dplyr::filter(Finished == \"TRUE\") %&gt;% \n  dplyr::select(-StartDate, -EndDate, -Status, -Progress, -Duration, \n         -RecordedDate, -DistributionChannel, -UserLanguage, -Finished, -Q1, -ResponseId)\n\nThe way people select composer and movement is different for the paper and online surveys, so we need to get them in a matching format.\n\ncomposer_initials &lt;- data.frame(\n  composer = c(\"Beethoven\", \"Hough\"),\n  composer_initial = c(\"B\", \"H\")\n)\n\ndata_long &lt;- data_qualtrics %&gt;%\n  pivot_longer(\n    cols = starts_with(\"Movement\"),\n    names_to = \"source_col\",\n    values_to = \"movement_label\"\n  ) %&gt;%\n  filter(!is.na(movement_label)) %&gt;%\n  mutate(\n    composer = case_when(\n      str_detect(source_col, \"_B_\") ~ \"Beethoven\",\n      str_detect(source_col, \"_H_\") ~ \"Hough\"\n    ),\n    type = case_when(\n      str_detect(source_col, \"_mem$\") ~ \"mem\",\n      str_detect(source_col, \"_story$\") ~ \"story\"\n    ),\n    movement = as.integer(str_extract(movement_label, \"\\\\d+\"))\n  ) %&gt;%\n  left_join(composer_initials, by = \"composer\") %&gt;%\n  mutate(code = paste0(composer_initial, movement))\n\ndata_wide &lt;- data_long %&gt;%\n  dplyr::select(ID, type, code) %&gt;%\n  pivot_wider(\n    names_from = type,\n    values_from = code,\n    names_prefix = \"Movement_\"\n  )\n\nfinal_qualtrics &lt;- data_qualtrics %&gt;%\n  left_join(data_wide, by = \"ID\")\n\nWe also need to check that the matching columns in the two dataframes are of the same class:\n\ncommon_cols &lt;- intersect(names(data_paper), names(final_qualtrics))\n\nclass_match &lt;- sapply(common_cols, function(col) {\n  class(data_paper[[col]]) == class(final_qualtrics[[col]])\n})\n\nclass_match\n\n    Fictional_story     Abstract_shapes  Sensory_sensations    Life_experiences \n               TRUE                TRUE                TRUE                TRUE \n              Media               Music        Future_plans            Building \n               TRUE                TRUE                TRUE                TRUE \n           Everyday        Movement_mem     Mem_description    Mem_music_evoked \n               TRUE                TRUE                TRUE                TRUE \n    Mem_spontaneity   Mem_individuality      Movement_story   Story_description \n               TRUE                TRUE                TRUE                TRUE \n Story_music_evoked   Story_spontaneity Story_individuality          Other_info \n               TRUE                TRUE                TRUE                TRUE \n                Age              Gender     Music_listening            Practice \n               TRUE                TRUE                TRUE               FALSE \n           Location \n               TRUE \n\n\n\nfinal_qualtrics$Practice &lt;- as.numeric(final_qualtrics$Practice)\ndata_paper$Practice &lt;- as.numeric(data_paper$Practice)\n\nNow we can combine the dataframes.\n\ndata &lt;- bind_rows(data_paper, final_qualtrics)\ndata &lt;- data%&gt;% dplyr::select(-Movement_H_story, -Movement_B_story, -Piece_story, -Movement_H_mem, -Movement_B_mem, -Piece_mem)\n\nNote: to keep track of participants between each half of the survey, they were given a random ID in qualtrics, or were manually numbered in the paper data. We’re keeping hold of these columns for now so we can match the demographic variables to the right participant when we load the post-concert data. But essentially, participants who were online won’t have a participant number, and paper participants won’t have an ID.\n\ndata[] &lt;- lapply(data, function(col) {\n  if (is.character(col)) iconv(col, from = \"\", to = \"UTF-8\", sub = \"byte\") else col\n})\n\nlibrary(DT)\ndatatable(data)\n\n\n\n\n\nSECOND HALF\nThese next steps essentially repeat the above, but for the post-concert data.\nLoading the data:\n\ndata_paper2 &lt;- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/input/PUC2.csv\")\n\ndata_qualtrics2 &lt;- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/input_qualtrics/PUC2.csv\")\n\nRecoding / removing unnecessary columns:\n\nrecode &lt;- c(\"1\" = \"Not at all\",\n                \"2\" = \"A small amount of the time\",\n                \"3\" = \"A moderate amount of the time\",\n                \"4\" = \"Most of the time\",\n                \"5\" = \"All of the time\")\n\nrecode2 &lt;- c(\"1\" = \"Not at all\",\n             \"2\" = \"Slightly\",\n             \"3\" = \"Moderately\",\n             \"4\" = \"Mostly\",\n             \"5\" = \"Entirely\")\n\ndata_paper2[, 2:10] &lt;- lapply(data_paper2[, 2:10], function(x) recode[as.character(x)])\ndata_paper2[, 13:15] &lt;- lapply(data_paper2[, 13:15], function(x) recode2[as.character(x)])\ndata_paper2[, 18:20] &lt;- lapply(data_paper2[, 18:20], function(x) recode2[as.character(x)])\n\ndata_qualtrics2 &lt;- data_qualtrics2 %&gt;% dplyr::filter(Finished == \"TRUE\") %&gt;% \n  dplyr::select(-StartDate, -EndDate, -Status, -Progress, -Duration, \n         -RecordedDate, -DistributionChannel, -UserLanguage, -Finished, -ResponseId)\n\nReworking Qualtrics data so the formats match:\n\nfinal_qualtrics2 &lt;- data_qualtrics2 %&gt;%\n    filter(!is.na(Movement_mem)) %&gt;% filter(!is.na(Movement_story)) %&gt;%\n  mutate(Movement_mem = paste0(\"Br\", str_extract(Movement_mem, \"\\\\d+\"))) %&gt;%\n    mutate(Movement_story = paste0(\"Br\", str_extract(Movement_story, \"\\\\d+\")))\n\nCombining Qualtrics and paper data:\n\ndata2 &lt;- bind_rows(data_paper2, final_qualtrics2)\n\nIMPORTANT: We need to pull the demographic information from the first half of the concert and match it to the second half, making sure it’s matched to the right participant. We can do this using the numbers and unique IDs assigned to participants.\n\ndemographics &lt;- data[, c(\"Age\", \"Gender\", \"Music_listening\", \"Practice\", \"Location\", \"Participant_number\", \"ID\")] \n\ndata2 &lt;- data2 %&gt;%\n  mutate(join_key = ifelse(!is.na(Participant_number), Participant_number, ID))\n\ndemographics &lt;- demographics %&gt;%\n  mutate(join_key = ifelse(!is.na(Participant_number), Participant_number, ID))\n\ndata2 &lt;- data2 %&gt;%\n  left_join(demographics, by = \"join_key\")\n\ndata2 &lt;- data2 %&gt;% dplyr::select(-Participant_number.y, -ID.y, -Participant_number.x, -ID.x)\n\n\ndata2[] &lt;- lapply(data2, function(col) {\n  if (is.character(col)) iconv(col, from = \"\", to = \"UTF-8\", sub = \"byte\") else col\n})\ndatatable(data2)\n\n\n\n\n\n(These are the two dataframes that we’ll be loading and working with in other sections of this blog.)\n\nwrite.csv(data, \"working_data/data.csv\", row.names = FALSE)\nwrite.csv(data2, \"working_data/data2.csv\", row.names = FALSE)"
  },
  {
    "objectID": "posts/Modelling_1/Modelling 1.html",
    "href": "posts/Modelling_1/Modelling 1.html",
    "title": "Ordinal regression: an overview",
    "section": "",
    "text": "library(tidyverse)\nlibrary(broom)\nlibrary(performance)\nlibrary(ordinal)\nlibrary(car)\nlibrary(ggeffects)\nlibrary(gofcat) \nlibrary(brms)\nlibrary(emmeans)\nlibrary(knitr)\nlibrary(MASS)\n\nIn this section, we’ll discuss how to model some of our data using ordinal regression. This will examine the relationship between demographic data and thought types.\nLet’s reload our data from each half of the concert:\n\ndata1 &lt;- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data.csv\")\n\ndata2 &lt;- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data2.csv\")\n\nBefore constructing models, we’ll make sure all of our demographic and outcome variables are classed in the right way.\n\noutcome_vars &lt;- c(\"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \n                  \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \n                  \"Building\", \"Everyday\")\n\n# Converting outcome variables to factors with consistent levels for each thought type\ndata1[outcome_vars] &lt;- lapply(data1[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\ndata2[outcome_vars] &lt;- lapply(data2[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\n#Just remaking the floor variable\ndata1 &lt;- data1 %&gt;%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %&gt;% relocate(Floor, .after = Location)\n\ndata2 &lt;- data2 %&gt;%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %&gt;% relocate(Floor, .after = Location)\n\n#Making sure demographic variables are classed in the right way.\ndata1$Age &lt;- as.numeric(data1$Age)\ndata2$Age &lt;- as.numeric(data2$Age)\ndata1$Practice &lt;- as.numeric(as.character(data1$Practice))\ndata2$Practice &lt;- as.numeric(as.character(data2$Practice))\ndata1$Gender &lt;- factor(data1$Gender,  levels = c('Male', 'Female', 'Other'))\ndata2$Gender &lt;- factor(data2$Gender,  levels = c('Male', 'Female', 'Other'))\ndata1$Music_listening &lt;- factor(data1$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata2$Music_listening &lt;- factor(data2$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata1$Floor &lt;- factor(data1$Floor, levels = c('Downstairs', 'Upstairs'))\ndata2$Floor &lt;- factor(data2$Floor, levels = c('Downstairs', 'Upstairs'))\n\nLet’s start with a simple model that considers the likelihood of imagining a fictional story based on a particular demographic variable. We’ll just use the data from the first half of the concert.\nHere’s a plot showing the percentage of participants in each ordinal level for fictional story, by gender and age. We’re ignoring N/As for now:\n\ndata1 &lt;- data1 %&gt;%\n  filter(!is.na(Age) & !is.na(Gender) & !is.na(Fictional_story)) %&gt;% filter(Gender != 'Other')\n\nfiction_gender &lt;- data1 %&gt;%\n  group_by(Fictional_story, Gender) %&gt;% summarise(Count = n(), .groups = 'drop') %&gt;%\n  mutate('Percentage' = Count / sum(Count) * 100)\n\nggplot(fiction_gender, aes(x = Fictional_story, y = Percentage, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(x = \"Level\", y = \"Percentage\", fill = \"Gender\") +\n  ggtitle(\"Percentage in Each Level for Fictional Story by Gender\") +\n  theme_minimal() +   theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\nfiction_age &lt;- data1 %&gt;%\n  group_by(Fictional_story, Age) %&gt;% summarise(Count = n(), .groups = 'drop') %&gt;%\n  mutate('Percentage' = Count / sum(Count) * 100)\n\nfiction_age %&gt;% \n  ggplot(aes(x = Fictional_story, y = Age, fill = Fictional_story)) +\n  geom_boxplot() +\n  xlab(\"Level\") + theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\n\nHere’s an alternative visualisation with age as a gouped variable:\n\nmax_age &lt;- max(data1$Age, na.rm = TRUE)\nmin_age &lt;- min(data1$Age, na.rm = TRUE)\n\nbreaks &lt;- c(seq(min_age, max_age - 1, by = 20), max_age)\n\ndata1 &lt;- data1 %&gt;%\n  mutate(Age_grouped = cut(Age, \n                           breaks = breaks,\n                           include.lowest = TRUE,\n                           right = TRUE))\n\n\ndata1$Age_grouped &lt;- as.factor(data1$Age_grouped)\n\nfiction_age_grouped &lt;- data1 %&gt;%\n  group_by(Fictional_story, Age_grouped) %&gt;% summarise(Count = n(), .groups = 'drop') %&gt;%\n  mutate('Percentage' = Count / sum(Count) * 100)\n\nggplot(fiction_age_grouped, aes(x = Fictional_story, y = Percentage, fill = Age_grouped)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(x = \"Fictional_story\", y = \"Percentage\", fill = \"Age Group\") +\n  ggtitle(\"Percentage in Each Level for Fictional Story by Age Group\") +\n  theme_minimal() +   theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n\n\n\n\n\n\n\nTo create an ordinal regression model, we can use the polr() function. An alternative is clm(), but we won’t be using that here for reasons that will become clear in the next post. Here’s a simple example showing the relationship between age and likelihood of imagining a fictional story based on data from the first half of the concert.\n\nmodel_fiction_age &lt;- polr(Fictional_story ~ Age, data = data1, Hess = TRUE)\n\nmodel_fiction_age %&gt;% \n  tidy() %&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\n\nterm\nestimate\nstd.error\nstatistic\ncoef.type\n\n\n\n\nAge\n-0.0177859\n0.0076904\n-2.312746\ncoefficient\n\n\nNot at all|A small amount of the time\n-1.4224110\n0.4825786\n-2.947522\nscale\n\n\nA small amount of the time|A moderate amount of the time\n-0.4669298\n0.4678960\n-0.997935\nscale\n\n\nA moderate amount of the time|Most of the time\n0.4674059\n0.4778772\n0.978088\nscale\n\n\nMost of the time|All of the time\n2.3692958\n0.6214800\n3.812345\nscale\n\n\n\n\n\nggemmeans can be used to visualise the model.\n\npredictions &lt;- ggemmeans(model_fiction_age, terms = \"Age\")\n\nggplot(predictions, aes(x = x, y = predicted, fill = response.level)) +\n  geom_area() + \n  labs(x = \"\\nAge\", \n       y = \"Predicted Probability\\n\", \n       title = \"Fictional_story by Age\") +\n  scale_fill_manual(\n    name = NULL,\n    values = c(\"#deebf7\", \"#9ecae1\", \"#3182bd\", \"#08519c\", \"#08306b\"),\n    labels = c(\"Not at all\",\n               \"A small amount of the time\",\n               \"A moderate amount of the time\",\n               \"Most of the time\",\n               \"All of the time\")\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\nIt’s also good to run a brant test to tell us whether the proportional odds assumption holds in our current model. The assumption is that the relationship between predictor and output is the same across all levels of the ordinal outcomes.\n\nbrant.test(model_fiction_age)\n\n\nBrant Test:\n           chi-sq   df   pr(&gt;chi)\nOmnibus      4.47    3       0.22\nAge          4.47    3       0.22\n\nH0: Proportional odds assumption holds\n\n\nFrom the above, we can see that the proportional odds assumption does hold in our model.\nMODEL COMPARISONS\nLet’s do some comparing comparison now. Here we’re going to integrate age and gender into the same model.\n\nFiction_int &lt;- polr(Fictional_story ~ Gender * Age, data = data1, Hess = TRUE)\n\n    tidy(Fiction_int) %&gt;%\n      kable()\n\n\n\n\n\n\n\n\n\n\n\nterm\nestimate\nstd.error\nstatistic\ncoef.type\n\n\n\n\nGenderFemale\n0.1679645\n0.9490486\n0.1769820\ncoefficient\n\n\nAge\n-0.0144089\n0.0119819\n-1.2025550\ncoefficient\n\n\nGenderFemale:Age\n-0.0060620\n0.0155623\n-0.3895341\ncoefficient\n\n\nNot at all|A small amount of the time\n-1.3302443\n0.7463162\n-1.7824138\nscale\n\n\nA small amount of the time|A moderate amount of the time\n-0.3709033\n0.7399300\n-0.5012682\nscale\n\n\nA moderate amount of the time|Most of the time\n0.5625857\n0.7493298\n0.7507852\nscale\n\n\nMost of the time|All of the time\n2.4629239\n0.8454431\n2.9131751\nscale\n\n\n\n\n\nWe can compare this against the model using just age.\n\nmodel_int &lt;- clm(Fictional_story ~ Gender*Age, data = data1)\nmodel_no_int &lt;- clm(Fictional_story ~ Age, data = data1)\n\nanova(model_int, model_no_int) %&gt;% kable()\n\n\n\n\n\nno.par\nAIC\nlogLik\nLR.stat\ndf\nPr(&gt;Chisq)\n\n\n\n\nmodel_no_int\n5\n428.1667\n-209.0834\nNA\nNA\nNA\n\n\nmodel_int\n7\n431.6481\n-208.8240\n0.5186507\n2\n0.771572\n\n\n\n\n\nThe p value is still significantly above 0.05, so adding gender as an interaction variable doesn’t significantly improve the model.\nThe question is, how can we select models with optimum demographic inputs? This is what will be covered in the ‘Model Selection’ portion of this blog."
  },
  {
    "objectID": "posts/Modelling_3/Modelling_3.html",
    "href": "posts/Modelling_3/Modelling_3.html",
    "title": "Ordinal regression: final models",
    "section": "",
    "text": "In the previous post, the step() function output the following models:\n\nFictional story: polr(formula = Fictional_story ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nAbstract shapes: polr(formula = Abstract_shapes ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nSensory sensations: polr(formula = Sensory_sensations ~ 1, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nLife experiences: polr(formula = Life_experiences ~ Age + Gender, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nMedia: polr(formula = Media ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nMusic: polr(formula = Music ~ Music_listening + Practice, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nFuture plans: polr(formula = Future_plans ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nBuilding: polr(formula = Building ~ Age + Gender + Music_listening + Floor, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\nEveryday: polr(formula = Everyday ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = “probit”)\n\nLet’s run these models now, plot them, and have a closer look at the results.\n\nlibrary(tidyverse)\nlibrary(broom)\nlibrary(performance)\nlibrary(ordinal)\nlibrary(car)\nlibrary(ggeffects)\nlibrary(gofcat) \nlibrary(brms)\nlibrary(emmeans)\nlibrary(knitr)\nlibrary(MASS)\nlibrary(patchwork)\nlibrary(grid)\nlibrary(gridExtra)\n\n\ndata1 &lt;- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data.csv\")\n\ndata2 &lt;- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data2.csv\")\n\nFirst some data tidying and treatment of N/As (as in last post).\n\noutcome_vars &lt;- c(\"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \n                  \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \n                  \"Building\", \"Everyday\")\n\n# Converting outcome variables to factors with consistent levels for each thought type\ndata1[outcome_vars] &lt;- lapply(data1[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\ndata2[outcome_vars] &lt;- lapply(data2[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\n#Remaking the floor variable\ndata1 &lt;- data1 %&gt;%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %&gt;% relocate(Floor, .after = Location)\n\ndata2 &lt;- data2 %&gt;%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %&gt;% relocate(Floor, .after = Location)\n\n#Making sure demographic variables are classed in the right way.\ndata1$Age &lt;- as.numeric(data1$Age)\ndata2$Age &lt;- as.numeric(data2$Age)\ndata1$Practice &lt;- as.numeric(as.character(data1$Practice))\ndata2$Practice &lt;- as.numeric(as.character(data2$Practice))\ndata1$Gender &lt;- factor(data1$Gender,  levels = c('Male', 'Female', 'Other'))\ndata2$Gender &lt;- factor(data2$Gender,  levels = c('Male', 'Female', 'Other'))\ndata1$Music_listening &lt;- factor(data1$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata2$Music_listening &lt;- factor(data2$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata1$Floor &lt;- factor(data1$Floor, levels = c('Downstairs', 'Upstairs'))\ndata2$Floor &lt;- factor(data2$Floor, levels = c('Downstairs', 'Upstairs'))\n\n\nlibrary(mice)\nimputed_data1 &lt;- mice(data1, m = 5, method = 'pmm', seed = 123, print = FALSE)\ncompleted_data1 &lt;- complete(imputed_data1, 1)\n\nRunning the models:\n\nsenses &lt;- polr(formula = Sensory_sensations ~ 1, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\n\nmusic &lt;- polr(formula = Music ~ Music_listening + Practice, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\n\nbuilding &lt;- polr(formula = Building ~ Age + Gender + Music_listening + Floor, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nlife &lt;- polr(formula = Life_experiences ~ Age + Gender, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nMany of the models select age as the strongest predictor. Let’s plot them using a loop.\n\noutcome_age &lt;- c(\"Fictional_story\", \"Abstract_shapes\",\n                  \"Media\", \"Future_plans\", \n                   \"Everyday\")\n\nplot_list &lt;- list()\nfor (outcome in outcome_age) {\nmodel &lt;- polr(as.formula(paste(outcome, \"~ Age\")), data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\npredicted_probs &lt;- ggemmeans(model, terms = c(\"Age\"))\n  \nplot &lt;- ggplot(predicted_probs, aes(x = x, y = predicted, fill = response.level)) +\n    geom_area() + \n    labs(x = \"\\nAge (years)\", y = \"Predicted Probability\\n\", \n         title = paste(outcome, \"by Age\")) +\n    scale_fill_manual(\n      name = NULL,\n      values = setNames(c(\"#deebf7\", \"#9ecae1\", \"#3182bd\", \"#08519c\", \"#08306b\"), \n                      levels(completed_data1[[outcome]])),\n      labels = c(\"Not at all\", \"A small amount of the time\", \"A moderate amount of the time\", \n                 \"Most of the time\", \"All of the time\"),\n      breaks = c(\"Not at all\", \"A small amount of the time\", \"A moderate amount of the time\", \n                 \"Most of the time\", \"All of the time\")\n    ) + \n    theme_minimal()\n  \n\n  plot_list[[outcome]] &lt;- plot\n}\n\ntitle_grob &lt;- textGrob(\"Types of Thoughts by Age, First Half\", gp = gpar(fontsize = 16, fontface = \"bold\"))\n\nAge_thoughts_models &lt;- grid.arrange(\n  grobs = plot_list, \n  ncol = 3, \n  top = title_grob  \n)\n\n\n\n\n\n\n\n\nLet’s now tackle the plots with multiple predictors.\n\nresponse_levels &lt;- c(\"Not at all\", \"A small amount of the time\", \"A moderate amount of the time\",\n                     \"Most of the time\", \"All of the time\")\n\nfill_colors &lt;- c(\"#deebf7\", \"#9ecae1\", \"#3182bd\", \"#08519c\", \"#08306b\")\nnames(fill_colors) &lt;- response_levels\n\nmusic &lt;- polr(formula = Music ~ Music_listening + Practice, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\npred_music &lt;- ggemmeans(music, terms = c(\"Practice\", \"Music_listening\"))\n\nggplot(pred_music, aes(x = x, y = predicted, fill = response.level)) +\n     geom_area(alpha = 1) +\n     facet_wrap(~ group, scales = \"free_y\") +\n     labs(x = \"\\nPractice (years)\", y = \"Predicted Probability\\n\", title = \"Music by Practice, Faceted by Classical Music listening\") +\n     scale_fill_manual(name = NULL, values = fill_colors) +\n     theme_minimal() +\n     theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\n\nlife &lt;- polr(formula = Life_experiences ~ Age + Gender, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\npred_life &lt;- ggemmeans(life, terms = c(\"Age\", \"Gender\"))\n\nggplot(pred_life, aes(x = x, y = predicted, fill = response.level)) +\n     geom_area(alpha = 1) +\n     facet_wrap(~ group, scales = \"free_y\") +  # Facet by Practice\n     labs(x = \"\\nAge (years)\", y = \"Predicted Probability\\n\", title = \"Life Experiences by Age, Faceted by Gender\") +\n     scale_fill_manual(name = NULL, values = fill_colors) +\n     theme_minimal() +\n     theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\nThis plot shows probability of thinking about the building or space by age, faceted by floor and holding Gender + Music listening constant.\n\nbuilding &lt;- polr(formula = Building ~ Age + Gender + Music_listening + Floor, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\npred_building &lt;- ggemmeans(building, terms = c(\"Age\", \"Floor\"))\n\nggplot(pred_building, aes(x = x, y = predicted, fill = response.level)) +\n     geom_area(alpha = 1) +\n     facet_wrap(~ group, scales = \"free_y\") +\n     labs(x = \"\\nAge (years)\", y = \"Predicted Probability\\n\", title = \"Building by Age, Faceted by Floor\") +\n     scale_fill_manual(name = NULL, values = fill_colors) +\n     theme_minimal() +\n     theme(legend.position = \"bottom\")\n\n\n\n\n\n\n\n\nLet’s do a little brant test:\n\nlibrary(MASS)\nlibrary(brant)\n\nmodels &lt;- list(\n  fiction = polr(Fictional_story ~ Age, data = completed_data1, method = \"logistic\", Hess = TRUE),\n  abstract = polr(Abstract_shapes ~ Age, data = completed_data1, method = \"logistic\", Hess = TRUE),\nsense = polr(formula = Sensory_sensations ~ 1, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\nlife = polr(formula = Life_experiences ~ Age + Gender, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\nmedia = polr(formula = Media ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\nmusic = polr(formula = Music ~ Music_listening + Practice, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\nfuture = polr(formula = Future_plans ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\nbuilding = polr(formula = Building ~ Age + Gender + Music_listening + Floor, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\neveryday = polr(formula = Everyday ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n)\n\nlapply(models, function(model) {\n  tryCatch({\n    brant.test(model)\n  }, error = function(e) {\n    message(\"Error in model: \", conditionMessage(e))\n    return(NULL)\n  })\n})\n\n$fiction\n\nBrant Test:\n           chi-sq   df   pr(&gt;chi)  \nOmnibus      6.66    3      0.083 .\nAge          6.66    3      0.083 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nH0: Proportional odds assumption holds\n\n\n$abstract\n\nBrant Test:\n           chi-sq   df   pr(&gt;chi)\nOmnibus      2.16    3       0.54\nAge          2.16    3       0.54\n\nH0: Proportional odds assumption holds\n\n\n$sense\nNULL\n\n$life\n\nBrant Test:\n                chi-sq   df   pr(&gt;chi)\nOmnibus          5.620    9       0.78\nAge              0.628    3       0.89\nGenderFemale     4.736    3       0.19\nGenderOther      0.000    3       1.00\n\nH0: Proportional odds assumption holds\n\n\n$media\n\nBrant Test:\n           chi-sq   df   pr(&gt;chi)\nOmnibus      3.12    2       0.21\nAge          3.12    2       0.21\n\nH0: Proportional odds assumption holds\n\n\n$music\n\nBrant Test:\n                                        chi-sq   df   pr(&gt;chi)\nOmnibus                                  10.45   15       0.79\nMusic_listeningSomewhat rarely            0.00    3       1.00\nMusic_listeningModerately frequently      0.00    3       1.00\nMusic_listeningFrequently                 0.00    3       1.00\nMusic_listeningVery frequently            0.00    3       1.00\nPractice                                  1.49    3       0.69\n\nH0: Proportional odds assumption holds\n\n\n$future\n\nBrant Test:\n           chi-sq   df   pr(&gt;chi)\nOmnibus      0.68    3       0.88\nAge          0.68    3       0.88\n\nH0: Proportional odds assumption holds\n\n\n$building\n\nBrant Test:\n                                        chi-sq   df   pr(&gt;chi)\nOmnibus                                 13.502   24       0.96\nAge                                      4.631    3       0.20\nGenderFemale                             0.957    3       0.81\nGenderOther                              0.000    3       1.00\nMusic_listeningSomewhat rarely           0.000    3       1.00\nMusic_listeningModerately frequently     0.000    3       1.00\nMusic_listeningFrequently                0.000    3       1.00\nMusic_listeningVery frequently           0.000    3       1.00\nFloorUpstairs                            2.299    3       0.51\n\nH0: Proportional odds assumption holds\n\n\n$everyday\n\nBrant Test:\n           chi-sq   df   pr(&gt;chi)\nOmnibus      4.66    3        0.2\nAge          4.66    3        0.2\n\nH0: Proportional odds assumption holds\n\n\nAnd a summary of the latent coefficients with p values:\n\n# Load the necessary library\nlibrary(tibble)\nlibrary(dplyr)\n\n# Initialize an empty list to store the results\nall_results &lt;- tibble()\n\n# Loop through each model in the list\nfor (model_name in names(models)) {\n  cat(\"\\nProcessing\", model_name, \"model:\\n\")\n  model &lt;- models[[model_name]]\n  \n  # Get the summary\n  model_summary &lt;- summary(model)\n  \n  # Extract coefficients table\n  coef_table &lt;- model_summary$coefficients\n  \n  # Calculate t-values and p-values\n  t_values &lt;- coef_table[, \"Value\"] / coef_table[, \"Std. Error\"]\n  p_values &lt;- 2 * (1 - pnorm(abs(t_values)))\n  \n  # Create a tibble for the current model's results\n  model_results &lt;- tibble(\n    Model = model_name,  # Name of the model\n    Term = rownames(coef_table),  # Term names (e.g., intercept, Age)\n    Estimate = coef_table[, \"Value\"],\n    `Std. Error` = coef_table[, \"Std. Error\"],\n    `t value` = t_values,\n    `p value` = p_values\n  )\n  \n  # Bind the current model's results to the all_results tibble\n  all_results &lt;- bind_rows(all_results, model_results)\n}\n\n\nProcessing fiction model:\n\nProcessing abstract model:\n\nProcessing sense model:\n\nProcessing life model:\n\nProcessing media model:\n\nProcessing music model:\n\nProcessing future model:\n\nProcessing building model:\n\nProcessing everyday model:\n\n# Print the combined data frame with results for all models\nprint(all_results)\n\n# A tibble: 57 × 6\n   Model    Term                       Estimate `Std. Error` `t value` `p value`\n   &lt;chr&gt;    &lt;chr&gt;                         &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;\n 1 fiction  Age                         -0.0181      0.00701     -2.58 0.00978  \n 2 fiction  Not at all|A small amount…  -1.46        0.434       -3.37 0.000756 \n 3 fiction  A small amount of the tim…  -0.483       0.418       -1.16 0.248    \n 4 fiction  A moderate amount of the …   0.462       0.427        1.08 0.279    \n 5 fiction  Most of the time|All of t…   2.50        0.588        4.25 0.0000211\n 6 abstract Age                         -0.0131      0.00737     -1.77 0.0766   \n 7 abstract Not at all|A small amount…  -0.521       0.446       -1.17 0.243    \n 8 abstract A small amount of the tim…   0.579       0.446        1.30 0.194    \n 9 abstract A moderate amount of the …   1.94        0.506        3.84 0.000124 \n10 abstract Most of the time|All of t…   4.40        1.08         4.08 0.0000456\n# ℹ 47 more rows"
  }
]