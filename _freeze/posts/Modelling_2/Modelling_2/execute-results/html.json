{
  "hash": "bc5915ea50cfe2b2a29e3444afb9d63b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Ordinal regression: model selection\"\nformat: html\nauthor: \"Hannah Wilkie\"\nexecute:\n  warning: false\nimage: \"Audience.jpg\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(MASS)\nlibrary(dplyr)\nlibrary(corrplot)\nlibrary(car)\nlibrary(knitr)\n```\n:::\n\n\n\nIn this section, we'll experiment with the step() function in R to help select ordinal regression models for our data.\n\nstep() is not compatible with clm(), which is why we'll use polr().\n\nThe step() function starts with a full model containing all the possible main effects (in this case all the possible demographic variables). It tests different combinations of variables and then keeps the model with the lowest AIC.\n\nThis is helpful when we're dealing with lots of different outcome variables and lots of demographic inputs and we need to figure out which ones to use.\n\nHere's how we'd run the step() function starting with all the demographic variables and using just fictional story as our outcome.\n\nFirst some data loading, and demographic variable tidying.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 <- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data.csv\")\n\ndata2 <- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data2.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\noutcome_vars <- c(\"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \n                  \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \n                  \"Building\", \"Everyday\")\n\n# Converting outcome variables to factors with consistent levels for each thought type\ndata1[outcome_vars] <- lapply(data1[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\ndata2[outcome_vars] <- lapply(data2[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\n#Remaking the floor variable\ndata1 <- data1 %>%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %>% relocate(Floor, .after = Location)\n\ndata2 <- data2 %>%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %>% relocate(Floor, .after = Location)\n\n#Making sure demographic variables are classed in the right way.\ndata1$Age <- as.numeric(data1$Age)\ndata2$Age <- as.numeric(data2$Age)\ndata1$Practice <- as.numeric(as.character(data1$Practice))\ndata2$Practice <- as.numeric(as.character(data2$Practice))\ndata1$Gender <- factor(data1$Gender,  levels = c('Male', 'Female', 'Other'))\ndata2$Gender <- factor(data2$Gender,  levels = c('Male', 'Female', 'Other'))\ndata1$Music_listening <- factor(data1$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata2$Music_listening <- factor(data2$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata1$Floor <- factor(data1$Floor, levels = c('Downstairs', 'Upstairs'))\ndata2$Floor <- factor(data2$Floor, levels = c('Downstairs', 'Upstairs'))\n```\n:::\n\n\n\nWe have some NAs in our dataframe, so before running the models, we need to figure out what to do with these.\n\nLet's get a map of our missing data:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(Amelia)\ndemographics_outcomes <- c('Age', 'Gender', 'Music_listening', 'Practice', 'Floor', \"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \n                  \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \n                  \"Building\", \"Everyday\")\n\ndem_out <- dplyr::select(data1, all_of(demographics_outcomes))\nmissmap(dem_out)\n```\n\n::: {.cell-output-display}\n![](Modelling_2_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\nWe can hypothesise that the data is MCAR (missing completely at random), i.e. that missing values aren't correlated with any particular variables. Let's test this.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(naniar)\nmcar_test(dem_out)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 Ã— 4\n  statistic    df p.value missing.patterns\n      <dbl> <dbl>   <dbl>            <int>\n1      250.   237   0.265               23\n```\n\n\n:::\n:::\n\n\n\np \\> 0.05, so there is insufficient evidence to reject the null hypothesis that the data is MCAR.\n\nBased on this, we can use multiple imputation to deal with the NAs. This has the advantage of preserving the data structure and reflecting uncertainty without data loss.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mice)\nimputed_data1 <- mice(data1, m = 5, method = 'pmm', seed = 123, print = FALSE)\ncompleted_data1 <- complete(imputed_data1, 1)\n```\n:::\n\n\n\nLet's now run the step() function with our imputed data for fictional story.\n\n1.  Start by specifying the model with with maximum number of demographic inputs.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_fiction_imp <- polr(Fictional_story ~ Age + Gender + Music_listening + Practice + Floor, \n              data = completed_data1, Hess = TRUE, method = \"logistic\")\n\nstepwise_model_imp <- step(model_fiction_imp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStart:  AIC=488.79\nFictional_story ~ Age + Gender + Music_listening + Practice + \n    Floor\n\n                  Df    AIC\n- Gender           2 485.38\n- Practice         1 486.85\n- Music_listening  4 486.89\n- Floor            1 487.06\n<none>               488.79\n- Age              1 494.12\n\nStep:  AIC=485.38\nFictional_story ~ Age + Music_listening + Practice + Floor\n\n                  Df    AIC\n- Practice         1 483.40\n- Floor            1 483.83\n- Music_listening  4 484.40\n<none>               485.38\n- Age              1 491.61\n\nStep:  AIC=483.4\nFictional_story ~ Age + Music_listening + Floor\n\n                  Df    AIC\n- Floor            1 481.89\n- Music_listening  4 482.80\n<none>               483.40\n- Age              1 489.82\n\nStep:  AIC=481.89\nFictional_story ~ Age + Music_listening\n\n                  Df    AIC\n- Music_listening  4 481.00\n<none>               481.89\n- Age              1 487.90\n\nStep:  AIC=481\nFictional_story ~ Age\n\n       Df    AIC\n<none>    481.00\n- Age   1 485.74\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(stepwise_model_imp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\npolr(formula = Fictional_story ~ Age, data = completed_data1, \n    Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.01812   0.007012  -2.584\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.4612  0.4338   \nA small amount of the time|A moderate amount of the time -0.4828  0.4176   \nA moderate amount of the time|Most of the time            0.4619  0.4269   \nMost of the time|All of the time                          2.5021  0.5883   \n                                                         t value\nNot at all|A small amount of the time                    -3.3686\nA small amount of the time|A moderate amount of the time -1.1563\nA moderate amount of the time|Most of the time            1.0821\nMost of the time|All of the time                          4.2530\n\nResidual Deviance: 471.0048 \nAIC: 481.0048 \n```\n\n\n:::\n:::\n\n\n\nHere step() ran through all the possible demographics to find the model with the lowest AIC. In this case the most successful model was one with just age as a demographic input.\n\nWe can run the step() function looping through all the possible outcome variables using the imputed data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# List to store results\nmodels <- list()\nstepwise_models <- list()\n\n# Loop through selected outcomes\nfor (outcome in outcome_vars) {\n  formula <- as.formula(paste(outcome, \"~ Age + Gender + Music_listening + Practice + Floor\"))\n\n  tryCatch({\n    # Fit proportional odds model\n    model <- polr(formula, data = completed_data1, Hess = TRUE, method = \"logistic\", \n                  control = list(maxit = 1000), na.action = na.exclude)\n    \n    # Store model\n    models[[outcome]] <- model\n    \n    # Print summary\n    cat(\"\\nSummary for\", outcome, \":\\n\")\n    print(summary(model))\n    \n    # Perform stepwise regression\n    step_model <- step(model, direction = \"backward\", trace = FALSE)\n    stepwise_models[[outcome]] <- step_model\n    \n    # Print stepwise summary\n    cat(\"\\nStepwise Model Summary for\", outcome, \":\\n\")\n    print(summary(step_model))\n    \n  }, error = function(e) {\n    cat(\"\\nSkipping\", outcome, \"due to error:\", conditionMessage(e), \"\\n\")\n  })\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nSummary for Fictional_story :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                         Value Std. Error t value\nAge                                  -0.020064   0.007472 -2.6854\nGenderFemale                         -0.184649   0.289509 -0.6378\nGenderOther                           0.682474   1.815033  0.3760\nMusic_listeningSomewhat rarely        0.583267   1.320177  0.4418\nMusic_listeningModerately frequently  0.182789   1.182258  0.1546\nMusic_listeningFrequently            -0.601948   1.155526 -0.5209\nMusic_listeningVery frequently       -0.430974   1.155553 -0.3730\nPractice                             -0.001622   0.006711 -0.2417\nFloorUpstairs                        -0.164728   0.316061 -0.5212\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.1013  1.2172   \nA small amount of the time|A moderate amount of the time -1.0931  1.2048   \nA moderate amount of the time|Most of the time           -0.1208  1.2087   \nMost of the time|All of the time                          1.9778  1.2823   \n                                                         t value\nNot at all|A small amount of the time                    -1.7263\nA small amount of the time|A moderate amount of the time -0.9073\nA moderate amount of the time|Most of the time           -0.1000\nMost of the time|All of the time                          1.5424\n\nResidual Deviance: 462.7904 \nAIC: 488.7904 \n\nStepwise Model Summary for Fictional_story :\nCall:\npolr(formula = Fictional_story ~ Age, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"logistic\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.01812   0.007012  -2.584\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.4612  0.4338   \nA small amount of the time|A moderate amount of the time -0.4828  0.4176   \nA moderate amount of the time|Most of the time            0.4619  0.4269   \nMost of the time|All of the time                          2.5021  0.5883   \n                                                         t value\nNot at all|A small amount of the time                    -3.3686\nA small amount of the time|A moderate amount of the time -1.1563\nA moderate amount of the time|Most of the time            1.0821\nMost of the time|All of the time                          4.2530\n\nResidual Deviance: 471.0048 \nAIC: 481.0048 \n\nSummary for Abstract_shapes :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                         Value Std. Error  t value\nAge                                  -0.013730   0.007830 -1.75340\nGenderFemale                          0.237260   0.305566  0.77646\nGenderOther                           0.500606   1.670889  0.29960\nMusic_listeningSomewhat rarely       -0.401635   1.475343 -0.27223\nMusic_listeningModerately frequently -0.183899   1.375480 -0.13370\nMusic_listeningFrequently            -0.223421   1.350183 -0.16547\nMusic_listeningVery frequently       -0.067906   1.345595 -0.05047\nPractice                              0.005251   0.006897  0.76139\nFloorUpstairs                        -0.190754   0.327727 -0.58205\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.6245  1.3874   \nA small amount of the time|A moderate amount of the time  0.4881  1.3843   \nA moderate amount of the time|Most of the time            1.8611  1.3998   \nMost of the time|All of the time                          4.3210  1.6951   \n                                                         t value\nNot at all|A small amount of the time                    -0.4501\nA small amount of the time|A moderate amount of the time  0.3526\nA moderate amount of the time|Most of the time            1.3296\nMost of the time|All of the time                          2.5492\n\nResidual Deviance: 381.9298 \nAIC: 407.9298 \n\nStepwise Model Summary for Abstract_shapes :\nCall:\npolr(formula = Abstract_shapes ~ Age, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"logistic\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.01305    0.00737  -1.771\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.5212  0.4459   \nA small amount of the time|A moderate amount of the time  0.5788  0.4459   \nA moderate amount of the time|Most of the time            1.9430  0.5062   \nMost of the time|All of the time                          4.4013  1.0795   \n                                                         t value\nNot at all|A small amount of the time                    -1.1687\nA small amount of the time|A moderate amount of the time  1.2980\nA moderate amount of the time|Most of the time            3.8384\nMost of the time|All of the time                          4.0773\n\nResidual Deviance: 383.8834 \nAIC: 393.8834 \n\nSummary for Sensory_sensations :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                          Value Std. Error   t value\nAge                                   0.0001992   0.008458  0.023554\nGenderFemale                          0.1648059   0.331730  0.496807\nGenderOther                           1.5234446   1.739314  0.875888\nMusic_listeningSomewhat rarely       13.2322740   0.591145 22.384154\nMusic_listeningModerately frequently 13.1572183   0.358521 36.698599\nMusic_listeningFrequently            13.4798311   0.295118 45.675998\nMusic_listeningVery frequently       13.3047288   0.288087 46.182956\nPractice                             -0.0037578   0.007612 -0.493665\nFloorUpstairs                         0.0009349   0.357546  0.002615\n\nIntercepts:\n                                                         Value    Std. Error\nNot at all|A small amount of the time                     14.0608   0.5241  \nA small amount of the time|A moderate amount of the time  15.3822   0.5544  \nA moderate amount of the time|Most of the time            16.6777   0.6543  \nMost of the time|All of the time                          93.0447   0.6543  \n                                                         t value \nNot at all|A small amount of the time                     26.8284\nA small amount of the time|A moderate amount of the time  27.7461\nA moderate amount of the time|Most of the time            25.4902\nMost of the time|All of the time                         142.2094\n\nResidual Deviance: 308.8061 \nAIC: 334.8061 \n\nStepwise Model Summary for Sensory_sensations :\nCall:\npolr(formula = Sensory_sensations ~ 1, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"logistic\")\n\nNo coefficients\n\nIntercepts:\n                                                         Value    Std. Error\nNot at all|A small amount of the time                      0.7020   0.1634  \nA small amount of the time|A moderate amount of the time   2.0082   0.2381  \nA moderate amount of the time|Most of the time             3.3019   0.4157  \nMost of the time|All of the time                          15.0784 151.2038  \n                                                         t value \nNot at all|A small amount of the time                      4.2959\nA small amount of the time|A moderate amount of the time   8.4329\nA moderate amount of the time|Most of the time             7.9433\nMost of the time|All of the time                           0.0997\n\nResidual Deviance: 312.1081 \nAIC: 320.1081 \n\nSummary for Life_experiences :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                          Value Std. Error  t value\nAge                                  -0.0304006   0.007787 -3.90393\nGenderFemale                          0.5929295   0.290624  2.04019\nGenderOther                           0.2018541   1.707436  0.11822\nMusic_listeningSomewhat rarely       -1.5339005   1.487048 -1.03151\nMusic_listeningModerately frequently -0.9692451   1.393042 -0.69578\nMusic_listeningFrequently            -1.4862291   1.372219 -1.08308\nMusic_listeningVery frequently       -1.2177971   1.368478 -0.88989\nPractice                             -0.0003402   0.006825 -0.04984\nFloorUpstairs                         0.1495517   0.313627  0.47685\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -3.9081  1.4339   \nA small amount of the time|A moderate amount of the time -2.6223  1.4210   \nA moderate amount of the time|Most of the time           -1.0215  1.4047   \nMost of the time|All of the time                          1.3766  1.4702   \n                                                         t value\nNot at all|A small amount of the time                    -2.7256\nA small amount of the time|A moderate amount of the time -1.8454\nA moderate amount of the time|Most of the time           -0.7272\nMost of the time|All of the time                          0.9363\n\nResidual Deviance: 463.1297 \nAIC: 489.1297 \n\nStepwise Model Summary for Life_experiences :\nCall:\npolr(formula = Life_experiences ~ Age + Gender, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"logistic\")\n\nCoefficients:\n                Value Std. Error t value\nAge          -0.03024   0.007502  -4.030\nGenderFemale  0.61570   0.285973   2.153\nGenderOther  -0.17772   1.572352  -0.113\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.7295  0.5186   \nA small amount of the time|A moderate amount of the time -1.4508  0.4939   \nA moderate amount of the time|Most of the time            0.1332  0.4809   \nMost of the time|All of the time                          2.5074  0.6564   \n                                                         t value\nNot at all|A small amount of the time                    -5.2632\nA small amount of the time|A moderate amount of the time -2.9371\nA moderate amount of the time|Most of the time            0.2770\nMost of the time|All of the time                          3.8197\n\nResidual Deviance: 466.1446 \nAIC: 480.1446 \n\nSummary for Media :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                         Value Std. Error   t value\nAge                                  -0.020246   0.008302 -2.438803\nGenderFemale                         -0.193004   0.324828 -0.594175\nGenderOther                           0.416913   1.729191  0.241103\nMusic_listeningSomewhat rarely        1.103021   1.445189  0.763237\nMusic_listeningModerately frequently -0.210773   1.361649 -0.154792\nMusic_listeningFrequently            -0.229691   1.327884 -0.172976\nMusic_listeningVery frequently       -0.011940   1.317232 -0.009064\nPractice                             -0.002701   0.007657 -0.352757\nFloorUpstairs                         0.212293   0.376081  0.564488\n\nIntercepts:\n                                                         Value    Std. Error\nNot at all|A small amount of the time                     -0.6048   1.3980  \nA small amount of the time|A moderate amount of the time   0.3566   1.3988  \nA moderate amount of the time|Most of the time             1.9812   1.4332  \nMost of the time|All of the time                         268.1394   1.4332  \n                                                         t value \nNot at all|A small amount of the time                     -0.4326\nA small amount of the time|A moderate amount of the time   0.2549\nA moderate amount of the time|Most of the time             1.3823\nMost of the time|All of the time                         187.0921\n\nResidual Deviance: 327.3299 \nAIC: 353.3299 \n\nStepwise Model Summary for Media :\nCall:\npolr(formula = Media ~ Age, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.02224   0.007854  -2.832\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.6811  0.4617   \nA small amount of the time|A moderate amount of the time  0.2449  0.4587   \nA moderate amount of the time|Most of the time            1.8131  0.5417   \nMost of the time|All of the time                          9.7208 19.2935   \n                                                         t value\nNot at all|A small amount of the time                    -1.4753\nA small amount of the time|A moderate amount of the time  0.5339\nA moderate amount of the time|Most of the time            3.3471\nMost of the time|All of the time                          0.5038\n\nResidual Deviance: 333.4143 \nAIC: 343.4143 \n\nSummary for Music :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                         Value Std. Error  t value\nAge                                  -0.005387   0.007741 -0.69591\nGenderFemale                          0.342148   0.294890  1.16026\nGenderOther                           0.172715   1.798501  0.09603\nMusic_listeningSomewhat rarely        2.917091   1.358508  2.14728\nMusic_listeningModerately frequently  2.184330   1.243854  1.75610\nMusic_listeningFrequently             2.433851   1.222099  1.99153\nMusic_listeningVery frequently        3.435359   1.230974  2.79076\nPractice                              0.018228   0.006886  2.64728\nFloorUpstairs                        -0.171472   0.318814 -0.53784\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.6953  1.2888   \nA small amount of the time|A moderate amount of the time  0.6585  1.2562   \nA moderate amount of the time|Most of the time            2.1175  1.2730   \nMost of the time|All of the time                          4.2542  1.2971   \n                                                         t value\nNot at all|A small amount of the time                    -0.5395\nA small amount of the time|A moderate amount of the time  0.5242\nA moderate amount of the time|Most of the time            1.6634\nMost of the time|All of the time                          3.2798\n\nResidual Deviance: 431.4689 \nAIC: 457.4689 \n\nStepwise Model Summary for Music :\nCall:\npolr(formula = Music ~ Music_listening + Practice, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"logistic\")\n\nCoefficients:\n                                       Value Std. Error t value\nMusic_listeningSomewhat rarely       2.79040   1.375870   2.028\nMusic_listeningModerately frequently 2.01818   1.283926   1.572\nMusic_listeningFrequently            2.29860   1.273278   1.805\nMusic_listeningVery frequently       3.30313   1.276230   2.588\nPractice                             0.01665   0.006695   2.487\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.6054  1.2909   \nA small amount of the time|A moderate amount of the time  0.7306  1.2571   \nA moderate amount of the time|Most of the time            2.1838  1.2732   \nMost of the time|All of the time                          4.3102  1.2978   \n                                                         t value\nNot at all|A small amount of the time                    -0.4690\nA small amount of the time|A moderate amount of the time  0.5812\nA moderate amount of the time|Most of the time            1.7152\nMost of the time|All of the time                          3.3211\n\nResidual Deviance: 433.5155 \nAIC: 451.5155 \n\nSummary for Future_plans :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                          Value Std. Error  t value\nAge                                  -0.0517714   0.008569 -6.04139\nGenderFemale                         -0.1757382   0.295222 -0.59528\nGenderOther                          -1.7209682   1.704173 -1.00986\nMusic_listeningSomewhat rarely        0.1894178   1.303459  0.14532\nMusic_listeningModerately frequently -0.2711655   1.197084 -0.22652\nMusic_listeningFrequently            -0.9689112   1.178356 -0.82226\nMusic_listeningVery frequently       -0.7089336   1.176264 -0.60270\nPractice                             -0.0002543   0.007241 -0.03512\nFloorUpstairs                        -0.1261378   0.323305 -0.39015\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -4.3831  1.2727   \nA small amount of the time|A moderate amount of the time -3.1203  1.2486   \nA moderate amount of the time|Most of the time           -1.6050  1.2286   \nMost of the time|All of the time                          0.2254  1.2871   \n                                                         t value\nNot at all|A small amount of the time                    -3.4438\nA small amount of the time|A moderate amount of the time -2.4990\nA moderate amount of the time|Most of the time           -1.3064\nMost of the time|All of the time                          0.1751\n\nResidual Deviance: 425.4461 \nAIC: 451.4461 \n\nStepwise Model Summary for Future_plans :\nCall:\npolr(formula = Future_plans ~ Age, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.04841   0.008102  -5.975\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -3.3726  0.5212   \nA small amount of the time|A moderate amount of the time -2.1392  0.4825   \nA moderate amount of the time|Most of the time           -0.6560  0.4571   \nMost of the time|All of the time                          1.1340  0.5808   \n                                                         t value\nNot at all|A small amount of the time                    -6.4705\nA small amount of the time|A moderate amount of the time -4.4338\nA moderate amount of the time|Most of the time           -1.4351\nMost of the time|All of the time                          1.9526\n\nResidual Deviance: 431.1522 \nAIC: 441.1522 \n\nSummary for Building :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                         Value Std. Error    t value\nAge                                  -0.024738  7.989e-03 -3.096e+00\nGenderFemale                         -0.625787  3.082e-01 -2.031e+00\nGenderOther                          -8.805429  6.902e-05 -1.276e+05\nMusic_listeningSomewhat rarely       12.036353  5.388e-01  2.234e+01\nMusic_listeningModerately frequently 12.607143  3.224e-01  3.910e+01\nMusic_listeningFrequently            12.971602  2.774e-01  4.675e+01\nMusic_listeningVery frequently       13.179227  2.759e-01  4.777e+01\nPractice                             -0.002493  6.962e-03 -3.581e-01\nFloorUpstairs                         0.650667  3.484e-01  1.868e+00\n\nIntercepts:\n                                                         Value       \nNot at all|A small amount of the time                         11.3396\nA small amount of the time|A moderate amount of the time      13.2252\nA moderate amount of the time|Most of the time                14.9084\nMost of the time|All of the time                              16.2193\n                                                         Std. Error  \nNot at all|A small amount of the time                          0.5042\nA small amount of the time|A moderate amount of the time       0.5043\nA moderate amount of the time|Most of the time                 0.5896\nMost of the time|All of the time                               0.8369\n                                                         t value     \nNot at all|A small amount of the time                         22.4880\nA small amount of the time|A moderate amount of the time      26.2223\nA moderate amount of the time|Most of the time                25.2843\nMost of the time|All of the time                              19.3791\n\nResidual Deviance: 359.5096 \nAIC: 385.5096 \n\nStepwise Model Summary for Building :\nCall:\npolr(formula = Building ~ Age + Gender + Floor, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"logistic\")\n\nCoefficients:\n                  Value Std. Error    t value\nAge            -0.02467  7.841e-03 -3.147e+00\nGenderFemale   -0.57858  2.998e-01 -1.930e+00\nGenderOther   -15.17738  1.448e-07 -1.048e+08\nFloorUpstairs   0.59173  3.327e-01  1.779e+00\n\nIntercepts:\n                                                         Value        \nNot at all|A small amount of the time                    -1.500500e+00\nA small amount of the time|A moderate amount of the time  3.271000e-01\nA moderate amount of the time|Most of the time            1.972800e+00\nMost of the time|All of the time                          3.272700e+00\n                                                         Std. Error   \nNot at all|A small amount of the time                     5.893000e-01\nA small amount of the time|A moderate amount of the time  5.767000e-01\nA moderate amount of the time|Most of the time            6.475000e-01\nMost of the time|All of the time                          8.783000e-01\n                                                         t value      \nNot at all|A small amount of the time                    -2.546400e+00\nA small amount of the time|A moderate amount of the time  5.673000e-01\nA moderate amount of the time|Most of the time            3.046600e+00\nMost of the time|All of the time                          3.726000e+00\n\nResidual Deviance: 367.5854 \nAIC: 383.5854 \n\nSummary for Everyday :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n                                        Value Std. Error  t value\nAge                                  -0.02801   0.008060 -3.47493\nGenderFemale                          0.12354   0.295178  0.41851\nGenderOther                           0.31282   1.766320  0.17710\nMusic_listeningSomewhat rarely       -1.36382   1.370967 -0.99478\nMusic_listeningModerately frequently  0.22782   1.231383  0.18501\nMusic_listeningFrequently            -0.29107   1.211772 -0.24020\nMusic_listeningVery frequently        0.08650   1.206193  0.07172\nPractice                             -0.01023   0.007069 -1.44743\nFloorUpstairs                        -0.02558   0.330031 -0.07751\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.5242  1.2736   \nA small amount of the time|A moderate amount of the time -0.6805  1.2596   \nA moderate amount of the time|Most of the time            0.8269  1.2766   \nMost of the time|All of the time                          2.1008  1.3399   \n                                                         t value\nNot at all|A small amount of the time                    -1.9820\nA small amount of the time|A moderate amount of the time -0.5402\nA moderate amount of the time|Most of the time            0.6477\nMost of the time|All of the time                          1.5679\n\nResidual Deviance: 415.8977 \nAIC: 441.8977 \n\nStepwise Model Summary for Everyday :\nCall:\npolr(formula = Everyday ~ Age, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"logistic\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.02455   0.007422  -3.307\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.1073  0.4742   \nA small amount of the time|A moderate amount of the time -0.3377  0.4466   \nA moderate amount of the time|Most of the time            1.1491  0.4855   \nMost of the time|All of the time                          2.4138  0.6321   \n                                                         t value\nNot at all|A small amount of the time                    -4.4437\nA small amount of the time|A moderate amount of the time -0.7563\nA moderate amount of the time|Most of the time            2.3665\nMost of the time|All of the time                          3.8188\n\nResidual Deviance: 424.6746 \nAIC: 434.6746 \n```\n\n\n:::\n:::\n\n\n\nFrom the above, we can see that the models with the lowest AIC (using just main effects) are as follows:\n\nFictional story: polr(formula = Fictional_story \\~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nAbstract shapes: polr(formula = Abstract_shapes \\~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nSensory sensations: polr(formula = Sensory_sensations \\~ 1, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nLife experiences: polr(formula = Life_experiences \\~ Age + Gender, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nMedia: polr(formula = Media \\~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nMusic: polr(formula = Music \\~ Music_listening + Practice, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nFuture plans: polr(formula = Future_plans \\~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nBuilding: polr(formula = Building \\~ Age + Gender + Music_listening + Floor, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nEveryday: polr(formula = Everyday \\~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nLet's also look at the interactions between the demographic variables and check for multicollinearity.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(conflicted)\nconflict_prefer(\"filter\", \"dplyr\")\n\ndemographics <- c('Age', 'Gender', 'Music_listening', 'Practice', 'Floor')\ndemographics_data <- dplyr::select(data1, all_of(demographics))\n\n# Convert categorical variables to numeric\ndemographics_numeric <- demographics_data %>%\n  mutate(\n    Gender = as.numeric(factor(Gender)),\n    Music_listening = as.numeric(factor(Music_listening, ordered = TRUE)),  \n    Floor = as.numeric(factor(Floor))\n  ) \n\n# Compute correlation matrix\ncor_matrix <- cor(demographics_numeric, use = \"pairwise.complete.obs\")\n\ncorrplot(cor_matrix, method = \"color\", type = \"lower\", \n         tl.col = \"black\", tl.srt = 45, addCoef.col = \"white\", \n         col = colorRampPalette(c(\"blue\", \"white\", \"red\"))(200))\n```\n\n::: {.cell-output-display}\n![](Modelling_2_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Checking for collinearity\nmodel1 <- lm(Age ~ Practice + Gender + Music_listening + Floor, data = demographics_numeric)\nmodel2 <- lm(Gender ~ Age + Practice + Music_listening + Floor, data = demographics_numeric)\nmodel3 <- lm(Practice ~ Age + Gender + Music_listening + Floor, data = demographics_numeric)\nmodel4 <- lm(Music_listening ~ Age + Gender + Practice + Floor, data = demographics_numeric)\nmodel5 <- lm(Floor ~ Age + Gender + Practice + Music_listening, data = demographics_numeric)\nvif(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Practice          Gender Music_listening           Floor \n       1.036377        1.002153        1.034110        1.003875 \n```\n\n\n:::\n\n```{.r .cell-code}\nvif(model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Age        Practice Music_listening           Floor \n       1.086216        1.067477        1.034662        1.059068 \n```\n\n\n:::\n\n```{.r .cell-code}\nvif(model3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Age          Gender Music_listening           Floor \n       1.064866        1.011938        1.004652        1.051720 \n```\n\n\n:::\n\n```{.r .cell-code}\nvif(model4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     Age   Gender Practice    Floor \n1.096117 1.011828 1.036402 1.058475 \n```\n\n\n:::\n\n```{.r .cell-code}\nvif(model5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Age          Gender        Practice Music_listening \n       1.039690        1.011967        1.060100        1.034224 \n```\n\n\n:::\n:::\n\n\n\nAll vif() outputs are close to 1, indicating that multicollinearity shouldn't be a problem.\n\nIn the post on 'Ordinal regression: final models', we'll use these step() results to run some final model visualisations.\n",
    "supporting": [
      "Modelling_2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}