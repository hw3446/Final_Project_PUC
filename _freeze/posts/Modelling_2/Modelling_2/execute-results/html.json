{
  "hash": "e075574f0aa8223a45a56bf81e25a850",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Ordinal regression: model Selection\"\nformat: html\nauthor: \"Hannah Wilkie\"\nexecute:\n  warning: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(MASS)\nlibrary(dplyr)\nlibrary(corrplot)\nlibrary(car)\n```\n:::\n\n\n\nIn this section, we'll experiment with the step() function in R to help select ordinal regression models for our data.\n\nstep() is not compatible with clm(), which is why we'll use polr().\n\nThe step() function starts with a full model containing all the possible main effects (in this case all the possible demographic variables). It tests different combinations of variables and then keeps the model with the lowest AIC.\n\nThis is helpful when we're dealing with lots of different outcome variables and lots of demographic inputs and we need to figure out which ones to use.\n\nHere's how we'd run the step() function starting with all the demographic variables and using just fictional story as our outcome.\n\nFirst some data loading, and demographic variable tidying.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 <- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data.csv\")\n\ndata2 <- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data2.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\noutcome_vars <- c(\"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \n                  \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \n                  \"Building\", \"Everyday\")\n\n# Converting outcome variables to factors with consistent levels for each thought type\ndata1[outcome_vars] <- lapply(data1[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\ndata2[outcome_vars] <- lapply(data2[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\n#Remaking the floor variable\ndata1 <- data1 %>%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %>% relocate(Floor, .after = Location)\n\ndata2 <- data2 %>%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %>% relocate(Floor, .after = Location)\n\n#Making sure demographic variables are classed in the right way.\ndata1$Age <- as.numeric(data1$Age)\ndata2$Age <- as.numeric(data2$Age)\ndata1$Practice <- as.numeric(as.character(data1$Practice))\ndata2$Practice <- as.numeric(as.character(data2$Practice))\ndata1$Gender <- factor(data1$Gender,  levels = c('Male', 'Female', 'Other'))\ndata2$Gender <- factor(data2$Gender,  levels = c('Male', 'Female', 'Other'))\ndata1$Music_listening <- factor(data1$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata2$Music_listening <- factor(data2$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata1$Floor <- factor(data1$Floor, levels = c('Downstairs', 'Upstairs'))\ndata2$Floor <- factor(data2$Floor, levels = c('Downstairs', 'Upstairs'))\n```\n:::\n\n\nWe have some NAs in our dataframe, so before running the models, we need to figure out what to do with these.\n\n\nLet's get a map of our missing data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(Amelia)\ndemographics_outcomes <- c('Age', 'Gender', 'Music_listening', 'Practice', 'Floor', \"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \n                  \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \n                  \"Building\", \"Everyday\")\n\ndem_out <- dplyr::select(data1, all_of(demographics_outcomes))\nmissmap(dem_out)\n```\n\n::: {.cell-output-display}\n![](Modelling_2_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\nWe can hypothesise that the data is MCAR (missing completely at random), i.e. that missing values aren't correlated with any particular variables. Let's test this.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(naniar)\nmcar_test(dem_out)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 Ã— 4\n  statistic    df p.value missing.patterns\n      <dbl> <dbl>   <dbl>            <int>\n1      250.   237   0.265               23\n```\n\n\n:::\n:::\n\n\n\np \\> 0.05, so there is insufficient evidence to reject the null hypothesis that the data is MCAR.\n\nBased on this, we can use imputation to deal with the NAs.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mice)\nimputed_data1 <- mice(data1, m = 5, method = 'pmm', seed = 123, print = FALSE)\ncompleted_data1 <- complete(imputed_data1, 1)\n```\n:::\n\n\n\n\n\nLet's now run the step() function with our imputed data for fictional story.\n\n1. Start by specifying the model with with maximum number of demographic inputs. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_fiction_imp <- polr(Fictional_story ~ Age + Gender + Music_listening + Practice + Floor, \n              data = completed_data1, Hess = TRUE, method = \"probit\")\n\nstepwise_model_imp <- step(model_fiction_imp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStart:  AIC=488.65\nFictional_story ~ Age + Gender + Music_listening + Practice + \n    Floor\n\n                  Df    AIC\n- Gender           2 485.33\n- Practice         1 486.68\n- Floor            1 486.78\n- Music_listening  4 487.64\n<none>               488.65\n- Age              1 493.74\n\nStep:  AIC=485.33\nFictional_story ~ Age + Music_listening + Practice + Floor\n\n                  Df    AIC\n- Practice         1 483.33\n- Floor            1 483.54\n- Music_listening  4 484.98\n<none>               485.33\n- Age              1 491.03\n\nStep:  AIC=483.33\nFictional_story ~ Age + Music_listening + Floor\n\n                  Df    AIC\n- Floor            1 481.56\n- Music_listening  4 483.20\n<none>               483.33\n- Age              1 489.20\n\nStep:  AIC=481.56\nFictional_story ~ Age + Music_listening\n\n                  Df    AIC\n- Music_listening  4 481.22\n<none>               481.56\n- Age              1 487.20\n\nStep:  AIC=481.22\nFictional_story ~ Age\n\n       Df    AIC\n<none>    481.22\n- Age   1 485.74\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(stepwise_model_imp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\npolr(formula = Fictional_story ~ Age, data = completed_data1, \n    Hess = TRUE, method = \"probit\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.01087   0.004265  -2.549\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.8932  0.2658   \nA small amount of the time|A moderate amount of the time -0.2880  0.2593   \nA moderate amount of the time|Most of the time            0.2708  0.2634   \nMost of the time|All of the time                          1.2830  0.3059   \n                                                         t value\nNot at all|A small amount of the time                    -3.3605\nA small amount of the time|A moderate amount of the time -1.1109\nA moderate amount of the time|Most of the time            1.0279\nMost of the time|All of the time                          4.1937\n\nResidual Deviance: 471.2221 \nAIC: 481.2221 \n```\n\n\n:::\n:::\n\n\n\nstep() ran through all the possible demographics to find the model with the lowest AIC. In this case the most successful model was one with just age as a demographic input.\n\n\nWe can run the step() function looping through all the possible outcome variables using the imputed data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# List to store results\nmodels <- list()\nstepwise_models <- list()\n\n# Loop through selected outcomes\nfor (outcome in outcome_vars) {\n  formula <- as.formula(paste(outcome, \"~ Age + Gender + Music_listening + Practice + Floor\"))\n\n  tryCatch({\n    # Fit proportional odds model\n    model <- polr(formula, data = completed_data1, Hess = TRUE, method = \"probit\", \n                  control = list(maxit = 1000), na.action = na.exclude)\n    \n    # Store model\n    models[[outcome]] <- model\n    \n    # Print summary\n    cat(\"\\nSummary for\", outcome, \":\\n\")\n    print(summary(model))\n    \n    # Perform stepwise regression\n    step_model <- step(model, direction = \"backward\", trace = FALSE)\n    stepwise_models[[outcome]] <- step_model\n    \n    # Print stepwise summary\n    cat(\"\\nStepwise Model Summary for\", outcome, \":\\n\")\n    print(summary(step_model))\n    \n  }, error = function(e) {\n    cat(\"\\nSkipping\", outcome, \"due to error:\", conditionMessage(e), \"\\n\")\n  })\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nSummary for Fictional_story :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                          Value Std. Error t value\nAge                                  -0.0119694   0.004507 -2.6559\nGenderFemale                         -0.1304844   0.171772 -0.7596\nGenderOther                           0.2866160   1.142658  0.2508\nMusic_listeningSomewhat rarely        0.3869493   0.818075  0.4730\nMusic_listeningModerately frequently  0.1100234   0.760115  0.1447\nMusic_listeningFrequently            -0.3969950   0.747131 -0.5314\nMusic_listeningVery frequently       -0.2231091   0.745208 -0.2994\nPractice                             -0.0006767   0.004035 -0.1677\nFloorUpstairs                        -0.0696105   0.189520 -0.3673\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.2489  0.7788   \nA small amount of the time|A moderate amount of the time -0.6293  0.7734   \nA moderate amount of the time|Most of the time           -0.0534  0.7759   \nMost of the time|All of the time                          1.0040  0.7985   \n                                                         t value\nNot at all|A small amount of the time                    -1.6036\nA small amount of the time|A moderate amount of the time -0.8137\nA moderate amount of the time|Most of the time           -0.0688\nMost of the time|All of the time                          1.2573\n\nResidual Deviance: 462.6495 \nAIC: 488.6495 \n\nStepwise Model Summary for Fictional_story :\nCall:\npolr(formula = Fictional_story ~ Age, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.01087   0.004265  -2.549\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.8932  0.2658   \nA small amount of the time|A moderate amount of the time -0.2880  0.2593   \nA moderate amount of the time|Most of the time            0.2708  0.2634   \nMost of the time|All of the time                          1.2830  0.3059   \n                                                         t value\nNot at all|A small amount of the time                    -3.3605\nA small amount of the time|A moderate amount of the time -1.1109\nA moderate amount of the time|Most of the time            1.0279\nMost of the time|All of the time                          4.1937\n\nResidual Deviance: 471.2221 \nAIC: 481.2221 \n\nSummary for Abstract_shapes :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error  t value\nAge                                  -0.007717   0.004651 -1.65937\nGenderFemale                          0.139259   0.181091  0.76900\nGenderOther                           0.404613   1.124977  0.35966\nMusic_listeningSomewhat rarely       -0.232743   0.895790 -0.25982\nMusic_listeningModerately frequently -0.061782   0.833906 -0.07409\nMusic_listeningFrequently            -0.080580   0.820245 -0.09824\nMusic_listeningVery frequently        0.028789   0.817584  0.03521\nPractice                              0.002845   0.004105  0.69306\nFloorUpstairs                        -0.062090   0.196443 -0.31607\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.2575  0.8396   \nA small amount of the time|A moderate amount of the time  0.4112  0.8386   \nA moderate amount of the time|Most of the time            1.1371  0.8439   \nMost of the time|All of the time                          2.1552  0.9067   \n                                                         t value\nNot at all|A small amount of the time                    -0.3067\nA small amount of the time|A moderate amount of the time  0.4904\nA moderate amount of the time|Most of the time            1.3474\nMost of the time|All of the time                          2.3769\n\nResidual Deviance: 382.2277 \nAIC: 408.2277 \n\nStepwise Model Summary for Abstract_shapes :\nCall:\npolr(formula = Abstract_shapes ~ Age, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n        Value Std. Error t value\nAge -0.007516   0.004429  -1.697\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.2910  0.2718   \nA small amount of the time|A moderate amount of the time  0.3716  0.2720   \nA moderate amount of the time|Most of the time            1.0905  0.2899   \nMost of the time|All of the time                          2.1051  0.4312   \n                                                         t value\nNot at all|A small amount of the time                    -1.0705\nA small amount of the time|A moderate amount of the time  1.3665\nA moderate amount of the time|Most of the time            3.7619\nMost of the time|All of the time                          4.8814\n\nResidual Deviance: 384.1321 \nAIC: 394.1321 \n\nSummary for Sensory_sensations :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error t value\nAge                                   0.001477   0.005143  0.2872\nGenderFemale                          0.097504   0.193062  0.5050\nGenderOther                           0.989921   1.146929  0.8631\nMusic_listeningSomewhat rarely        3.475040   0.333934 10.4064\nMusic_listeningModerately frequently  3.440302   0.209330 16.4348\nMusic_listeningFrequently             3.595043   0.174398 20.6141\nMusic_listeningVery frequently        3.525095   0.167035 21.1039\nPractice                             -0.003816   0.004481 -0.8517\nFloorUpstairs                         0.056182   0.211594  0.2655\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                     4.0713  0.3210   \nA small amount of the time|A moderate amount of the time  4.8295  0.3339   \nA moderate amount of the time|Most of the time            5.4624  0.3668   \nMost of the time|All of the time                          9.6701  0.3668   \n                                                         t value\nNot at all|A small amount of the time                    12.6818\nA small amount of the time|A moderate amount of the time 14.4651\nA moderate amount of the time|Most of the time           14.8929\nMost of the time|All of the time                         26.3651\n\nResidual Deviance: 308.6269 \nAIC: 334.6269 \n\nStepwise Model Summary for Sensory_sensations :\nCall:\npolr(formula = Sensory_sensations ~ 1, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nNo coefficients\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                     0.4361  0.0998   \nA small amount of the time|A moderate amount of the time  1.1833  0.1254   \nA moderate amount of the time|Most of the time            1.8055  0.1821   \nMost of the time|All of the time                          5.2824 58.3345   \n                                                         t value\nNot at all|A small amount of the time                     4.3695\nA small amount of the time|A moderate amount of the time  9.4335\nA moderate amount of the time|Most of the time            9.9160\nMost of the time|All of the time                          0.0906\n\nResidual Deviance: 312.1081 \nAIC: 320.1081 \n\nSummary for Life_experiences :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                          Value Std. Error  t value\nAge                                  -0.0185912   0.004496 -4.13501\nGenderFemale                          0.3338443   0.168246  1.98426\nGenderOther                           0.0435836   1.130373  0.03856\nMusic_listeningSomewhat rarely       -0.8386026   0.838070 -1.00064\nMusic_listeningModerately frequently -0.5336945   0.783171 -0.68145\nMusic_listeningFrequently            -0.8846652   0.771458 -1.14674\nMusic_listeningVery frequently       -0.7085922   0.768244 -0.92235\nPractice                              0.0003421   0.003938  0.08688\nFloorUpstairs                         0.0887653   0.184924  0.48001\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.3465  0.8069   \nA small amount of the time|A moderate amount of the time -1.5697  0.8002   \nA moderate amount of the time|Most of the time           -0.6085  0.7931   \nMost of the time|All of the time                          0.6236  0.8114   \n                                                         t value\nNot at all|A small amount of the time                    -2.9080\nA small amount of the time|A moderate amount of the time -1.9615\nA moderate amount of the time|Most of the time           -0.7673\nMost of the time|All of the time                          0.7685\n\nResidual Deviance: 461.8797 \nAIC: 487.8797 \n\nStepwise Model Summary for Life_experiences :\nCall:\npolr(formula = Life_experiences ~ Age + Gender, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n                Value Std. Error t value\nAge          -0.01837   0.004339 -4.2348\nGenderFemale  0.35029   0.166603  2.1025\nGenderOther  -0.12500   1.061700 -0.1177\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.6660  0.2969   \nA small amount of the time|A moderate amount of the time -0.8944  0.2869   \nA moderate amount of the time|Most of the time            0.0565  0.2810   \nMost of the time|All of the time                          1.2609  0.3245   \n                                                         t value\nNot at all|A small amount of the time                    -5.6112\nA small amount of the time|A moderate amount of the time -3.1173\nA moderate amount of the time|Most of the time            0.2009\nMost of the time|All of the time                          3.8851\n\nResidual Deviance: 465.5019 \nAIC: 479.5019 \n\nSummary for Media :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error  t value\nAge                                  -0.010872   0.004946 -2.19822\nGenderFemale                         -0.101713   0.190530 -0.53384\nGenderOther                           0.247960   1.133610  0.21873\nMusic_listeningSomewhat rarely        0.667168   0.899813  0.74145\nMusic_listeningModerately frequently -0.078588   0.850081 -0.09245\nMusic_listeningFrequently            -0.083448   0.835649 -0.09986\nMusic_listeningVery frequently        0.039282   0.830912  0.04728\nPractice                             -0.002154   0.004500 -0.47868\nFloorUpstairs                         0.114767   0.217220  0.52834\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.2502  0.8738   \nA small amount of the time|A moderate amount of the time  0.3088  0.8743   \nA moderate amount of the time|Most of the time            1.1306  0.8850   \nMost of the time|All of the time                          6.2508  0.8850   \n                                                         t value\nNot at all|A small amount of the time                    -0.2863\nA small amount of the time|A moderate amount of the time  0.3532\nA moderate amount of the time|Most of the time            1.2775\nMost of the time|All of the time                          7.0632\n\nResidual Deviance: 329.2396 \nAIC: 355.2396 \n\nStepwise Model Summary for Media :\nCall:\npolr(formula = Media ~ Age, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.01192   0.004678  -2.549\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.3201  0.2811   \nA small amount of the time|A moderate amount of the time  0.2227  0.2797   \nA moderate amount of the time|Most of the time            1.0178  0.3035   \nMost of the time|All of the time                          4.0381 14.8246   \n                                                         t value\nNot at all|A small amount of the time                    -1.1387\nA small amount of the time|A moderate amount of the time  0.7964\nA moderate amount of the time|Most of the time            3.3541\nMost of the time|All of the time                          0.2724\n\nResidual Deviance: 334.9296 \nAIC: 344.9296 \n\nSummary for Music :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error t value\nAge                                  -0.004825   0.004461 -1.0817\nGenderFemale                          0.252545   0.169562  1.4894\nGenderOther                           0.129646   1.163197  0.1115\nMusic_listeningSomewhat rarely        1.678389   0.829738  2.0228\nMusic_listeningModerately frequently  1.323757   0.769981  1.7192\nMusic_listeningFrequently             1.412387   0.759212  1.8603\nMusic_listeningVery frequently        2.019221   0.761680  2.6510\nPractice                              0.010954   0.004055  2.7015\nFloorUpstairs                        -0.052933   0.187118 -0.2829\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.3323  0.7888   \nA small amount of the time|A moderate amount of the time  0.3538  0.7789   \nA moderate amount of the time|Most of the time            1.1955  0.7861   \nMost of the time|All of the time                          2.4851  0.7969   \n                                                         t value\nNot at all|A small amount of the time                    -0.4213\nA small amount of the time|A moderate amount of the time  0.4543\nA moderate amount of the time|Most of the time            1.5209\nMost of the time|All of the time                          3.1182\n\nResidual Deviance: 430.3254 \nAIC: 456.3254 \n\nStepwise Model Summary for Music :\nCall:\npolr(formula = Music ~ Music_listening + Practice, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error t value\nMusic_listeningSomewhat rarely       1.582661    0.81114   1.951\nMusic_listeningModerately frequently 1.199592    0.75908   1.580\nMusic_listeningFrequently            1.297897    0.75320   1.723\nMusic_listeningVery frequently       1.915436    0.75248   2.545\nPractice                             0.009943    0.00397   2.504\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.2466  0.7563   \nA small amount of the time|A moderate amount of the time  0.4116  0.7469   \nA moderate amount of the time|Most of the time            1.2443  0.7539   \nMost of the time|All of the time                          2.5247  0.7651   \n                                                         t value\nNot at all|A small amount of the time                    -0.3261\nA small amount of the time|A moderate amount of the time  0.5511\nA moderate amount of the time|Most of the time            1.6505\nMost of the time|All of the time                          3.3000\n\nResidual Deviance: 433.7725 \nAIC: 451.7725 \n\nSummary for Future_plans :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                          Value Std. Error t value\nAge                                  -0.0297459   0.004786 -6.2148\nGenderFemale                         -0.1171670   0.173718 -0.6745\nGenderOther                          -0.9751986   1.129557 -0.8633\nMusic_listeningSomewhat rarely        0.1019078   0.831239  0.1226\nMusic_listeningModerately frequently -0.1386299   0.773797 -0.1792\nMusic_listeningFrequently            -0.5641257   0.760582 -0.7417\nMusic_listeningVery frequently       -0.4006497   0.759090 -0.5278\nPractice                              0.0004275   0.004183  0.1022\nFloorUpstairs                        -0.0828124   0.192812 -0.4295\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.5309  0.8043   \nA small amount of the time|A moderate amount of the time -1.7781  0.7948   \nA moderate amount of the time|Most of the time           -0.9118  0.7877   \nMost of the time|All of the time                          0.0447  0.8069   \n                                                         t value\nNot at all|A small amount of the time                    -3.1466\nA small amount of the time|A moderate amount of the time -2.2372\nA moderate amount of the time|Most of the time           -1.1576\nMost of the time|All of the time                          0.0554\n\nResidual Deviance: 425.868 \nAIC: 451.868 \n\nStepwise Model Summary for Future_plans :\nCall:\npolr(formula = Future_plans ~ Age, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n      Value Std. Error t value\nAge -0.0279    0.00454  -6.146\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.9467  0.2897   \nA small amount of the time|A moderate amount of the time -1.2071  0.2763   \nA moderate amount of the time|Most of the time           -0.3564  0.2669   \nMost of the time|All of the time                          0.5703  0.2977   \n                                                         t value\nNot at all|A small amount of the time                    -6.7195\nA small amount of the time|A moderate amount of the time -4.3689\nA moderate amount of the time|Most of the time           -1.3353\nMost of the time|All of the time                          1.9154\n\nResidual Deviance: 431.3382 \nAIC: 441.3382 \n\nSummary for Building :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error    t value\nAge                                  -0.014909  4.707e-03 -3.167e+00\nGenderFemale                         -0.325161  1.791e-01 -1.816e+00\nGenderOther                          -4.624617  5.802e-06 -7.970e+05\nMusic_listeningSomewhat rarely        3.395080  3.271e-01  1.038e+01\nMusic_listeningModerately frequently  3.770237  1.930e-01  1.954e+01\nMusic_listeningFrequently             3.978579  1.664e-01  2.390e+01\nMusic_listeningVery frequently        4.127860  1.606e-01  2.571e+01\nPractice                             -0.001467  4.216e-03 -3.479e-01\nFloorUpstairs                         0.331029  2.039e-01  1.623e+00\n\nIntercepts:\n                                                         Value       \nNot at all|A small amount of the time                          3.0040\nA small amount of the time|A moderate amount of the time       4.1311\nA moderate amount of the time|Most of the time                 5.0114\nMost of the time|All of the time                               5.5848\n                                                         Std. Error  \nNot at all|A small amount of the time                          0.2968\nA small amount of the time|A moderate amount of the time       0.2997\nA moderate amount of the time|Most of the time                 0.3223\nMost of the time|All of the time                               0.3841\n                                                         t value     \nNot at all|A small amount of the time                         10.1222\nA small amount of the time|A moderate amount of the time      13.7831\nA moderate amount of the time|Most of the time                15.5503\nMost of the time|All of the time                              14.5407\n\nResidual Deviance: 359.3626 \nAIC: 385.3626 \n\nStepwise Model Summary for Building :\nCall:\npolr(formula = Building ~ Age + Gender + Music_listening + Floor, \n    data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, \n    Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error    t value\nAge                                  -0.01506  0.0046870 -3.213e+00\nGenderFemale                         -0.32002  0.1784391 -1.793e+00\nGenderOther                          -4.41799  0.0000141 -3.133e+05\nMusic_listeningSomewhat rarely        3.48454  0.3274930  1.064e+01\nMusic_listeningModerately frequently  3.86134  0.1926620  2.004e+01\nMusic_listeningFrequently             4.05756  0.1647944  2.462e+01\nMusic_listeningVery frequently        4.20895  0.1596560  2.636e+01\nFloorUpstairs                         0.32172  0.2020685  1.592e+00\n\nIntercepts:\n                                                         Value       \nNot at all|A small amount of the time                          3.0991\nA small amount of the time|A moderate amount of the time       4.2254\nA moderate amount of the time|Most of the time                 5.1035\nMost of the time|All of the time                               5.6774\n                                                         Std. Error  \nNot at all|A small amount of the time                          0.2959\nA small amount of the time|A moderate amount of the time       0.2990\nA moderate amount of the time|Most of the time                 0.3218\nMost of the time|All of the time                               0.3839\n                                                         t value     \nNot at all|A small amount of the time                         10.4747\nA small amount of the time|A moderate amount of the time      14.1310\nA moderate amount of the time|Most of the time                15.8587\nMost of the time|All of the time                              14.7871\n\nResidual Deviance: 359.4838 \nAIC: 383.4838 \n\nSummary for Everyday :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error  t value\nAge                                  -0.016147   0.004533 -3.56225\nGenderFemale                          0.044141   0.171463  0.25744\nGenderOther                           0.039425   1.156164  0.03410\nMusic_listeningSomewhat rarely       -0.629524   0.855960 -0.73546\nMusic_listeningModerately frequently  0.117966   0.785209  0.15024\nMusic_listeningFrequently            -0.158050   0.773739 -0.20427\nMusic_listeningVery frequently        0.083396   0.771575  0.10809\nPractice                             -0.005048   0.004110 -1.22843\nFloorUpstairs                        -0.015218   0.189961 -0.08011\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.4546  0.8036   \nA small amount of the time|A moderate amount of the time -0.3433  0.7996   \nA moderate amount of the time|Most of the time            0.4885  0.8054   \nMost of the time|All of the time                          1.1002  0.8209   \n                                                         t value\nNot at all|A small amount of the time                    -1.8101\nA small amount of the time|A moderate amount of the time -0.4294\nA moderate amount of the time|Most of the time            0.6065\nMost of the time|All of the time                          1.3402\n\nResidual Deviance: 416.4516 \nAIC: 442.4516 \n\nStepwise Model Summary for Everyday :\nCall:\npolr(formula = Everyday ~ Age, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.01527   0.004303  -3.549\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.3073  0.2741   \nA small amount of the time|A moderate amount of the time -0.2215  0.2642   \nA moderate amount of the time|Most of the time            0.6075  0.2718   \nMost of the time|All of the time                          1.2102  0.3072   \n                                                         t value\nNot at all|A small amount of the time                    -4.7696\nA small amount of the time|A moderate amount of the time -0.8384\nA moderate amount of the time|Most of the time            2.2351\nMost of the time|All of the time                          3.9400\n\nResidual Deviance: 423.2318 \nAIC: 433.2318 \n```\n\n\n:::\n:::\n\n\n\nFrom the above, we can see that the models with the lowest AIC (using just main effects) are as follows:\n\nFictional story:\npolr(formula = Fictional_story ~ Age, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n    \nAbstract shapes:\npolr(formula = Abstract_shapes ~ Age, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n    \nSensory sensations:\npolr(formula = Sensory_sensations ~ 1, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n    \nLife experiences:\npolr(formula = Life_experiences ~ Age + Gender, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n    \nMedia:\npolr(formula = Media ~ Age, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n    \nMusic:\npolr(formula = Music ~ Music_listening + Practice, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n    \nFuture plans:\npolr(formula = Future_plans ~ Age, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nBuilding:\npolr(formula = Building ~ Age + Gender + Music_listening + Floor, \n    data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, \n    Hess = TRUE, method = \"probit\")\n\nEveryday:\npolr(formula = Everyday ~ Age, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\n\nLet's also look at the interactions between the demographic variables and check for multicollinearity.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(conflicted)\nconflict_prefer(\"filter\", \"dplyr\")\n\ndemographics <- c('Age', 'Gender', 'Music_listening', 'Practice', 'Floor')\ndemographics_data <- dplyr::select(data1, all_of(demographics))\n\n# Convert categorical variables to numeric\ndemographics_numeric <- demographics_data %>%\n  mutate(\n    Gender = as.numeric(factor(Gender)),\n    Music_listening = as.numeric(factor(Music_listening, ordered = TRUE)),  \n    Floor = as.numeric(factor(Floor))\n  ) \n\n# Compute correlation matrix\ncor_matrix <- cor(demographics_numeric, use = \"pairwise.complete.obs\")\n\n# Plot heatmap\ncorrplot(cor_matrix, method = \"color\", type = \"lower\", \n         tl.col = \"black\", tl.srt = 45, addCoef.col = \"white\", \n         col = colorRampPalette(c(\"blue\", \"white\", \"red\"))(200))\n```\n\n::: {.cell-output-display}\n![](Modelling_2_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Here's another way of visualising the interactions\nggplot(data1, aes(x = Age, y = Practice, color = Floor)) +\n  geom_point(alpha = 0.6) +  \n  geom_smooth(method = \"lm\", se = FALSE, linetype = \"dashed\") +\n  facet_wrap(~ Floor) +\n  labs(title = \"Age vs. Practice by Floor\",\n       x = \"Age\", \n       y = \"Practice (Number of Years)\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Modelling_2_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#Checking for collinearity\nmodel1 <- lm(Age ~ Practice + Gender + Music_listening + Floor, data = demographics_numeric)\nmodel2 <- lm(Gender ~ Age + Practice + Music_listening + Floor, data = demographics_numeric)\nmodel3 <- lm(Practice ~ Age + Gender + Music_listening + Floor, data = demographics_numeric)\nmodel4 <- lm(Music_listening ~ Age + Gender + Practice + Floor, data = demographics_numeric)\nmodel5 <- lm(Floor ~ Age + Gender + Practice + Music_listening, data = demographics_numeric)\nvif(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Practice          Gender Music_listening           Floor \n       1.036377        1.002153        1.034110        1.003875 \n```\n\n\n:::\n\n```{.r .cell-code}\nvif(model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Age        Practice Music_listening           Floor \n       1.086216        1.067477        1.034662        1.059068 \n```\n\n\n:::\n\n```{.r .cell-code}\nvif(model3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Age          Gender Music_listening           Floor \n       1.064866        1.011938        1.004652        1.051720 \n```\n\n\n:::\n\n```{.r .cell-code}\nvif(model4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     Age   Gender Practice    Floor \n1.096117 1.011828 1.036402 1.058475 \n```\n\n\n:::\n\n```{.r .cell-code}\nvif(model5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Age          Gender        Practice Music_listening \n       1.039690        1.011967        1.060100        1.034224 \n```\n\n\n:::\n:::\n\n\n\nAll vif() outputs are close to 1, indicating that multicollinearity shouldn't be a problem.\n\nIn the post on 'Ordinal regression: final models', we'll use these step() results to run some final model visualisations.\n",
    "supporting": [
      "Modelling_2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}