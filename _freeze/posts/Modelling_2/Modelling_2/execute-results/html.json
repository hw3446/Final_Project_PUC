{
  "hash": "7c484f28471ee6f1ac9492b1dc4ae629",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Ordinal regression: model Selection\"\nformat: html\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tidyverse' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'ggplot2' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tibble' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'tidyr' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'readr' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'purrr' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'dplyr' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'stringr' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'forcats' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'lubridate' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(MASS)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'MASS'\n\nThe following object is masked from 'package:dplyr':\n\n    select\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(corrplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'corrplot' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\ncorrplot 0.95 loaded\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'car' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: carData\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'carData' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'car'\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\nThe following object is masked from 'package:purrr':\n\n    some\n```\n\n\n:::\n:::\n\n\n\nIn this section, we'll experiment with the step() function in R to help select ordinal regression models for our data.\n\nstep() is not compatible with clm(), which is why we'll use polr().\n\nThe step() function starts with a full model containing all the possible main effects (as specified by me; in this case all the possible demographic variables). It tests different combinations of variables and then keeps the model with the lowest AIC.\n\nThis is useful when we're dealing with lots of different outcome variables and lots of demographic inputs and we need to figure out which ones to use.\n\nHere's how we'd run the step() function starting with all the demographic variables and using just fictional story as our outcome.\n\nFirst some data loading, and demographic variable tidying.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 <- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 103 Columns: 27\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (26): Fictional_story, Abstract_shapes, Sensory_sensations, Life_experie...\ndbl  (1): Participant_number\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ndata2 <- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data2.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 92 Columns: 27\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (27): Fictional_story, Abstract_shapes, Sensory_sensations, Life_experie...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\noutcome_vars <- c(\"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \n                  \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \n                  \"Building\", \"Everyday\")\n\n# Converting outcome variables to factors with consistent levels for each thought type\ndata1[outcome_vars] <- lapply(data1[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\ndata2[outcome_vars] <- lapply(data2[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\n#Remaking the floor variable\ndata1 <- data1 %>%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %>% relocate(Floor, .after = Location)\n\ndata2 <- data2 %>%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %>% relocate(Floor, .after = Location)\n\n#Making sure demographic variables are classed in the right way.\ndata1$Age <- as.numeric(data1$Age)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: NAs introduced by coercion\n```\n\n\n:::\n\n```{.r .cell-code}\ndata2$Age <- as.numeric(data2$Age)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: NAs introduced by coercion\n```\n\n\n:::\n\n```{.r .cell-code}\ndata1$Practice <- as.numeric(as.character(data1$Practice))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: NAs introduced by coercion\n```\n\n\n:::\n\n```{.r .cell-code}\ndata2$Practice <- as.numeric(as.character(data2$Practice))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: NAs introduced by coercion\n```\n\n\n:::\n\n```{.r .cell-code}\ndata1$Gender <- factor(data1$Gender,  levels = c('Male', 'Female', 'Other'))\ndata2$Gender <- factor(data2$Gender,  levels = c('Male', 'Female', 'Other'))\ndata1$Music_listening <- factor(data1$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata2$Music_listening <- factor(data2$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata1$Floor <- factor(data1$Floor, levels = c('Downstairs', 'Upstairs'))\ndata2$Floor <- factor(data2$Floor, levels = c('Downstairs', 'Upstairs'))\n```\n:::\n\n\n\n1.  Start by specifying the model with the maximum number of demographic inputs.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyr)\nvars_to_check <- c(\"Fictional_story\", \"Age\", \"Gender\", \"Music_listening\", \"Practice\", \"Floor\")\ndata_clean1 <- data1[complete.cases(data1[vars_to_check]), ]\n\nfull_model_fiction <- polr(Fictional_story ~ Age  + Gender + Music_listening + Practice + Floor, data = data_clean1, Hess = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstepwise_model <- step(full_model_fiction)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStart:  AIC=196.44\nFictional_story ~ Age + Gender + Music_listening + Practice + \n    Floor\n\n                  Df    AIC\n- Music_listening  4 189.20\n- Gender           2 194.00\n- Age              1 194.47\n- Floor            1 194.61\n<none>               196.44\n- Practice         1 200.04\n\nStep:  AIC=189.2\nFictional_story ~ Age + Gender + Practice + Floor\n\n           Df    AIC\n- Age       1 187.24\n- Floor     1 187.26\n- Gender    2 187.42\n<none>        189.20\n- Practice  1 192.79\n\nStep:  AIC=187.24\nFictional_story ~ Gender + Practice + Floor\n\n           Df    AIC\n- Floor     1 185.32\n- Gender    2 185.67\n<none>        187.24\n- Practice  1 191.05\n\nStep:  AIC=185.32\nFictional_story ~ Gender + Practice\n\n           Df    AIC\n- Gender    2 183.69\n<none>        185.32\n- Practice  1 189.13\n\nStep:  AIC=183.69\nFictional_story ~ Practice\n\n           Df    AIC\n<none>        183.69\n- Practice  1 187.52\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(stepwise_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\npolr(formula = Fictional_story ~ Practice, data = data_clean1, \n    Hess = TRUE)\n\nCoefficients:\n            Value Std. Error t value\nPractice -0.03329    0.01457  -2.284\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.2585  0.3594   \nA small amount of the time|A moderate amount of the time  0.1165  0.3167   \nA moderate amount of the time|Most of the time            1.2920  0.3765   \nMost of the time|All of the time                          2.6386  0.6086   \n                                                         t value\nNot at all|A small amount of the time                    -3.5013\nA small amount of the time|A moderate amount of the time  0.3678\nA moderate amount of the time|Most of the time            3.4313\nMost of the time|All of the time                          4.3356\n\nResidual Deviance: 173.6913 \nAIC: 183.6913 \n```\n\n\n:::\n:::\n\n\n\nWe'll repeat this looping through all the different thought types.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# List to store results\nmodels <- list()\nstepwise_models <- list()\n\n# Loop through selected outcomes\nfor (outcome in outcome_vars) {\n  formula <- as.formula(paste(outcome, \"~ Age + Gender + Music_listening + Practice + Floor\"))\n  \n  # Drop rows with NA values in the outcome or predictors\n  vars_to_check <- c(outcome, \"Age\", \"Gender\", \"Music_listening\", \"Practice\", \"Floor\")\n  data1_subset <- data1[complete.cases(data1[vars_to_check]), ]\n\n  # Debugging message\n  cat(\"\\nProcessing:\", outcome, \n      \" | Rows before:\", nrow(data1), \n      \" | Rows after NA removal:\", nrow(data1_subset), \"\\n\")\n\n  tryCatch({\n    # Fit proportional odds model\n    model <- polr(formula, data = data1_subset, Hess = TRUE, method = \"probit\", \n                  control = list(maxit = 1000), na.action = na.exclude)\n    \n    # Store model\n    models[[outcome]] <- model\n    \n    # Print summary\n    cat(\"\\nSummary for\", outcome, \":\\n\")\n    print(summary(model))\n    \n    # Perform stepwise regression\n    step_model <- step(model, direction = \"backward\", trace = FALSE)\n    stepwise_models[[outcome]] <- step_model\n    \n    # Print stepwise summary\n    cat(\"\\nStepwise Model Summary for\", outcome, \":\\n\")\n    print(summary(step_model))\n    \n  }, error = function(e) {\n    cat(\"\\nSkipping\", outcome, \"due to error:\", conditionMessage(e), \"\\n\")\n  })\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nProcessing: Fictional_story  | Rows before: 103  | Rows after NA removal: 62 \n\nSummary for Fictional_story :\nCall:\npolr(formula = formula, data = data1_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error   t value\nAge                                  -0.001156   0.008369 -0.138110\nGenderFemale                         -0.144510   0.295017 -0.489838\nGenderOther                           1.124412   1.295218  0.868126\nMusic_listeningSomewhat rarely        0.216922   1.284684  0.168852\nMusic_listeningModerately frequently -0.143209   1.168389 -0.122569\nMusic_listeningFrequently             0.131554   1.130832  0.116334\nMusic_listeningVery frequently        0.003198   1.158241  0.002761\nPractice                             -0.021141   0.009444 -2.238566\nFloorUpstairs                         0.078595   0.404115  0.194486\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.8203  1.1149   \nA small amount of the time|A moderate amount of the time  0.0438  1.1120   \nA moderate amount of the time|Most of the time            0.7611  1.1243   \nMost of the time|All of the time                          1.4618  1.1456   \n                                                         t value\nNot at all|A small amount of the time                    -0.7358\nA small amount of the time|A moderate amount of the time  0.0394\nA moderate amount of the time|Most of the time            0.6769\nMost of the time|All of the time                          1.2760\n\nResidual Deviance: 171.0921 \nAIC: 197.0921 \n\nStepwise Model Summary for Fictional_story :\nCall:\npolr(formula = Fictional_story ~ Practice, data = data1_subset, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n            Value Std. Error t value\nPractice -0.02019   0.008675  -2.327\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.7637  0.2120   \nA small amount of the time|A moderate amount of the time  0.0806  0.1954   \nA moderate amount of the time|Most of the time            0.7756  0.2140   \nMost of the time|All of the time                          1.4559  0.2866   \n                                                         t value\nNot at all|A small amount of the time                    -3.6025\nA small amount of the time|A moderate amount of the time  0.4123\nA moderate amount of the time|Most of the time            3.6245\nMost of the time|All of the time                          5.0801\n\nResidual Deviance: 173.8591 \nAIC: 183.8591 \n\nProcessing: Abstract_shapes  | Rows before: 103  | Rows after NA removal: 62 \n\nSummary for Abstract_shapes :\nCall:\npolr(formula = formula, data = data1_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error t value\nAge                                   0.001293   0.009015  0.1435\nGenderFemale                          0.094923   0.319923  0.2967\nGenderOther                           0.620000   1.361648  0.4553\nMusic_listeningSomewhat rarely       -1.495159   1.358356 -1.1007\nMusic_listeningModerately frequently -2.152360   1.228772 -1.7516\nMusic_listeningFrequently            -1.010729   1.163135 -0.8690\nMusic_listeningVery frequently       -0.704038   1.191806 -0.5907\nPractice                             -0.016892   0.010296 -1.6406\nFloorUpstairs                        -0.481572   0.435557 -1.1056\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.4962  1.1526   \nA small amount of the time|A moderate amount of the time -0.5506  1.1395   \nA moderate amount of the time|Most of the time            0.4749  1.1378   \nMost of the time|All of the time                          0.7601  1.1645   \n                                                         t value\nNot at all|A small amount of the time                    -1.2982\nA small amount of the time|A moderate amount of the time -0.4832\nA moderate amount of the time|Most of the time            0.4174\nMost of the time|All of the time                          0.6527\n\nResidual Deviance: 121.6429 \nAIC: 147.6429 \n\nStepwise Model Summary for Abstract_shapes :\nCall:\npolr(formula = Abstract_shapes ~ Music_listening + Practice, \n    data = data1_subset, control = list(maxit = 1000), na.action = na.exclude, \n    Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error t value\nMusic_listeningSomewhat rarely       -1.73317    1.18510  -1.462\nMusic_listeningModerately frequently -2.42215    1.13325  -2.137\nMusic_listeningFrequently            -1.33242    1.10287  -1.208\nMusic_listeningVery frequently       -1.14831    1.07922  -1.064\nPractice                             -0.01743    0.01004  -1.736\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.6159  1.0791   \nA small amount of the time|A moderate amount of the time -0.6908  1.0634   \nA moderate amount of the time|Most of the time            0.3422  1.0627   \nMost of the time|All of the time                          0.6347  1.0965   \n                                                         t value\nNot at all|A small amount of the time                    -1.4975\nA small amount of the time|A moderate amount of the time -0.6496\nA moderate amount of the time|Most of the time            0.3220\nMost of the time|All of the time                          0.5788\n\nResidual Deviance: 123.8166 \nAIC: 141.8166 \n\nProcessing: Sensory_sensations  | Rows before: 103  | Rows after NA removal: 62 \n\nSummary for Sensory_sensations :\nCall:\npolr(formula = formula, data = data1_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error t value\nAge                                   0.02503    0.01054  2.3758\nGenderFemale                          0.27562    0.36235  0.7606\nGenderOther                           1.90055    1.39187  1.3655\nMusic_listeningSomewhat rarely        3.60030    0.58406  6.1643\nMusic_listeningModerately frequently  2.99538    0.41697  7.1838\nMusic_listeningFrequently             4.33295    0.32095 13.5003\nMusic_listeningVery frequently        4.01218    0.31954 12.5561\nPractice                             -0.02545    0.01132 -2.2491\nFloorUpstairs                        -0.21532    0.43745 -0.4922\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                     5.2034  0.5926   \nA small amount of the time|A moderate amount of the time  6.0903  0.6307   \nA moderate amount of the time|Most of the time            6.6658  0.6988   \nMost of the time|All of the time                         11.4573  0.6988   \n                                                         t value\nNot at all|A small amount of the time                     8.7803\nA small amount of the time|A moderate amount of the time  9.6569\nA moderate amount of the time|Most of the time            9.5392\nMost of the time|All of the time                         16.3965\n\nResidual Deviance: 98.19762 \nAIC: 124.1976 \n\nStepwise Model Summary for Sensory_sensations :\nCall:\npolr(formula = Sensory_sensations ~ Age + Practice, data = data1_subset, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n            Value Std. Error t value\nAge       0.01261   0.008429   1.496\nPractice -0.01835   0.010303  -1.781\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                     0.8462  0.4711   \nA small amount of the time|A moderate amount of the time  1.6568  0.5009   \nA moderate amount of the time|Most of the time            2.1623  0.5506   \nMost of the time|All of the time                          6.5306  0.5506   \n                                                         t value\nNot at all|A small amount of the time                     1.7963\nA small amount of the time|A moderate amount of the time  3.3074\nA moderate amount of the time|Most of the time            3.9270\nMost of the time|All of the time                         11.8605\n\nResidual Deviance: 107.702 \nAIC: 119.702 \n\nProcessing: Life_experiences  | Rows before: 103  | Rows after NA removal: 63 \n\nSummary for Life_experiences :\nCall:\npolr(formula = formula, data = data1_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error  t value\nAge                                  -0.02077   0.008403 -2.47169\nGenderFemale                          0.14990   0.284738  0.52644\nGenderOther                           0.33685   1.312373  0.25667\nMusic_listeningSomewhat rarely       -0.43627   1.296161 -0.33658\nMusic_listeningModerately frequently  0.18163   1.187559  0.15294\nMusic_listeningFrequently             0.02728   1.154509  0.02362\nMusic_listeningVery frequently        0.15996   1.175344  0.13610\nPractice                             -0.01037   0.008420 -1.23152\nFloorUpstairs                        -0.05211   0.395779 -0.13166\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.0229  1.1524   \nA small amount of the time|A moderate amount of the time -1.1208  1.1371   \nA moderate amount of the time|Most of the time            0.0499  1.1311   \nMost of the time|All of the time                          0.9767  1.1622   \n                                                         t value\nNot at all|A small amount of the time                    -1.7554\nA small amount of the time|A moderate amount of the time -0.9857\nA moderate amount of the time|Most of the time            0.0441\nMost of the time|All of the time                          0.8403\n\nResidual Deviance: 167.0123 \nAIC: 193.0123 \n\nStepwise Model Summary for Life_experiences :\nCall:\npolr(formula = Life_experiences ~ Age, data = data1_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.02014   0.007191  -2.801\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.9386  0.4246   \nA small amount of the time|A moderate amount of the time -1.0573  0.3920   \nA moderate amount of the time|Most of the time            0.0828  0.3780   \nMost of the time|All of the time                          0.9870  0.4437   \n                                                         t value\nNot at all|A small amount of the time                    -4.5654\nA small amount of the time|A moderate amount of the time -2.6974\nA moderate amount of the time|Most of the time            0.2189\nMost of the time|All of the time                          2.2245\n\nResidual Deviance: 170.1187 \nAIC: 180.1187 \n\nProcessing: Media  | Rows before: 103  | Rows after NA removal: 62 \n\nSummary for Media :\nCall:\npolr(formula = formula, data = data1_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error  t value\nAge                                   0.004283   0.009041  0.47375\nGenderFemale                         -0.233847   0.322696 -0.72467\nGenderOther                           0.085757   1.309013  0.06551\nMusic_listeningSomewhat rarely        6.098714   0.491400 12.41090\nMusic_listeningModerately frequently  4.326642   0.353763 12.23033\nMusic_listeningFrequently             5.204477   0.289713 17.96424\nMusic_listeningVery frequently        5.317355   0.289885 18.34300\nPractice                             -0.022536   0.010436 -2.15935\nFloorUpstairs                        -0.347580   0.439544 -0.79077\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                     4.6819  0.5440   \nA small amount of the time|A moderate amount of the time  5.5990  0.5418   \nA moderate amount of the time|Most of the time            6.4563  0.5877   \nMost of the time|All of the time                         10.7467  0.5877   \n                                                         t value\nNot at all|A small amount of the time                     8.6057\nA small amount of the time|A moderate amount of the time 10.3332\nA moderate amount of the time|Most of the time           10.9860\nMost of the time|All of the time                         18.2863\n\nResidual Deviance: 123.1377 \nAIC: 149.1377 \n\nStepwise Model Summary for Media :\nCall:\npolr(formula = Media ~ Music_listening + Practice, data = data1_subset, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n                                       Value Std. Error t value\nMusic_listeningSomewhat rarely        5.3685    0.40054  13.403\nMusic_listeningModerately frequently  3.7819    0.29069  13.010\nMusic_listeningFrequently             4.5789    0.27981  16.364\nMusic_listeningVery frequently        4.5597    0.22695  20.091\nPractice                             -0.0238    0.01015  -2.344\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                     4.1573  0.1847   \nA small amount of the time|A moderate amount of the time  5.0520  0.2031   \nA moderate amount of the time|Most of the time            5.8977  0.2742   \nMost of the time|All of the time                          9.7842 97.4642   \n                                                         t value\nNot at all|A small amount of the time                    22.5103\nA small amount of the time|A moderate amount of the time 24.8776\nA moderate amount of the time|Most of the time           21.5073\nMost of the time|All of the time                          0.1004\n\nResidual Deviance: 125.402 \nAIC: 143.402 \n\nProcessing: Music  | Rows before: 103  | Rows after NA removal: 62 \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nSummary for Music :\nCall:\npolr(formula = formula, data = data1_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error t value\nAge                                  -0.005133   0.008583 -0.5981\nGenderFemale                          0.215051   0.296353  0.7257\nGenderOther                           1.027377   1.405692  0.7309\nMusic_listeningSomewhat rarely        0.468765   1.313360  0.3569\nMusic_listeningModerately frequently  1.310219   1.189800  1.1012\nMusic_listeningFrequently             1.338896   1.155625  1.1586\nMusic_listeningVery frequently        1.577121   1.182344  1.3339\nPractice                              0.022691   0.009039  2.5103\nFloorUpstairs                        -0.443907   0.421261 -1.0538\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -3.7351 13.3417   \nA small amount of the time|A moderate amount of the time -0.1938  1.1175   \nA moderate amount of the time|Most of the time            0.7875  1.1257   \nMost of the time|All of the time                          2.4949  1.1522   \n                                                         t value\nNot at all|A small amount of the time                    -0.2800\nA small amount of the time|A moderate amount of the time -0.1734\nA moderate amount of the time|Most of the time            0.6996\nMost of the time|All of the time                          2.1653\n\nResidual Deviance: 133.9968 \nAIC: 159.9968 \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nStepwise Model Summary for Music :\nCall:\npolr(formula = Music ~ Practice, data = data1_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n           Value Std. Error t value\nPractice 0.02294   0.008149   2.814\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -4.1498  8.5088   \nA small amount of the time|A moderate amount of the time -0.9656  0.2321   \nA moderate amount of the time|Most of the time           -0.0684  0.1960   \nMost of the time|All of the time                          1.5744  0.2709   \n                                                         t value\nNot at all|A small amount of the time                    -0.4877\nA small amount of the time|A moderate amount of the time -4.1606\nA moderate amount of the time|Most of the time           -0.3492\nMost of the time|All of the time                          5.8110\n\nResidual Deviance: 139.9252 \nAIC: 149.9252 \n\nProcessing: Future_plans  | Rows before: 103  | Rows after NA removal: 59 \n\nSummary for Future_plans :\nCall:\npolr(formula = formula, data = data1_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error t value\nAge                                  -0.02421   0.009323 -2.5968\nGenderFemale                         -0.38536   0.307097 -1.2549\nGenderOther                          -1.45797   1.320860 -1.1038\nMusic_listeningSomewhat rarely        0.78185   1.297655  0.6025\nMusic_listeningModerately frequently -0.33765   1.173242 -0.2878\nMusic_listeningFrequently            -0.47585   1.136492 -0.4187\nMusic_listeningVery frequently       -0.18424   1.165770 -0.1580\nPractice                             -0.02825   0.011867 -2.3803\nFloorUpstairs                         0.04446   0.421691  0.1054\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.5347  1.1520   \nA small amount of the time|A moderate amount of the time -1.7188  1.1306   \nA moderate amount of the time|Most of the time           -0.9728  1.1235   \nMost of the time|All of the time                          0.3456  1.1699   \n                                                         t value\nNot at all|A small amount of the time                    -2.2002\nA small amount of the time|A moderate amount of the time -1.5202\nA moderate amount of the time|Most of the time           -0.8658\nMost of the time|All of the time                          0.2954\n\nResidual Deviance: 151.6348 \nAIC: 177.6348 \n\nStepwise Model Summary for Future_plans :\nCall:\npolr(formula = Future_plans ~ Age + Practice, data = data1_subset, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n            Value Std. Error t value\nAge      -0.02103   0.007905  -2.660\nPractice -0.03080   0.011111  -2.772\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.0025  0.4695   \nA small amount of the time|A moderate amount of the time -1.2321  0.4474   \nA moderate amount of the time|Most of the time           -0.5257  0.4342   \nMost of the time|All of the time                          0.6806  0.4802   \n                                                         t value\nNot at all|A small amount of the time                    -4.2656\nA small amount of the time|A moderate amount of the time -2.7541\nA moderate amount of the time|Most of the time           -1.2106\nMost of the time|All of the time                          1.4174\n\nResidual Deviance: 157.3405 \nAIC: 169.3405 \n\nProcessing: Building  | Rows before: 103  | Rows after NA removal: 60 \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nSkipping Building due to error: initial value in 'vmmin' is not finite \n\nProcessing: Everyday  | Rows before: 103  | Rows after NA removal: 60 \n\nSummary for Everyday :\nCall:\npolr(formula = formula, data = data1_subset, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error   t value\nAge                                  -0.01738   0.008716 -1.994425\nGenderFemale                         -0.05866   0.295175 -0.198730\nGenderOther                          -0.01320   1.331294 -0.009913\nMusic_listeningSomewhat rarely       -0.25404   1.309303 -0.194027\nMusic_listeningModerately frequently  0.70097   1.197620  0.585302\nMusic_listeningFrequently             0.70876   1.166898  0.607384\nMusic_listeningVery frequently        0.96287   1.191418  0.808171\nPractice                             -0.02211   0.009701 -2.279305\nFloorUpstairs                        -0.03588   0.404814 -0.088632\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.3740  1.1510   \nA small amount of the time|A moderate amount of the time -0.1590  1.1430   \nA moderate amount of the time|Most of the time            0.7787  1.1538   \nMost of the time|All of the time                          1.9266  1.2148   \n                                                         t value\nNot at all|A small amount of the time                    -1.1937\nA small amount of the time|A moderate amount of the time -0.1391\nA moderate amount of the time|Most of the time            0.6749\nMost of the time|All of the time                          1.5859\n\nResidual Deviance: 150.6295 \nAIC: 176.6295 \n\nStepwise Model Summary for Everyday :\nCall:\npolr(formula = Everyday ~ Age + Practice, data = data1_subset, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n            Value Std. Error t value\nAge      -0.01406   0.007271  -1.933\nPractice -0.01682   0.008798  -1.912\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.7582  0.4329   \nA small amount of the time|A moderate amount of the time -0.5984  0.4019   \nA moderate amount of the time|Most of the time            0.2756  0.4020   \nMost of the time|All of the time                          1.3664  0.5140   \n                                                         t value\nNot at all|A small amount of the time                    -4.0619\nA small amount of the time|A moderate amount of the time -1.4890\nA moderate amount of the time|Most of the time            0.6856\nMost of the time|All of the time                          2.6583\n\nResidual Deviance: 155.7032 \nAIC: 167.7032 \n```\n\n\n:::\n:::\n\n\n\nWe had to filter out a lot of missing data. Here's a version which handels the NAs better.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(Amelia)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'Amelia' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: Rcpp\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'Rcpp' was built under R version 4.4.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n## \n## Amelia II: Multiple Imputation\n## (Version 1.8.3, built: 2024-11-07)\n## Copyright (C) 2005-2025 James Honaker, Gary King and Matthew Blackwell\n## Refer to http://gking.harvard.edu/amelia/ for more information\n## \n```\n\n\n:::\n\n```{.r .cell-code}\ndemographics_outcomes <- c('Age', 'Gender', 'Music_listening', 'Practice', 'Floor', \"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \n                  \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \n                  \"Building\", \"Everyday\")\n\ndem_out <- dplyr::select(data1, all_of(demographics_outcomes))\nmissmap(dem_out)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Unknown or uninitialised column: `arguments`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Unknown or uninitialised column: `arguments`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Unknown or uninitialised column: `imputations`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Modelling_2_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(naniar)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'naniar' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code}\nmcar_test(dem_out)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 4\n  statistic    df p.value missing.patterns\n      <dbl> <dbl>   <dbl>            <int>\n1      173.   168   0.377               18\n```\n\n\n:::\n:::\n\n\n\np \\> 0.05, so there is insufficient evidence to reject the null hypothesis that the data is MCAR.\n\nWe can use imputation to deal with the NAs.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mice)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'mice' was built under R version 4.4.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'mice'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    cbind, rbind\n```\n\n\n:::\n\n```{.r .cell-code}\nimputed_data1 <- mice(data1, m = 5, method = 'pmm', seed = 123, print = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Number of logged events: 363\n```\n\n\n:::\n\n```{.r .cell-code}\ncompleted_data1 <- complete(imputed_data1, 1)\n```\n:::\n\n\n\nLet's rerun the step() function with our imputed models.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_fiction_imp <- polr(Fictional_story ~ Age + Gender + Music_listening + Practice + Floor, \n              data = completed_data1, Hess = TRUE, method = \"probit\")\n\nstepwise_model_imp <- step(model_fiction_imp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStart:  AIC=308.11\nFictional_story ~ Age + Gender + Music_listening + Practice + \n    Floor\n\n                  Df    AIC\n- Music_listening  4 300.73\n- Gender           2 305.58\n- Floor            1 307.06\n- Age              1 307.27\n<none>               308.11\n- Practice         1 311.90\n\nStep:  AIC=300.73\nFictional_story ~ Age + Gender + Practice + Floor\n\n           Df    AIC\n- Gender    2 298.93\n- Age       1 299.76\n- Floor     1 300.12\n<none>        300.73\n- Practice  1 305.92\n\nStep:  AIC=298.93\nFictional_story ~ Age + Practice + Floor\n\n           Df    AIC\n- Floor     1 297.56\n- Age       1 298.68\n<none>        298.93\n- Practice  1 303.39\n\nStep:  AIC=297.56\nFictional_story ~ Age + Practice\n\n           Df    AIC\n<none>        297.56\n- Age       1 297.77\n- Practice  1 301.45\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(stepwise_model_imp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\npolr(formula = Fictional_story ~ Age + Practice, data = completed_data1, \n    Hess = TRUE, method = \"probit\")\n\nCoefficients:\n             Value Std. Error t value\nAge      -0.008101   0.005453  -1.486\nPractice -0.012886   0.005363  -2.403\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.0441  0.3181   \nA small amount of the time|A moderate amount of the time -0.2639  0.3059   \nA moderate amount of the time|Most of the time            0.3406  0.3113   \nMost of the time|All of the time                          1.1620  0.3532   \n                                                         t value\nNot at all|A small amount of the time                    -3.2823\nA small amount of the time|A moderate amount of the time -0.8625\nA moderate amount of the time|Most of the time            1.0942\nMost of the time|All of the time                          3.2904\n\nResidual Deviance: 285.5557 \nAIC: 297.5557 \n```\n\n\n:::\n:::\n\n\n\nWe'll repeat this for all our different models again.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# List to store results\nmodels <- list()\nstepwise_models <- list()\n\n# Loop through selected outcomes\nfor (outcome in outcome_vars) {\n  formula <- as.formula(paste(outcome, \"~ Age + Gender + Music_listening + Practice + Floor\"))\n\n  tryCatch({\n    # Fit proportional odds model\n    model <- polr(formula, data = completed_data1, Hess = TRUE, method = \"probit\", \n                  control = list(maxit = 1000), na.action = na.exclude)\n    \n    # Store model\n    models[[outcome]] <- model\n    \n    # Print summary\n    cat(\"\\nSummary for\", outcome, \":\\n\")\n    print(summary(model))\n    \n    # Perform stepwise regression\n    step_model <- step(model, direction = \"backward\", trace = FALSE)\n    stepwise_models[[outcome]] <- step_model\n    \n    # Print stepwise summary\n    cat(\"\\nStepwise Model Summary for\", outcome, \":\\n\")\n    print(summary(step_model))\n    \n  }, error = function(e) {\n    cat(\"\\nSkipping\", outcome, \"due to error:\", conditionMessage(e), \"\\n\")\n  })\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nSummary for Fictional_story :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error t value\nAge                                  -0.006322   0.005863 -1.0783\nGenderFemale                         -0.181545   0.219532 -0.8270\nGenderOther                           1.046271   1.235934  0.8465\nMusic_listeningSomewhat rarely       -0.070988   0.915966 -0.0775\nMusic_listeningModerately frequently -0.191947   0.765671 -0.2507\nMusic_listeningFrequently            -0.372831   0.753970 -0.4945\nMusic_listeningVery frequently       -0.273486   0.754281 -0.3626\nPractice                             -0.013803   0.005798 -2.3806\nFloorUpstairs                         0.290203   0.299143  0.9701\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.1005  0.8002   \nA small amount of the time|A moderate amount of the time -0.3131  0.7925   \nA moderate amount of the time|Most of the time            0.3091  0.7984   \nMost of the time|All of the time                          1.1633  0.8238   \n                                                         t value\nNot at all|A small amount of the time                    -1.3752\nA small amount of the time|A moderate amount of the time -0.3951\nA moderate amount of the time|Most of the time            0.3872\nMost of the time|All of the time                          1.4121\n\nResidual Deviance: 282.1103 \nAIC: 308.1103 \n\nStepwise Model Summary for Fictional_story :\nCall:\npolr(formula = Fictional_story ~ Age + Practice, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n             Value Std. Error t value\nAge      -0.008101   0.005453  -1.486\nPractice -0.012886   0.005363  -2.403\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.0441  0.3181   \nA small amount of the time|A moderate amount of the time -0.2639  0.3059   \nA moderate amount of the time|Most of the time            0.3406  0.3113   \nMost of the time|All of the time                          1.1620  0.3532   \n                                                         t value\nNot at all|A small amount of the time                    -3.2823\nA small amount of the time|A moderate amount of the time -0.8625\nA moderate amount of the time|Most of the time            1.0942\nMost of the time|All of the time                          3.2904\n\nResidual Deviance: 285.5557 \nAIC: 297.5557 \n\nSummary for Abstract_shapes :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error t value\nAge                                  -0.007667   0.006224 -1.2320\nGenderFemale                          0.216491   0.233121  0.9287\nGenderOther                           0.185053   1.271520  0.1455\nMusic_listeningSomewhat rarely       -0.180084   1.053991 -0.1709\nMusic_listeningModerately frequently -0.428191   0.875952 -0.4888\nMusic_listeningFrequently            -0.112782   0.851098 -0.1325\nMusic_listeningVery frequently        0.060642   0.855276  0.0709\nPractice                              0.012440   0.005644  2.2038\nFloorUpstairs                        -0.400407   0.306389 -1.3069\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.3467  0.8763   \nA small amount of the time|A moderate amount of the time  0.3601  0.8738   \nA moderate amount of the time|Most of the time            1.1083  0.8803   \nMost of the time|All of the time                          1.9951  0.9416   \n                                                         t value\nNot at all|A small amount of the time                    -0.3956\nA small amount of the time|A moderate amount of the time  0.4120\nA moderate amount of the time|Most of the time            1.2590\nMost of the time|All of the time                          2.1189\n\nResidual Deviance: 229.1498 \nAIC: 255.1498 \n\nStepwise Model Summary for Abstract_shapes :\nCall:\npolr(formula = Abstract_shapes ~ Practice, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n            Value Std. Error t value\nPractice 0.008893   0.005053    1.76\n\nIntercepts:\n                                                         Value  Std. Error\nNot at all|A small amount of the time                    0.2921 0.1542    \nA small amount of the time|A moderate amount of the time 0.9673 0.1719    \nA moderate amount of the time|Most of the time           1.6947 0.2259    \nMost of the time|All of the time                         2.5672 0.4023    \n                                                         t value\nNot at all|A small amount of the time                    1.8950 \nA small amount of the time|A moderate amount of the time 5.6260 \nA moderate amount of the time|Most of the time           7.5036 \nMost of the time|All of the time                         6.3819 \n\nResidual Deviance: 235.4735 \nAIC: 245.4735 \n\nSummary for Sensory_sensations :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                          Value Std. Error  t value\nAge                                   0.0052865   0.006689  0.79037\nGenderFemale                          0.1035388   0.245145  0.42236\nGenderOther                           0.9178138   1.295587  0.70842\nMusic_listeningSomewhat rarely        4.2253438   0.537336  7.86350\nMusic_listeningModerately frequently  4.0906229   0.279577 14.63147\nMusic_listeningFrequently             4.2490089   0.243758 17.43124\nMusic_listeningVery frequently        4.4140098   0.230914 19.11539\nPractice                              0.0004939   0.005793  0.08525\nFloorUpstairs                        -0.2161682   0.318442 -0.67883\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                     4.7915  0.4147   \nA small amount of the time|A moderate amount of the time  5.6739  0.4297   \nA moderate amount of the time|Most of the time            6.1500  0.4568   \nMost of the time|All of the time                         12.3833  0.4568   \n                                                         t value\nNot at all|A small amount of the time                    11.5551\nA small amount of the time|A moderate amount of the time 13.2037\nA moderate amount of the time|Most of the time           13.4642\nMost of the time|All of the time                         27.1106\n\nResidual Deviance: 194.4911 \nAIC: 220.4911 \n\nStepwise Model Summary for Sensory_sensations :\nCall:\npolr(formula = Sensory_sensations ~ 1, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nNo coefficients\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                     0.3347  0.1260   \nA small amount of the time|A moderate amount of the time  1.1926  0.1614   \nA moderate amount of the time|Most of the time            1.6591  0.2102   \nMost of the time|All of the time                          9.5744  0.2102   \n                                                         t value\nNot at all|A small amount of the time                     2.6554\nA small amount of the time|A moderate amount of the time  7.3909\nA moderate amount of the time|Most of the time            7.8922\nMost of the time|All of the time                         45.5437\n\nResidual Deviance: 199.3257 \nAIC: 207.3257 \n\nSummary for Life_experiences :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error t value\nAge                                  -0.016872   0.005925 -2.8477\nGenderFemale                          0.163671   0.214375  0.7635\nGenderOther                           0.473320   1.233860  0.3836\nMusic_listeningSomewhat rarely       -1.307688   0.943075 -1.3866\nMusic_listeningModerately frequently -0.577778   0.795791 -0.7260\nMusic_listeningFrequently            -0.573378   0.782782 -0.7325\nMusic_listeningVery frequently       -0.978272   0.784232 -1.2474\nPractice                              0.004672   0.005388  0.8672\nFloorUpstairs                         0.177543   0.289042  0.6142\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.4108  0.8378   \nA small amount of the time|A moderate amount of the time -1.5259  0.8254   \nA moderate amount of the time|Most of the time           -0.5893  0.8153   \nMost of the time|All of the time                          0.8842  0.8485   \n                                                         t value\nNot at all|A small amount of the time                    -2.8776\nA small amount of the time|A moderate amount of the time -1.8486\nA moderate amount of the time|Most of the time           -0.7228\nMost of the time|All of the time                          1.0421\n\nResidual Deviance: 278.3821 \nAIC: 304.3821 \n\nStepwise Model Summary for Life_experiences :\nCall:\npolr(formula = Life_experiences ~ Age, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n       Value Std. Error t value\nAge -0.01557   0.005336  -2.918\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.8480  0.3362   \nA small amount of the time|A moderate amount of the time -0.9886  0.3116   \nA moderate amount of the time|Most of the time           -0.0932  0.3030   \nMost of the time|All of the time                          1.3354  0.3869   \n                                                         t value\nNot at all|A small amount of the time                    -5.4960\nA small amount of the time|A moderate amount of the time -3.1729\nA moderate amount of the time|Most of the time           -0.3076\nMost of the time|All of the time                          3.4516\n\nResidual Deviance: 285.4697 \nAIC: 295.4697 \n\nSummary for Media :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error  t value\nAge                                  -0.002778   0.006504 -0.42708\nGenderFemale                         -0.125710   0.243820 -0.51559\nGenderOther                           0.502464   1.244064  0.40389\nMusic_listeningSomewhat rarely        0.983133   0.986675  0.99641\nMusic_listeningModerately frequently  0.037326   0.866580  0.04307\nMusic_listeningFrequently             0.310699   0.856463  0.36277\nMusic_listeningVery frequently        0.117981   0.850041  0.13879\nPractice                             -0.020631   0.007196 -2.86689\nFloorUpstairs                         0.257716   0.334504  0.77044\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                     0.0754  0.9208   \nA small amount of the time|A moderate amount of the time  0.7897  0.9238   \nA moderate amount of the time|Most of the time            1.6799  0.9448   \nMost of the time|All of the time                         16.3065  0.9448   \n                                                         t value\nNot at all|A small amount of the time                     0.0819\nA small amount of the time|A moderate amount of the time  0.8548\nA moderate amount of the time|Most of the time            1.7780\nMost of the time|All of the time                         17.2587\n\nResidual Deviance: 202.3903 \nAIC: 228.3903 \n\nStepwise Model Summary for Media :\nCall:\npolr(formula = Media ~ Practice, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n            Value Std. Error t value\nPractice -0.02076   0.006583  -3.154\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -0.1133  0.1620   \nA small amount of the time|A moderate amount of the time  0.5593  0.1704   \nA moderate amount of the time|Most of the time            1.4174  0.2309   \nMost of the time|All of the time                          4.7149 24.4306   \n                                                         t value\nNot at all|A small amount of the time                    -0.6995\nA small amount of the time|A moderate amount of the time  3.2823\nA moderate amount of the time|Most of the time            6.1395\nMost of the time|All of the time                          0.1930\n\nResidual Deviance: 208.5777 \nAIC: 218.5777 \n\nSummary for Music :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                         Value Std. Error t value\nAge                                  -0.005259   0.005913 -0.8895\nGenderFemale                          0.339246   0.218848  1.5501\nGenderOther                           1.044393   1.283188  0.8139\nMusic_listeningSomewhat rarely        0.611342   0.938246  0.6516\nMusic_listeningModerately frequently  1.414585   0.803779  1.7599\nMusic_listeningFrequently             1.202661   0.788596  1.5251\nMusic_listeningVery frequently        1.871022   0.795791  2.3511\nPractice                              0.013629   0.005572  2.4461\nFloorUpstairs                        -0.342554   0.295412 -1.1596\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.3247  0.8794   \nA small amount of the time|A moderate amount of the time -0.0242  0.8200   \nA moderate amount of the time|Most of the time            0.9959  0.8265   \nMost of the time|All of the time                          2.4195  0.8401   \n                                                         t value\nNot at all|A small amount of the time                    -1.5064\nA small amount of the time|A moderate amount of the time -0.0295\nA moderate amount of the time|Most of the time            1.2050\nMost of the time|All of the time                          2.8800\n\nResidual Deviance: 243.3166 \nAIC: 269.3166 \n\nStepwise Model Summary for Music :\nCall:\npolr(formula = Music ~ Music_listening + Practice, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n                                       Value Std. Error t value\nMusic_listeningSomewhat rarely       0.63403   0.885024  0.7164\nMusic_listeningModerately frequently 1.22563   0.784539  1.5622\nMusic_listeningFrequently            1.08652   0.779619  1.3937\nMusic_listeningVery frequently       1.65626   0.774241  2.1392\nPractice                             0.01073   0.005128  2.0923\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.0600  0.8088   \nA small amount of the time|A moderate amount of the time  0.1541  0.7502   \nA moderate amount of the time|Most of the time            1.1341  0.7607   \nMost of the time|All of the time                          2.5319  0.7760   \n                                                         t value\nNot at all|A small amount of the time                    -1.3106\nA small amount of the time|A moderate amount of the time  0.2054\nA moderate amount of the time|Most of the time            1.4910\nMost of the time|All of the time                          3.2629\n\nResidual Deviance: 248.3461 \nAIC: 266.3461 \n\nSummary for Future_plans :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error t value\nAge                                  -0.02138   0.006082 -3.5154\nGenderFemale                         -0.11263   0.221314 -0.5089\nGenderOther                          -1.21758   1.237106 -0.9842\nMusic_listeningSomewhat rarely        0.68876   0.926108  0.7437\nMusic_listeningModerately frequently -0.14676   0.772444 -0.1900\nMusic_listeningFrequently            -0.38317   0.761152 -0.5034\nMusic_listeningVery frequently       -0.65003   0.760860 -0.8543\nPractice                             -0.01123   0.005930 -1.8931\nFloorUpstairs                         0.18885   0.298916  0.6318\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -2.1025  0.8179   \nA small amount of the time|A moderate amount of the time -1.3852  0.8053   \nA moderate amount of the time|Most of the time           -0.5805  0.7987   \nMost of the time|All of the time                          0.5796  0.8315   \n                                                         t value\nNot at all|A small amount of the time                    -2.5705\nA small amount of the time|A moderate amount of the time -1.7202\nA moderate amount of the time|Most of the time           -0.7268\nMost of the time|All of the time                          0.6971\n\nResidual Deviance: 265.5248 \nAIC: 291.5248 \n\nStepwise Model Summary for Future_plans :\nCall:\npolr(formula = Future_plans ~ Age + Practice, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n            Value Std. Error t value\nAge      -0.02124   0.005666  -3.749\nPractice -0.01171   0.005464  -2.144\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.7652  0.3372   \nA small amount of the time|A moderate amount of the time -1.0841  0.3202   \nA moderate amount of the time|Most of the time           -0.3173  0.3128   \nMost of the time|All of the time                          0.7695  0.3611   \n                                                         t value\nNot at all|A small amount of the time                    -5.2348\nA small amount of the time|A moderate amount of the time -3.3856\nA moderate amount of the time|Most of the time           -1.0144\nMost of the time|All of the time                          2.1307\n\nResidual Deviance: 273.9062 \nAIC: 285.9062 \n\nSummary for Building :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error    t value\nAge                                  -0.01254  6.115e-03 -2.051e+00\nGenderFemale                         -0.24672  2.269e-01 -1.088e+00\nGenderOther                          -3.96200  3.005e-05 -1.318e+05\nMusic_listeningSomewhat rarely        3.27623  5.541e-01  5.912e+00\nMusic_listeningModerately frequently  4.62775  2.568e-01  1.802e+01\nMusic_listeningFrequently             4.72557  2.324e-01  2.033e+01\nMusic_listeningVery frequently        4.73800  2.306e-01  2.055e+01\nPractice                             -0.01186  5.733e-03 -2.069e+00\nFloorUpstairs                         0.13935  3.102e-01  4.493e-01\n\nIntercepts:\n                                                         Value       \nNot at all|A small amount of the time                          3.4297\nA small amount of the time|A moderate amount of the time       4.4502\nA moderate amount of the time|Most of the time                 5.2787\nMost of the time|All of the time                               6.3001\n                                                         Std. Error  \nNot at all|A small amount of the time                          0.3971\nA small amount of the time|A moderate amount of the time       0.3961\nA moderate amount of the time|Most of the time                 0.4135\nMost of the time|All of the time                               0.5455\n                                                         t value     \nNot at all|A small amount of the time                          8.6360\nA small amount of the time|A moderate amount of the time      11.2345\nA moderate amount of the time|Most of the time                12.7672\nMost of the time|All of the time                              11.5485\n\nResidual Deviance: 239.1597 \nAIC: 265.1597 \n\nStepwise Model Summary for Building :\nCall:\npolr(formula = Building ~ Age + Music_listening + Practice, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error t value\nAge                                  -0.01263   0.005771  -2.189\nMusic_listeningSomewhat rarely        2.85400   0.497373   5.738\nMusic_listeningModerately frequently  4.32231   0.244103  17.707\nMusic_listeningFrequently             4.42548   0.226633  19.527\nMusic_listeningVery frequently        4.44513   0.209021  21.266\nPractice                             -0.01103   0.005454  -2.022\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                     3.1642  0.2813   \nA small amount of the time|A moderate amount of the time  4.1797  0.2799   \nA moderate amount of the time|Most of the time            5.0094  0.3036   \nMost of the time|All of the time                          6.0069  0.4620   \n                                                         t value\nNot at all|A small amount of the time                    11.2470\nA small amount of the time|A moderate amount of the time 14.9305\nA moderate amount of the time|Most of the time           16.5024\nMost of the time|All of the time                         13.0032\n\nResidual Deviance: 241.1496 \nAIC: 261.1496 \n\nSummary for Everyday :\nCall:\npolr(formula = formula, data = completed_data1, control = list(maxit = 1000), \n    na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nCoefficients:\n                                        Value Std. Error t value\nAge                                  -0.01287   0.005969 -2.1560\nGenderFemale                          0.06139   0.219207  0.2801\nGenderOther                           0.57822   1.266841  0.4564\nMusic_listeningSomewhat rarely       -0.71124   0.950019 -0.7487\nMusic_listeningModerately frequently  0.35867   0.796934  0.4501\nMusic_listeningFrequently             0.52468   0.786882  0.6668\nMusic_listeningVery frequently        0.27099   0.784964  0.3452\nPractice                             -0.02263   0.006037 -3.7485\nFloorUpstairs                         0.35445   0.297421  1.1918\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.1763  0.8264   \nA small amount of the time|A moderate amount of the time  0.0456  0.8231   \nA moderate amount of the time|Most of the time            1.0385  0.8351   \nMost of the time|All of the time                          1.9054  0.8680   \n                                                         t value\nNot at all|A small amount of the time                    -1.4235\nA small amount of the time|A moderate amount of the time  0.0553\nA moderate amount of the time|Most of the time            1.2436\nMost of the time|All of the time                          2.1953\n\nResidual Deviance: 248.6327 \nAIC: 274.6327 \n\nStepwise Model Summary for Everyday :\nCall:\npolr(formula = Everyday ~ Age + Practice, data = completed_data1, \n    control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, \n    method = \"probit\")\n\nCoefficients:\n            Value Std. Error t value\nAge      -0.01337   0.005533  -2.417\nPractice -0.01831   0.005511  -3.323\n\nIntercepts:\n                                                         Value   Std. Error\nNot at all|A small amount of the time                    -1.7179  0.3377   \nA small amount of the time|A moderate amount of the time -0.5407  0.3142   \nA moderate amount of the time|Most of the time            0.4090  0.3209   \nMost of the time|All of the time                          1.2648  0.3901   \n                                                         t value\nNot at all|A small amount of the time                    -5.0868\nA small amount of the time|A moderate amount of the time -1.7211\nA moderate amount of the time|Most of the time            1.2747\nMost of the time|All of the time                          3.2423\n\nResidual Deviance: 254.2002 \nAIC: 266.2002 \n```\n\n\n:::\n:::\n\n\n\nThese outcomes are more likely to be reliable as we haven't removed a ton of data!\n\nLet's also look at the interactions between the demographic variables and check for multicollinearity. The vif() ouputs indicate that multicollinearity shouldn't be a problem.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(conflicted)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'conflicted' was built under R version 4.4.3\n```\n\n\n:::\n\n```{.r .cell-code}\nconflict_prefer(\"filter\", \"dplyr\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n[conflicted] Will prefer dplyr::filter over any other package.\n```\n\n\n:::\n\n```{.r .cell-code}\ndemographics <- c('Age', 'Gender', 'Music_listening', 'Practice', 'Floor')\ndemographics_data <- dplyr::select(data1, all_of(demographics))\n\n# Convert categorical variables to numeric\ndemographics_numeric <- demographics_data %>%\n  mutate(\n    Gender = as.numeric(factor(Gender)),\n    Music_listening = as.numeric(factor(Music_listening, ordered = TRUE)),  \n    Floor = as.numeric(factor(Floor))\n  ) \n\n# Compute correlation matrix\ncor_matrix <- cor(demographics_numeric, use = \"pairwise.complete.obs\")\n\n# Plot heatmap\ncorrplot(cor_matrix, method = \"color\", type = \"lower\", \n         tl.col = \"black\", tl.srt = 45, addCoef.col = \"white\", \n         col = colorRampPalette(c(\"blue\", \"white\", \"red\"))(200))\n```\n\n::: {.cell-output-display}\n![](Modelling_2_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Here's another way of visualising the interactions\nggplot(data1, aes(x = Age, y = Practice, color = Floor)) +\n  geom_point(alpha = 0.6) +  \n  geom_smooth(method = \"lm\", se = FALSE, linetype = \"dashed\") +\n  facet_wrap(~ Floor) +\n  labs(title = \"Age vs. Practice by Floor\",\n       x = \"Age\", \n       y = \"Practice (Number of Years)\") +\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 40 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 40 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Modelling_2_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#Checking for collinearity\nmodel1 <- lm(Age ~ Practice + Gender + Music_listening + Floor, data = demographics_numeric)\nmodel2 <- lm(Gender ~ Age + Practice + Music_listening + Floor, data = demographics_numeric)\nmodel3 <- lm(Practice ~ Age + Gender + Music_listening + Floor, data = demographics_numeric)\nmodel4 <- lm(Music_listening ~ Age + Gender + Practice + Floor, data = demographics_numeric)\nmodel5 <- lm(Floor ~ Age + Gender + Practice + Music_listening, data = demographics_numeric)\nvif(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Practice          Gender Music_listening           Floor \n       1.106535        1.012004        1.158101        1.117530 \n```\n\n\n:::\n\n```{.r .cell-code}\nvif(model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Age        Practice Music_listening           Floor \n       1.047850        1.129817        1.155165        1.141710 \n```\n\n\n:::\n\n```{.r .cell-code}\nvif(model3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Age          Gender Music_listening           Floor \n       1.073650        1.058739        1.099942        1.116966 \n```\n\n\n:::\n\n```{.r .cell-code}\nvif(model4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     Age   Gender Practice    Floor \n1.095453 1.055297 1.072307 1.073801 \n```\n\n\n:::\n\n```{.r .cell-code}\nvif(model5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Age          Gender        Practice Music_listening \n       1.070139        1.055894        1.102360        1.087070 \n```\n\n\n:::\n:::\n\n\n\nIn the post on 'Ordinal regression: final models', we'll use the step() output to rerun some model visualisations.\n",
    "supporting": [
      "Modelling_2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}