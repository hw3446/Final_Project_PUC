{
  "hash": "c81bcee3b568fbdb3b897cf3514b703d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Ordinal regression: final models\"\nformat: html\nauthor: \"Hannah Wilkie\"\nexecute:\n  warning: false\n---\n\n\n\nIn the previous post, the step() function output the following models:\n\n-   Fictional story: polr(formula = Fictional_story \\~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\n-   Abstract shapes: polr(formula = Abstract_shapes \\~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\n-   Sensory sensations: polr(formula = Sensory_sensations \\~ 1, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\n-   Life experiences: polr(formula = Life_experiences \\~ Age + Gender, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\n-   Media: polr(formula = Media \\~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\n-   Music: polr(formula = Music \\~ Music_listening + Practice, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\n-   Future plans: polr(formula = Future_plans \\~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\n-   Building: polr(formula = Building \\~ Age + Gender + Music_listening + Floor, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\n-   Everyday: polr(formula = Everyday \\~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nLet's run these models now, plot them, and have a closer look at the results.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(broom)\nlibrary(performance)\nlibrary(ordinal)\nlibrary(car)\nlibrary(ggeffects)\nlibrary(gofcat) \nlibrary(brms)\nlibrary(emmeans)\nlibrary(knitr)\nlibrary(MASS)\nlibrary(patchwork)\nlibrary(grid)\nlibrary(gridExtra)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 <- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data.csv\")\n\ndata2 <- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data2.csv\")\n```\n:::\n\n\n\nFirst some data tidying and treatment of N/As (as in last post).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\noutcome_vars <- c(\"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \n                  \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \n                  \"Building\", \"Everyday\")\n\n# Converting outcome variables to factors with consistent levels for each thought type\ndata1[outcome_vars] <- lapply(data1[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\ndata2[outcome_vars] <- lapply(data2[outcome_vars], factor, \n                             levels = c(\"Not at all\", \"A small amount of the time\", \n                                        \"A moderate amount of the time\", \"Most of the time\", \n                                        \"All of the time\"))\n\n#Remaking the floor variable\ndata1 <- data1 %>%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %>% relocate(Floor, .after = Location)\n\ndata2 <- data2 %>%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %>% relocate(Floor, .after = Location)\n\n#Making sure demographic variables are classed in the right way.\ndata1$Age <- as.numeric(data1$Age)\ndata2$Age <- as.numeric(data2$Age)\ndata1$Practice <- as.numeric(as.character(data1$Practice))\ndata2$Practice <- as.numeric(as.character(data2$Practice))\ndata1$Gender <- factor(data1$Gender,  levels = c('Male', 'Female', 'Other'))\ndata2$Gender <- factor(data2$Gender,  levels = c('Male', 'Female', 'Other'))\ndata1$Music_listening <- factor(data1$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata2$Music_listening <- factor(data2$Music_listening, levels = c('Very rarely', 'Somewhat rarely', 'Moderately frequently', 'Frequently', 'Very frequently'))\ndata1$Floor <- factor(data1$Floor, levels = c('Downstairs', 'Upstairs'))\ndata2$Floor <- factor(data2$Floor, levels = c('Downstairs', 'Upstairs'))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mice)\nimputed_data1 <- mice(data1, m = 5, method = 'pmm', seed = 123, print = FALSE)\ncompleted_data1 <- complete(imputed_data1, 1)\n```\n:::\n\n\n\nRunning the models:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsenses <- polr(formula = Sensory_sensations ~ 1, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\n\nmusic <- polr(formula = Music ~ Music_listening + Practice, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\n\nbuilding <- polr(formula = Building ~ Age + Gender + Music_listening + Floor, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\nlife <- polr(formula = Life_experiences ~ Age + Gender, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n```\n:::\n\n\n\nMany of the models select age as the strongest predictor. Let's plot them using a loop.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\noutcome_age <- c(\"Fictional_story\", \"Abstract_shapes\",\n                  \"Media\", \"Future_plans\", \n                   \"Everyday\")\n\nplot_list <- list()\nfor (outcome in outcome_age) {\nmodel <- polr(as.formula(paste(outcome, \"~ Age\")), data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\npredicted_probs <- ggemmeans(model, terms = c(\"Age\"))\n  \nplot <- ggplot(predicted_probs, aes(x = x, y = predicted, fill = response.level)) +\n    geom_area() + \n    labs(x = \"\\nAge (years)\", y = \"Predicted Probability\\n\", \n         title = paste(outcome, \"by Age\")) +\n    scale_fill_manual(\n      name = NULL,\n      values = setNames(c(\"#deebf7\", \"#9ecae1\", \"#3182bd\", \"#08519c\", \"#08306b\"), \n                      levels(completed_data1[[outcome]])),\n      labels = c(\"Not at all\", \"A small amount of the time\", \"A moderate amount of the time\", \n                 \"Most of the time\", \"All of the time\"),\n      breaks = c(\"Not at all\", \"A small amount of the time\", \"A moderate amount of the time\", \n                 \"Most of the time\", \"All of the time\")\n    ) + \n    theme_minimal()\n  \n\n  plot_list[[outcome]] <- plot\n}\n\ntitle_grob <- textGrob(\"Types of Thoughts by Age, First Half\", gp = gpar(fontsize = 16, fontface = \"bold\"))\n\nAge_thoughts_models <- grid.arrange(\n  grobs = plot_list, \n  ncol = 3, \n  top = title_grob  \n)\n```\n\n::: {.cell-output-display}\n![](Modelling_3_files/figure-html/unnamed-chunk-6-1.png){width=1728}\n:::\n:::\n\n\n\nLet's now tackle the plots with multiple predictors.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresponse_levels <- c(\"Not at all\", \"A small amount of the time\", \"A moderate amount of the time\",\n                     \"Most of the time\", \"All of the time\")\n\nfill_colors <- c(\"#deebf7\", \"#9ecae1\", \"#3182bd\", \"#08519c\", \"#08306b\")\nnames(fill_colors) <- response_levels\n\nmusic <- polr(formula = Music ~ Music_listening + Practice, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\npred_music <- ggemmeans(music, terms = c(\"Practice\", \"Music_listening\"))\n\nggplot(pred_music, aes(x = x, y = predicted, fill = response.level)) +\n     geom_area(alpha = 1) +\n     facet_wrap(~ group, scales = \"free_y\") +\n     labs(x = \"\\nPractice (years)\", y = \"Predicted Probability\\n\", title = \"Music by Practice, Faceted by Classical Music listening\") +\n     scale_fill_manual(name = NULL, values = fill_colors) +\n     theme_minimal() +\n     theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](Modelling_3_files/figure-html/unnamed-chunk-7-1.png){width=960}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlife <- polr(formula = Life_experiences ~ Age + Gender, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\npred_life <- ggemmeans(life, terms = c(\"Age\", \"Gender\"))\n\nggplot(pred_life, aes(x = x, y = predicted, fill = response.level)) +\n     geom_area(alpha = 1) +\n     facet_wrap(~ group, scales = \"free_y\") +  # Facet by Practice\n     labs(x = \"\\nAge (years)\", y = \"Predicted Probability\\n\", title = \"Life Experiences by Age, Faceted by Gender\") +\n     scale_fill_manual(name = NULL, values = fill_colors) +\n     theme_minimal() +\n     theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](Modelling_3_files/figure-html/unnamed-chunk-8-1.png){width=864}\n:::\n:::\n\n\n\nThis plot shows probability of thinking about the building or space by age, faceted by floor and holding Gender + Music listening constant.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbuilding <- polr(formula = Building ~ Age + Gender + Music_listening + Floor, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n\npred_building <- ggemmeans(building, terms = c(\"Age\", \"Floor\"))\n\nggplot(pred_building, aes(x = x, y = predicted, fill = response.level)) +\n     geom_area(alpha = 1) +\n     facet_wrap(~ group, scales = \"free_y\") +\n     labs(x = \"\\nAge (years)\", y = \"Predicted Probability\\n\", title = \"Building by Age, Faceted by Floor\") +\n     scale_fill_manual(name = NULL, values = fill_colors) +\n     theme_minimal() +\n     theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](Modelling_3_files/figure-html/unnamed-chunk-9-1.png){width=768}\n:::\n:::\n\n\n\nLet's do a brant test:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\nlibrary(brant)\n\nmodels <- list(\n  fiction = polr(Fictional_story ~ Age, data = completed_data1, method = \"logistic\", Hess = TRUE),\n  abstract = polr(Abstract_shapes ~ Age, data = completed_data1, method = \"logistic\", Hess = TRUE),\nsense = polr(formula = Sensory_sensations ~ 1, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\nlife = polr(formula = Life_experiences ~ Age + Gender, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\nmedia = polr(formula = Media ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\nmusic = polr(formula = Music ~ Music_listening + Practice, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\nfuture = polr(formula = Future_plans ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\nbuilding = polr(formula = Building ~ Age + Gender + Music_listening + Floor, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\neveryday = polr(formula = Everyday ~ Age, data = completed_data1, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n)\n\nlapply(models, function(model) {\n  tryCatch({\n    brant.test(model)\n  }, error = function(e) {\n    message(\"Error in model: \", conditionMessage(e))\n    return(NULL)\n  })\n})\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$fiction\n\nBrant Test:\n           chi-sq   df   pr(>chi)  \nOmnibus      6.66    3      0.083 .\nAge          6.66    3      0.083 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nH0: Proportional odds assumption holds\n\n\n$abstract\n\nBrant Test:\n           chi-sq   df   pr(>chi)\nOmnibus      2.16    3       0.54\nAge          2.16    3       0.54\n\nH0: Proportional odds assumption holds\n\n\n$sense\nNULL\n\n$life\n\nBrant Test:\n                chi-sq   df   pr(>chi)\nOmnibus          5.620    9       0.78\nAge              0.628    3       0.89\nGenderFemale     4.736    3       0.19\nGenderOther      0.000    3       1.00\n\nH0: Proportional odds assumption holds\n\n\n$media\n\nBrant Test:\n           chi-sq   df   pr(>chi)\nOmnibus      3.12    2       0.21\nAge          3.12    2       0.21\n\nH0: Proportional odds assumption holds\n\n\n$music\n\nBrant Test:\n                                        chi-sq   df   pr(>chi)\nOmnibus                                  10.45   15       0.79\nMusic_listeningSomewhat rarely            0.00    3       1.00\nMusic_listeningModerately frequently      0.00    3       1.00\nMusic_listeningFrequently                 0.00    3       1.00\nMusic_listeningVery frequently            0.00    3       1.00\nPractice                                  1.49    3       0.69\n\nH0: Proportional odds assumption holds\n\n\n$future\n\nBrant Test:\n           chi-sq   df   pr(>chi)\nOmnibus      0.68    3       0.88\nAge          0.68    3       0.88\n\nH0: Proportional odds assumption holds\n\n\n$building\n\nBrant Test:\n                                        chi-sq   df   pr(>chi)\nOmnibus                                 13.502   24       0.96\nAge                                      4.631    3       0.20\nGenderFemale                             0.957    3       0.81\nGenderOther                              0.000    3       1.00\nMusic_listeningSomewhat rarely           0.000    3       1.00\nMusic_listeningModerately frequently     0.000    3       1.00\nMusic_listeningFrequently                0.000    3       1.00\nMusic_listeningVery frequently           0.000    3       1.00\nFloorUpstairs                            2.299    3       0.51\n\nH0: Proportional odds assumption holds\n\n\n$everyday\n\nBrant Test:\n           chi-sq   df   pr(>chi)\nOmnibus      4.66    3        0.2\nAge          4.66    3        0.2\n\nH0: Proportional odds assumption holds\n```\n\n\n:::\n:::\n\n\n\nAnd a summary of the latent coefficients with p values:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tibble)\nlibrary(dplyr)\n\nall_results <- tibble()\n\nfor (model_name in names(models)) {\n  model <- models[[model_name]]\n  \n  model_summary <- summary(model)\n  \n  coef_table <- model_summary$coefficients\n  \n  # Calculate t-values and p-values\n  t_values <- coef_table[, \"Value\"] / coef_table[, \"Std. Error\"]\n  p_values <- 2 * (1 - pnorm(abs(t_values)))\n  \n  model_results <- tibble(\n    Model = model_name, \n    Term = rownames(coef_table),\n    Estimate = coef_table[, \"Value\"],\n    `Std. Error` = coef_table[, \"Std. Error\"],\n    `t value` = t_values,\n    `p value` = p_values\n  )\n  \n \n  all_results <- bind_rows(all_results, model_results)\n}\n\n# Print the combined data frame with results for all models\nlibrary(DT)\ndatatable(all_results)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-ddb308c366a60a6cd4e2\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ddb308c366a60a6cd4e2\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\"],[\"fiction\",\"fiction\",\"fiction\",\"fiction\",\"fiction\",\"abstract\",\"abstract\",\"abstract\",\"abstract\",\"abstract\",\"sense\",\"sense\",\"sense\",\"sense\",\"life\",\"life\",\"life\",\"life\",\"life\",\"life\",\"life\",\"media\",\"media\",\"media\",\"media\",\"media\",\"music\",\"music\",\"music\",\"music\",\"music\",\"music\",\"music\",\"music\",\"music\",\"future\",\"future\",\"future\",\"future\",\"future\",\"building\",\"building\",\"building\",\"building\",\"building\",\"building\",\"building\",\"building\",\"building\",\"building\",\"building\",\"building\",\"everyday\",\"everyday\",\"everyday\",\"everyday\",\"everyday\"],[\"Age\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"Age\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"Age\",\"GenderFemale\",\"GenderOther\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"Age\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"Music_listeningSomewhat rarely\",\"Music_listeningModerately frequently\",\"Music_listeningFrequently\",\"Music_listeningVery frequently\",\"Practice\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"Age\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"Age\",\"GenderFemale\",\"GenderOther\",\"Music_listeningSomewhat rarely\",\"Music_listeningModerately frequently\",\"Music_listeningFrequently\",\"Music_listeningVery frequently\",\"FloorUpstairs\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"Age\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\"],[-0.01811528624174612,-1.461227177040758,-0.482835860421579,0.4619429872681508,2.502114891295919,-0.01305192933913296,-0.5211954569346453,0.5788294725343819,1.942981734991598,4.401296786634478,0.4361490473710766,1.183306464654216,1.805454216322068,5.282388111325979,-0.01837349904916586,0.3502900174853101,-0.1250040540675769,-1.666001419226791,-0.894432219493035,0.05645113168144666,1.260902252257001,-0.01192168847173452,-0.3201012768421753,0.2227315121805274,1.017844353464304,4.038074044764183,1.582661477927999,1.199591671729223,1.297896505237242,1.91543634662053,0.009942760842703822,-0.246636841619315,0.4115946678134779,1.244270185293238,2.524725320540803,-0.0279048021644202,-1.946709076337736,-1.207119768761814,-0.3563653242747085,0.570320996587904,-0.01506054822892251,-0.3200150111431143,-4.417990770113136,3.484544547214093,3.861344123794025,4.057561190585141,4.208952418201689,0.3217204621390313,3.099099545191896,4.225374007175401,5.103500919757143,5.677390449272761,-0.0152728472672368,-1.307291719718367,-0.2214758204205927,0.6074852776403918,1.210245408999496],[0.007011901783910202,0.4337838958503243,0.4175737118497329,0.4268761627614006,0.5883180018676927,0.00737035493114928,0.445947997972112,0.4459352267685537,0.5061935679778998,1.079451307019325,0.0998163115913724,0.1254362153273094,0.1820742486413904,58.33454184065337,0.004338744480443846,0.1666034294801987,1.061699990639323,0.2969046076067132,0.2869219651850406,0.2809961058123776,0.3245460791687459,0.004677842248691755,0.2811050880355416,0.2796723523910926,0.3034649284033919,14.82456296198974,0.8111351335277188,0.7590795098311547,0.7531998021789919,0.7524807805071537,0.003970098419710085,0.7563272918203263,0.7469206351035935,0.7538892379302443,0.7650621034913268,0.004540111467538758,0.2897098446560106,0.2762983331339965,0.2668706686330334,0.2977478993978969,0.004687031858617135,0.1784390946364234,1.410244903162668e-05,0.3274930269429046,0.1926619787384653,0.1647943764987027,0.1596559702025503,0.2020685337892409,0.2958640705719288,0.2990138131749301,0.3218106345596517,0.383942160228289,0.004303172354047627,0.2740865742748937,0.2641586901908383,0.2717881992181523,0.3071702616343764],[-2.583505416934704,-3.368560223233713,-1.156288929881992,1.082147534966366,4.25299733027483,-1.770868494266359,-1.168735949717705,1.298012441692125,3.838416483151416,4.077346294375912,4.369516769529431,9.433531309650348,9.916032771213311,0.09055334874756281,-4.234750198353759,2.102537856382741,-0.1177395263913522,-5.611234640836613,-3.117336168097836,0.2008964911390599,3.885125512797835,-2.548544358260187,-1.138724592568396,0.7964016116582757,3.35407573725059,0.2723907649161615,1.951168692502351,1.580324137580862,1.723176906688576,2.545495375083962,2.504411677388564,-0.3260980322760933,0.5510554247258038,1.650468162550382,3.300026637078652,-6.146281289333118,-6.719513030871205,-4.368899931714019,-1.33534841464626,1.915449270141627,-3.213237862088264,-1.793413107117346,-313278.2653711555,10.64005722424616,20.04206615689191,24.62196390916946,26.36263719334723,1.592135381526489,10.47474111743643,14.13103281855229,15.85870810870032,14.78709825953219,-3.549206494801664,-4.769630629215811,-0.83841958884862,2.235142215106957,3.939982349072733],[0.009780193126321945,0.0007556188747979142,0.2475629948555838,0.2791869767122064,2.109280922479861e-05,0.07658257258095524,0.2425100331221905,0.1942830596821423,0.0001238303181043676,4.55526235481063e-05,1.245217779932695e-05,0,0,0.9278475018719974,2.288059087640626e-05,0.03550618710949549,0.906274047050925,2.008881549997454e-08,0.001824933466267442,0.8407795114475731,0.0001022770353331648,0.01081735290022312,0.2548180420610009,0.4257986417851023,0.000796305638030681,0.7853215728694511,0.051036981906178,0.114032654863794,0.08485653853021935,0.0109122809374238,0.01226552248709711,0.7443501857456565,0.5815956809289462,0.09884721982863165,0.0009667565203921313,7.932057233261958e-10,1.823319273341895e-11,1.248739658188391e-05,0.1817623397922921,0.0554352328431611,0.001312475448356665,0.07290689331102351,0,0,0,0,0,0.1113542886429164,0,0,0,0,0.0003863939472550371,1.845640274833471e-06,0.401795091562003,0.02540801367752699,8.148760448412062e-05]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Model<\\/th>\\n      <th>Term<\\/th>\\n      <th>Estimate<\\/th>\\n      <th>Std. Error<\\/th>\\n      <th>t value<\\/th>\\n      <th>p value<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4,5,6]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Model\",\"targets\":1},{\"name\":\"Term\",\"targets\":2},{\"name\":\"Estimate\",\"targets\":3},{\"name\":\"Std. Error\",\"targets\":4},{\"name\":\"t value\",\"targets\":5},{\"name\":\"p value\",\"targets\":6}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nSECOND HALF\n\nI won't plot the models for the second half for the sake of space, but I'll grab some descriptive statistics for comparison.\n\nThese were the models.\n\nModels that match with the first half:\n\n-   polr(formula = Fictional_story \\~ Age, data = completed_data2, control = list(maxit = 1000), Hess = TRUE, method = \"logistic\")\n\n-   polr(formula = Sensory_sensations \\~ 1, data = completed_data2, control = list(maxit = 1000), Hess = TRUE, method = \"logistic\")\n\n-   polr(formula = Media \\~ Age, data = completed_data2, control = list(maxit = 1000), Hess = TRUE, method = \"logistic\")\n\n-   polr(formula = Future_plans \\~ Age, data = completed_data2, control = list(maxit = 1000), Hess = TRUE, method = \"logistic\")\n\n-   polr(formula = Everyday \\~ Age, data = completed_data2, control = list(maxit = 1000), Hess = TRUE, method = \"logistic\")\n\nModels that don't match the first half:\n\n-   polr(formula = Abstract_shapes \\~ 1, data = completed_data2, control = list(maxit = 1000), Hess = TRUE, method = \"logistic\")\n\n-   polr(formula = Life_experiences \\~ Age, data = completed_data2, control = list(maxit = 1000), Hess = TRUE, method = \"logistic\")\n\n-   polr(formula = Music \\~ Age + Gender + Practice, data = completed_data2, control = list(maxit = 1000), Hess = TRUE, method = \"logistic\")\n\n-   polr(formula = Building \\~ Floor, data = completed_data2, control = list(maxit = 1000), Hess = TRUE, method = \"logistic\")\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mice)\nlibrary(MASS)\n\n#Impute data for second half\nimputed_data2 <- mice(data2, m = 5, method = 'pmm', seed = 123, print = FALSE)\ncompleted_data2 <- complete(imputed_data2, 1)\n\n#List models\nmodels2 <- list(\n  fiction = polr(Fictional_story ~ Age, data = completed_data2, method = \"logistic\", Hess = TRUE),\n  abstract = polr(Abstract_shapes ~ 1, data = completed_data2, method = \"logistic\", Hess = TRUE),\nsense = polr(formula = Sensory_sensations ~ 1, data = completed_data2, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\nlife = polr(formula = Life_experiences ~ Age, data = completed_data2, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\nmedia = polr(formula = Media ~ Age, data = completed_data2, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\nmusic = polr(formula = Music ~ Age + Gender + Practice, data = completed_data2, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\nfuture = polr(formula = Future_plans ~ Age, data = completed_data2, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\nbuilding = polr(formula = Building ~ Floor, data = completed_data2, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\"),\neveryday = polr(formula = Everyday ~ Age, data = completed_data2, control = list(maxit = 1000), na.action = na.exclude, Hess = TRUE, method = \"probit\")\n)\n\n# Loop through each model\nall_results <- tibble()\n\nfor (model_name in names(models2)) {\n  model <- models2[[model_name]]\n  \n  model_summary <- summary(model)\n  \n  coef_table <- model_summary$coefficients\n  \n  t_values <- coef_table[, \"Value\"] / coef_table[, \"Std. Error\"]\n  p_values <- 2 * (1 - pnorm(abs(t_values)))\n  \n  model_results <- tibble(\n    Model = model_name,  \n    Term = rownames(coef_table),  \n    Estimate = coef_table[, \"Value\"],\n    `Std. Error` = coef_table[, \"Std. Error\"],\n    `t value` = t_values,\n    `p value` = p_values\n  )\n  \n  all_results <- bind_rows(all_results, model_results)\n}\n\n# Print the combined data frame with results for all models\ndatatable(all_results)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-48eeb1923e1d881d9778\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-48eeb1923e1d881d9778\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\"],[\"fiction\",\"fiction\",\"fiction\",\"fiction\",\"fiction\",\"abstract\",\"abstract\",\"abstract\",\"abstract\",\"sense\",\"sense\",\"sense\",\"sense\",\"life\",\"life\",\"life\",\"life\",\"life\",\"media\",\"media\",\"media\",\"media\",\"media\",\"music\",\"music\",\"music\",\"music\",\"music\",\"music\",\"music\",\"music\",\"future\",\"future\",\"future\",\"future\",\"future\",\"building\",\"building\",\"building\",\"building\",\"building\",\"everyday\",\"everyday\",\"everyday\",\"everyday\",\"everyday\"],[\"Age\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"Age\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"Age\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"Age\",\"GenderFemale\",\"GenderOther\",\"Practice\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"Age\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"FloorUpstairs\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\",\"Age\",\"Not at all|A small amount of the time\",\"A small amount of the time|A moderate amount of the time\",\"A moderate amount of the time|Most of the time\",\"Most of the time|All of the time\"],[-0.02028818458177546,-1.009806005832049,-0.1454925309722396,0.8795280098457704,3.250741574487641,0.7793244851704439,1.828937979620414,2.813409802999752,5.062585878248148,0.6114818453379464,1.436216551649153,1.859963262561345,9.809295497041154,-0.01387743513189252,-1.351248332581082,-0.5610508394480179,0.09792258166731704,1.027819546533091,-0.01070324424349916,0.03893070041569342,0.6069372503148733,1.176309871918545,1.483811041328136,-0.009882044871193291,0.5372124118701129,-1.489373020804625,0.01431535384066022,-1.826228103708809,-1.182422919293576,-0.3688074374595905,0.5401960809160222,-0.0279323827582776,-1.668080266952445,-0.9585934866939368,-0.3462497985229435,0.479582768812793,0.3047124273031878,0.4531323577061755,1.194408915803463,1.611634894218031,2.297790370493589,-0.01877930551745967,-1.165281912788172,-0.1368907473950567,0.8832183339239585,0.9866749238579194],[0.007801921601184597,0.4749350875050898,0.4661918205139309,0.4856158763364098,0.8239432558401021,0.1708048810024578,0.2296819604135744,0.3431875897686438,1.003156684751515,0.1064513363918274,0.1472828454965949,0.1956322977601967,0.1956322977601967,0.004396899812450604,0.2840131187556098,0.2750165640455018,0.2741424870891926,0.3010015901977542,0.005277050625830856,0.3164442601656542,0.3221311026424203,0.3470710818059696,0.3748547377751009,0.004595889862114805,0.174137217619717,1.049719554619505,0.003879050213979556,0.3432328673731863,0.3144942338074703,0.3019364969330851,0.3049184360842305,0.00476958373468366,0.2979913274297142,0.2846286515430034,0.2855855044991273,0.3149896256001227,0.2021941620634805,0.1713913827672707,0.1867213001851075,0.2054131913718606,0.2767716684839699,0.004643251388452084,0.2923044373057045,0.2820593746544624,0.3129248749465883,0.3228255686190671],[-2.600408670947812,-2.126197942410871,-0.3120872665930695,1.811159916107187,3.945346419727833,4.5626593373478,7.96291522558914,8.197877449171115,5.046655178799079,5.744238316437818,9.751417735084139,9.507444751486087,50.14149304255093,-3.156186341248008,-4.757696892670008,-2.040061991884938,0.3571959337899265,3.414664839005756,-2.028262566045397,0.1230254591924459,1.884131166895114,3.389247717780655,3.95836277843277,-2.150191838288756,3.084994805896601,-1.418829452352617,3.690427566281479,-5.320667911803471,-3.759760250540686,-1.22147352574381,1.771608459800702,-5.856356510770054,-5.597747697358363,-3.367874180962793,-1.21242077440244,1.522535124447623,1.50702880930618,2.643845626249926,6.396746994688754,7.845819849517257,8.302115541955022,-4.044430065570952,-3.986535146469468,-0.4853259976299496,2.822461250722593,3.056371674891068],[0.009311280013983181,0.03348678136632821,0.7549742033838711,0.0701161009956186,7.968469222907615e-05,5.050973398867953e-06,1.77635683940025e-15,2.220446049250313e-16,4.496117369523489e-07,9.23356680004872e-09,0,0,0,0.001598467049761743,1.95814228654001e-06,0.04134415171992822,0.7209451297510725,0.0006386053910552025,0.04253345735154168,0.9020869375838332,0.05954723536928674,0.0007008466597013818,7.54652765500019e-05,0.03154004348660977,0.002035557079591799,0.1559487438501119,0.0002238774328160442,1.033869754252237e-07,0.0001700762688265911,0.2219067834428947,0.07645957441617757,4.731320002449024e-09,2.171544677409543e-08,0.0007575015703142896,0.2253513526012587,0.1278750513525979,0.1318032728671916,0.008197003132426106,1.587219244925109e-10,4.218847493575595e-15,0,5.245056156466532e-05,6.704520010458737e-05,0.6274451168315196,0.004765658068257128,0.002240333556093654]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Model<\\/th>\\n      <th>Term<\\/th>\\n      <th>Estimate<\\/th>\\n      <th>Std. Error<\\/th>\\n      <th>t value<\\/th>\\n      <th>p value<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[3,4,5,6]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Model\",\"targets\":1},{\"name\":\"Term\",\"targets\":2},{\"name\":\"Estimate\",\"targets\":3},{\"name\":\"Std. Error\",\"targets\":4},{\"name\":\"t value\",\"targets\":5},{\"name\":\"p value\",\"targets\":6}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n",
    "supporting": [
      "Modelling_3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}