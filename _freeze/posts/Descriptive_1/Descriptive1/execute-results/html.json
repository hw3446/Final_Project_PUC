{
  "hash": "6c6d540d41f8903b273bdb80f2331e31",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Some descriptive visualisations\"\nauthor: \"Hannah Wilkie\"\nexecute:\n  warning: false\n---\n\n\n\nIn this section we'll look at the overall distribution of different thought types and movements in the datasets.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(broom)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(knitr)\nlibrary(skimr)\n```\n:::\n\n\n\nHere are the dataframes that we tidied up in the dataset overview page.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data.csv\")\n\ndata2 <- read_csv(\"https://raw.githubusercontent.com/hw3446/Final_Project_PUC/main/posts/Dataset_overview/working_data/data2.csv\")\n```\n:::\n\n\n\nWe'll start by visualising the counts for each type of thought in each half of the concert. Here we're creating a dataframe showing thought types in a long format with counts for each.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nthought_types <- c(\"Fictional_story\", \"Abstract_shapes\", \"Sensory_sensations\", \"Life_experiences\", \"Media\", \"Music\", \"Future_plans\", \"Building\", \"Everyday\")\n\n#First half of concert\nthoughts_long1 <- data %>%\n  pivot_longer(cols = thought_types,\n               names_to = \"Category\", \n               values_to = \"Response\") %>%\n  count(Category, Response) %>% \n  mutate(Response = factor(Response, \n                           levels = c(\"Not at all\", \n                                      \"A small amount of the time\", \n                                      \"A moderate amount of the time\", \n                                      \"Most of the time\", \n                                      \"All of the time\"))) %>% \n  mutate(Category = factor(Category, levels = rev(c(\"Fictional_story\", \n                                                    \"Abstract_shapes\", \n                                                    \"Sensory_sensations\", \n                                                    \"Life_experiences\", \n                                                    \"Media\", \n                                                    \"Music\", \n                                                    \"Future_plans\", \n                                                    \"Building\", \n                                                    \"Everyday\")))) %>% filter(!is.na(Response))\n\n#Second half of concert\nthoughts_long2 <- data2 %>%\n  pivot_longer(cols = thought_types,\n               names_to = \"Category\", \n               values_to = \"Response\") %>%\n  count(Category, Response) %>% \n  mutate(Response = factor(Response, \n                           levels = c(\"Not at all\", \n                                      \"A small amount of the time\", \n                                      \"A moderate amount of the time\", \n                                      \"Most of the time\", \n                                      \"All of the time\"))) %>% \n  mutate(Category = factor(Category, \n                           levels = rev(c(\"Fictional_story\", \n                                          \"Abstract_shapes\", \n                                          \"Sensory_sensations\", \n                                          \"Life_experiences\", \n                                          \"Media\", \n                                          \"Music\", \n                                          \"Future_plans\", \n                                          \"Building\", \n                                          \"Everyday\")))) %>% \n  filter(!is.na(Response))\n```\n:::\n\n\n\nThese dataframes are used for the first plots, which show the counts for each type of thought during each half.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#First half\nggplot(thoughts_long1, aes(x = Response, y = Category, fill = n)) +\n  geom_tile(color = \"white\") +  # Add white borders to tiles\n  scale_fill_gradient(low = \"lightblue\", high = \"darkblue\") + \n  labs(title = \"Counts for Thought Types, First Half\", x = NULL, y = NULL, fill = \"Count\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Descriptive1_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Second half\nggplot(thoughts_long2, aes(x = Response, y = Category, fill = n)) +\n  geom_tile(color = \"white\") +\n  scale_fill_gradient(low = \"lightblue\", high = \"darkblue\") + \n  labs(title = \"Counts for Thought Types, Second Half\", x = NULL, y = NULL, fill = \"Count\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Descriptive1_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n\n\n\nThen we examine the counts for the movements people select as invoking the most vivid memory or story.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# First half of concert, collecting movement names in usable format:\nmems <- data$Movement_mem %>% na.omit() %>% toupper()\nstories <- data$Movement_story %>% na.omit() %>% toupper()\n\nmovements_mem <- unlist(strsplit(mems, \"[; ,]+\")) %>% trimws()\nmovements_story <- unlist(strsplit(stories, \"[; ,]+\")) %>% trimws()\n\nmovements_mem <- table(movements_mem)\nmovements_story <- table(movements_story)\n\n\n# Second half of concert, collecting movement names in usable format:\nmems2 <- data2$Movement_mem %>% na.omit() %>% toupper()\nstories2 <- data2$Movement_story %>% na.omit() %>% toupper()\n\nmovements_mem2 <- unlist(strsplit(mems2, \"[; ,]+\")) %>% trimws()\nmovements_story2 <- unlist(strsplit(stories2, \"[; ,]+\")) %>% trimws()\n\nmovements_mem2 <- table(movements_mem2)\nmovements_story2 <- table(movements_story2)\n\n#Map for recoding movements using full names\nrecode_map <- c(\n  \"B1\" = \"Beethoven, Movement 1 — Allegro con brio\",\n  \"B2\" = \"Beethoven, Movement 2 — Adagio affettuoso ed appassionato\",\n  \"B3\" = \"Beethoven, Movement 3 — Scherzo\",\n  \"B4\" = \"Beethoven, Movement 4 — Allegro\",\n  \"H1\" = \"Hough, Movement 1 — Au boulevard\",\n  \"H2\" = \"Hough, Movement 2 — Au parc\",\n  \"H3\" = \"Hough, Movement 3 — À l'hôtel\",\n  \"H4\" = \"Hough, Movement 4 — Au théâtre\",\n  \"H5\" = \"Hough, Movement 5 — À l'église\",\n  \"H6\" = \"Hough, Movement 6 — Au marché\",\n  \"BR1\" = \"Brahms, movement 1 — Allegro non troppo\", \n  \"BR2\" = \"Brahms, movement 2 — Andante, un poco adagio\", \n  \"BR3\" = \"Brahms, movement 3 — Scherzo: Allegro\", \n  \"BR4\" = \"Brahms, movement 4 — Finale\"\n)\n\n# Recode names in the frequency tables\nnames(movements_mem) <- recode(names(movements_mem), !!!recode_map)\nnames(movements_story) <- recode(names(movements_story), !!!recode_map)\nnames(movements_mem2) <- recode(names(movements_mem2), !!!recode_map)\nnames(movements_story2) <- recode(names(movements_story2), !!!recode_map)\n\n# Convert tables to data frames and rename columns\ndf_mem1 <- as.data.frame(movements_mem)\ncolnames(df_mem1) <- c(\"Movement_eliciting_memory\", \"Count\")\n\ndf_story1 <- as.data.frame(movements_story)\ncolnames(df_story1) <- c(\"Movement_eliciting_story\", \"Count\")\n\ndf_mem2 <- as.data.frame(movements_mem2)\ncolnames(df_mem2) <- c(\"Movement_eliciting_memory\", \"Count\")\n\ndf_story2 <- as.data.frame(movements_story2)\ncolnames(df_story2) <- c(\"Movement_eliciting_story\", \"Count\")\n\n# Display frequency tables with full movement names\nkable(df_mem1)\n```\n\n::: {.cell-output-display}\n\n\n|Movement_eliciting_memory                                 | Count|\n|:---------------------------------------------------------|-----:|\n|Beethoven, Movement 1 — Allegro con brio                  |    34|\n|Beethoven, Movement 2 — Adagio affettuoso ed appassionato |    46|\n|Beethoven, Movement 3 — Scherzo                           |    15|\n|Beethoven, Movement 4 — Allegro                           |    10|\n|Hough, Movement 1 — Au boulevard                          |    13|\n|Hough, Movement 2 — Au parc                               |    17|\n|Hough, Movement 3 — À l'hôtel                             |    12|\n|Hough, Movement 4 — Au théâtre                            |    16|\n|Hough, Movement 5 — À l'église                            |    17|\n|Hough, Movement 6 — Au marché                             |    21|\n\n\n:::\n\n```{.r .cell-code}\nkable(df_story1)\n```\n\n::: {.cell-output-display}\n\n\n|Movement_eliciting_story                                  | Count|\n|:---------------------------------------------------------|-----:|\n|Beethoven, Movement 1 — Allegro con brio                  |    16|\n|Beethoven, Movement 2 — Adagio affettuoso ed appassionato |    25|\n|Beethoven, Movement 3 — Scherzo                           |    14|\n|Beethoven, Movement 4 — Allegro                           |     9|\n|Brahms, movement 2 — Andante, un poco adagio              |     2|\n|Hough, Movement 1 — Au boulevard                          |    13|\n|Hough, Movement 2 — Au parc                               |    21|\n|Hough, Movement 3 — À l'hôtel                             |     9|\n|Hough, Movement 4 — Au théâtre                            |    24|\n|Hough, Movement 5 — À l'église                            |    11|\n|Hough, Movement 6 — Au marché                             |    17|\n\n\n:::\n\n```{.r .cell-code}\nkable(df_mem2)\n```\n\n::: {.cell-output-display}\n\n\n|Movement_eliciting_memory                    | Count|\n|:--------------------------------------------|-----:|\n|Brahms, movement 1 — Allegro non troppo      |    38|\n|Brahms, movement 2 — Andante, un poco adagio |    31|\n|Brahms, movement 3 — Scherzo: Allegro        |    50|\n|Brahms, movement 4 — Finale                  |    26|\n\n\n:::\n\n```{.r .cell-code}\nkable(df_story2)\n```\n\n::: {.cell-output-display}\n\n\n|Movement_eliciting_story                     | Count|\n|:--------------------------------------------|-----:|\n|Brahms, movement 1 — Allegro non troppo      |    17|\n|Brahms, movement 2 — Andante, un poco adagio |    27|\n|Brahms, movement 3 — Scherzo: Allegro        |    37|\n|Brahms, movement 4 — Finale                  |    29|\n\n\n:::\n:::\n\n\n\nThese can be plotted:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Add a Composer column (Beethoven for B1-B4, Hough for H1-H6)\ndf_mem1$Composer <- ifelse(grepl(\"^Beethoven\", df_mem1$Movement_eliciting_memory), \"Beethoven\", \"Hough\")\ndf_story1$Composer <- ifelse(grepl(\"^Beethoven\", df_story1$Movement_eliciting_story), \"Beethoven\", \"Hough\")\n\n# Set movement factor levels for proper ordering\ndf_mem1$Movement <- factor(df_mem1$Movement, levels = recode_map)\ndf_story1$Movement <- factor(df_story1$Movement, levels = recode_map)\n\n# Plot for memories, first half\nmem_plot1 <- ggplot(df_mem1, aes(x = Movement_eliciting_memory, y = Count, fill = Movement_eliciting_memory)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  facet_wrap(~ Composer, scales = \"free_x\") +  # Separate Beethoven & Hough\n  theme_minimal() +\n  labs(title = \"Movement Counts for Memories, First Half\", x = \"Movement\", y = \"Count\") +\n theme(axis.title.x = element_blank(),  \n        axis.text.x = element_blank(),  \n        axis.ticks.x = element_blank()) +\n  scale_fill_brewer(palette = \"Set3\") + \n  guides(fill = guide_legend(title = \"Movement\")) +\n  scale_y_continuous(breaks = scales::breaks_pretty(n = 5)) \n\n# Plot for stories, first half\nstory_plot1 <- ggplot(df_story1, aes(x = Movement_eliciting_story, y = Count, fill = Movement_eliciting_story)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  facet_wrap(~ Composer, scales = \"free_x\") +  \n  theme_minimal() +\n  labs(title = \"Movement Counts for Stories, First Half\", x = \"Movement\", y = \"Count\") +\n theme(axis.title.x = element_blank(),  \n        axis.text.x = element_blank(),   \n        axis.ticks.x = element_blank()) +\n  scale_fill_brewer(palette = \"Set3\") + \n  guides(fill = guide_legend(title = \"Movement\")) +\n  scale_y_continuous(breaks = scales::breaks_pretty(n = 5)) \n\n\n##Second Half\n# Set movement factor levels for proper ordering\ndf_mem2$Movement_eliciting_memory <- factor(df_mem2$Movement_eliciting_memory, levels = recode_map)\ndf_story2$Movement_eliciting_story <- factor(df_story2$Movement_eliciting_story, levels = recode_map)\n\n# Plot for memories, second half\nmem_plot2 <- ggplot(df_mem2, aes(x = Movement_eliciting_memory, y = Count, fill = Movement_eliciting_memory)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  theme_minimal() +\n  labs(title = \"Movement Counts for Memories, Second Half\", x = \"Movement\", y = \"Count\") +\n theme(axis.title.x = element_blank(), \n        axis.text.x = element_blank(),  \n        axis.ticks.x = element_blank()) +\n  scale_fill_brewer(palette = \"Set3\") + \n  guides(fill = guide_legend(title = \"Movement\")) +\n  scale_y_continuous(breaks = scales::breaks_pretty(n = 5))  \n\n# Plot for stories, second half\nstory_plot2 <- ggplot(df_story2, aes(x = Movement_eliciting_story, y = Count, fill = Movement_eliciting_story)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  theme_minimal() +\n  labs(title = \"Movement Counts for Stories, Second Half\", x = \"Movement\", y = \"Count\") +\n theme(axis.title.x = element_blank(),  \n        axis.text.x = element_blank(),  \n        axis.ticks.x = element_blank()) +\n  scale_fill_brewer(palette = \"Set3\") + \n  guides(fill = guide_legend(title = \"Movement\")) +\n  scale_y_continuous(breaks = scales::breaks_pretty(n = 5)) \n\nmem_plot1\n```\n\n::: {.cell-output-display}\n![](Descriptive1_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nstory_plot1\n```\n\n::: {.cell-output-display}\n![](Descriptive1_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\nmem_plot2\n```\n\n::: {.cell-output-display}\n![](Descriptive1_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n\n```{.r .cell-code}\nstory_plot2\n```\n\n::: {.cell-output-display}\n![](Descriptive1_files/figure-html/unnamed-chunk-6-4.png){width=672}\n:::\n:::\n\n\n\nDEMOGRAPHIC INFO\n\nWe'll get a quick overview of our demographic data. Note, first we're going to add a 'Floor' column based on participants' location in the hall. Having this info is useful, as concert subscribers and many older patrons sit downstairs in the auditorium.\n\nHere's a map of each location in the hall for reference:\n\n<img src=\"Richardson_map.png\" width=\"300\" style=\"display: block; margin: auto;\"/>\n\nCreating the floor variable:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data %>%\n  mutate(Floor = ifelse(Location %in% c(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\"), \"Downstairs\", \"Upstairs\")) %>% relocate(Floor, .after = Location)\n```\n:::\n\n\n\nAnd an overview of our demographics variables:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndemographics <- c('Age', 'Gender', 'Music_listening', 'Practice', 'Floor')\ndemographics_data <- dplyr::select(data, all_of(demographics))\nskim(demographics_data)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |                  |\n|:------------------------|:-----------------|\n|Name                     |demographics_data |\n|Number of rows           |169               |\n|Number of columns        |5                 |\n|_______________________  |                  |\n|Column type frequency:   |                  |\n|character                |4                 |\n|numeric                  |1                 |\n|________________________ |                  |\n|Group variables          |None              |\n\n\n**Variable type: character**\n\n|skim_variable   | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:---------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|Age             |         8|          0.95|   2|  26|     0|       66|          0|\n|Gender          |         1|          0.99|   1|  17|     0|        9|          0|\n|Music_listening |         4|          0.98|  10|  21|     0|        5|          0|\n|Floor           |         0|          1.00|   8|  10|     0|        2|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|  mean|    sd| p0| p25| p50| p75| p100|hist  |\n|:-------------|---------:|-------------:|-----:|-----:|--:|---:|---:|---:|----:|:-----|\n|Practice      |        32|          0.81| 17.65| 22.28|  0|   0|  10|  25|   80|▇▂▁▁▁ |\n\n\n:::\n:::\n",
    "supporting": [
      "Descriptive1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}